import{o as l,c as u,b as e,d as N,r as m,a as $,m as G,n as v,p as L,x as a,y as i,s as S,i as b,f as x,v as w,h as O,t as _,g as A}from"./main-DYuA4yRd.js";import{_ as q,f as k,u as F,s as J}from"./api-Hx4iUv-n.js";import{r as P}from"./KeyIcon-COE6-Fuu.js";import{r as M}from"./CheckCircleIcon-CSCdnRgE.js";import{r as R}from"./XCircleIcon-Ph4WmBDj.js";import{r as E}from"./GlobeAltIcon-CIeyGK8h.js";import{r as Z}from"./UserIcon-Dgf2nuou.js";import{r as H}from"./EyeIcon-C0_WOve3.js";import{r as K}from"./EyeSlashIcon-CPs1hDP3.js";import{r as Q}from"./IdentificationIcon-D3NHITJ0.js";import{r as W}from"./BoltIcon-DDfpAzDC.js";import{r as X}from"./ExclamationCircleIcon-oX7LR0PJ.js";function Y(T,y){return l(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const ee={class:"p-4 sm:p-6 lg:p-8"},se={class:"mb-4 sm:mb-8"},te={class:"flex items-center gap-2"},oe={key:0,class:"flex items-center justify-center py-12"},re={key:1,class:"max-w-5xl mx-auto space-y-6"},ne={class:"rounded-lg border bg-card shadow-sm overflow-hidden"},ie={class:"p-6"},le={class:"flex items-start justify-between mb-6"},ae={class:"flex items-start gap-4"},de={class:"flex items-center gap-3"},ue={key:0,class:"px-2 py-1 rounded-full bg-success/10 text-success text-xs font-medium flex items-center gap-1"},ce={key:1,class:"px-2 py-1 rounded-full bg-muted text-muted-foreground text-xs font-medium flex items-center gap-1"},fe={class:"flex items-center gap-4 mt-3"},me={class:"flex items-center gap-1.5 text-xs"},pe={key:0,class:"pt-6 border-t space-y-6"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"space-y-2"},be={class:"text-sm font-medium flex items-center gap-2"},xe={class:"space-y-2"},_e={class:"text-sm font-medium flex items-center gap-2"},ye={class:"relative"},he=["type"],we={class:"space-y-2"},ke={class:"text-sm font-medium flex items-center gap-2"},Ce={class:"space-y-2"},$e={class:"text-sm font-medium flex items-center gap-2"},Ae={class:"space-y-2"},Me={class:"text-sm font-medium flex items-center gap-2"},Se={class:"flex gap-3"},Pe=["disabled"],Ee=["disabled"],Te={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"},Ue=["disabled"],Ve={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},je={key:0,class:"rounded-lg bg-success/10 border border-success/20 p-4"},Ie={class:"flex items-center gap-2 text-success"},Be={class:"font-medium"},De={key:1,class:"rounded-lg bg-destructive/10 border border-destructive/20 p-4"},ze={class:"flex items-center gap-2 text-destructive"},Ne={class:"font-medium"},Xe=N({__name:"ApiConfiguration",setup(T){const y=m(!0),p=m(["airtel"]),h=$({airtel:!1,moov:!1}),g=$({airtel:!1,moov:!1}),c=$({airtel:!1,moov:!1}),d=m(""),f=m(""),r=m({provider:"airtel",api_url:"https://messaging.airtel.ga:9002/smshttp/qs/",username:"",password:"",origin_addr:"",cost_per_sms:20,is_active:!1}),C=m({provider:"moov",api_url:"",username:"",password:"",origin_addr:"",cost_per_sms:20,is_active:!1});function U(t){const s=p.value.indexOf(t);s>-1?p.value.splice(s,1):p.value.push(t)}function V(t){h[t]=!h[t]}async function j(){y.value=!0;try{const t=await k.get("/sms-configs");(t.data.data||t.data).forEach(o=>{o.provider==="airtel"?r.value={...r.value,...o}:o.provider==="moov"&&(C.value={...C.value,...o})})}catch(t){console.error("Error loading configs:",t)}finally{y.value=!1}}async function I(t){var s,o;c[t]=!0,d.value="",f.value="";try{const n=t==="airtel"?r.value:C.value;await k.put(`/sms-configs/${t}`,{api_url:n.api_url,username:n.username,password:n.password,origin_addr:n.origin_addr,cost_per_sms:n.cost_per_sms,is_active:n.is_active}),d.value=`Configuration ${t.toUpperCase()} enregistrée avec succès !`,setTimeout(()=>{d.value=""},3e3)}catch(n){console.error("Save config error:",n),f.value=((o=(s=n.response)==null?void 0:s.data)==null?void 0:o.message)||"Erreur lors de l'enregistrement"}finally{c[t]=!1}}async function B(t){var s,o;c[t]=!0,d.value="",f.value="";try{const n=await k.post(`/sms-configs/${t}/toggle`),z=n.data.data;t==="airtel"&&(r.value.is_active=z.is_active),d.value=n.data.message,setTimeout(()=>{d.value=""},3e3)}catch(n){console.error("Toggle error:",n),f.value=((o=(s=n.response)==null?void 0:s.data)==null?void 0:o.message)||"Erreur lors du changement de statut"}finally{c[t]=!1}}async function D(t){var s,o;g[t]=!0,d.value="",f.value="";try{const n=await k.post(`/sms-configs/${t}/test`,{phone_number:"+241 77 75 07 37",message:`Test API ${t.toUpperCase()} - ${new Date().toLocaleString()}`});d.value=`✓ Test réussi avec ${t.toUpperCase()} !`,setTimeout(()=>{d.value=""},3e3)}catch(n){console.error("Test error:",n),f.value=((o=(s=n.response)==null?void 0:s.data)==null?void 0:o.message)||`Échec du test ${t.toUpperCase()}`}finally{g[t]=!1}}return G(()=>{j()}),(t,s)=>(l(),v(q,null,{default:L(()=>[e("div",ee,[e("div",se,[e("div",te,[a(i(P),{class:"w-6 h-6 sm:w-8 sm:h-8 text-primary"}),s[10]||(s[10]=e("h1",{class:"text-xl sm:text-3xl font-bold"},"Configuration des API SMS",-1))]),s[11]||(s[11]=e("p",{class:"text-sm text-muted-foreground mt-1 sm:mt-2"},"Configurez les API des opérateurs Airtel et Moov Gabon",-1))]),y.value?(l(),u("div",oe,[...s[12]||(s[12]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(l(),u("div",re,[e("div",ne,[e("div",ie,[e("div",le,[e("div",ae,[e("div",{class:S(["w-16 h-16 rounded-lg flex items-center justify-center text-2xl font-bold",r.value.is_active?"bg-red-100 text-red-600":"bg-muted text-muted-foreground"])}," AI ",2),e("div",null,[e("div",de,[s[15]||(s[15]=e("h3",{class:"text-xl font-bold"},"Airtel Gabon",-1)),r.value.is_active?(l(),u("span",ue,[a(i(M),{class:"w-3 h-3"}),s[13]||(s[13]=e("span",null,"Actif",-1))])):(l(),u("span",ce,[a(i(R),{class:"w-3 h-3"}),s[14]||(s[14]=e("span",null,"Inactif",-1))]))]),s[17]||(s[17]=e("p",{class:"text-sm text-muted-foreground mt-1"},"API SMS Airtel - Préfixes: 77, 74, 76",-1)),e("div",fe,[e("div",me,[a(i(E),{class:"w-4 h-4 text-muted-foreground"}),s[16]||(s[16]=e("span",{class:"text-muted-foreground"},"messaging.airtel.ga",-1))])])])]),e("button",{onClick:s[0]||(s[0]=o=>U("airtel")),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:bg-accent hover:text-accent-foreground h-9 w-9"},[a(i(F),{class:S(["w-5 h-5 transition-transform",p.value.includes("airtel")?"rotate-180":""])},null,8,["class"])])]),p.value.includes("airtel")?(l(),u("div",pe,[e("div",ge,[e("div",ve,[e("label",be,[a(i(Z),{class:"w-4 h-4 text-muted-foreground"}),s[18]||(s[18]=b(" Username * ",-1))]),x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>r.value.username=o),type:"text",placeholder:"Entrez le username",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[w,r.value.username]])]),e("div",xe,[e("label",_e,[a(i(P),{class:"w-4 h-4 text-muted-foreground"}),s[19]||(s[19]=b(" Password * ",-1))]),e("div",ye,[x(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>r.value.password=o),type:h.airtel?"text":"password",placeholder:"Entrez le password",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 pr-10 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,he),[[O,r.value.password]]),e("button",{onClick:s[3]||(s[3]=o=>V("airtel")),type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-accent rounded p-1"},[h.airtel?(l(),v(i(K),{key:1,class:"w-4 h-4 text-muted-foreground"})):(l(),v(i(H),{key:0,class:"w-4 h-4 text-muted-foreground"}))])])]),e("div",we,[e("label",ke,[a(i(Q),{class:"w-4 h-4 text-muted-foreground"}),s[20]||(s[20]=b(" Origin Address / Sender ID * ",-1))]),x(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>r.value.origin_addr=o),type:"text",placeholder:"Ex: JOBSSMS",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[w,r.value.origin_addr]])]),e("div",Ce,[e("label",$e,[a(i(Y),{class:"w-4 h-4 text-muted-foreground"}),s[21]||(s[21]=b(" Coût par SMS (FCFA) ",-1))]),x(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>r.value.cost_per_sms=o),type:"number",step:"1",min:"0",placeholder:"20",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[w,r.value.cost_per_sms,void 0,{number:!0}]])])]),e("div",Ae,[e("label",Me,[a(i(E),{class:"w-4 h-4 text-muted-foreground"}),s[22]||(s[22]=b(" URL de l'API ",-1))]),x(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>r.value.api_url=o),type:"text",readonly:"",class:"flex h-10 w-full rounded-md border border-input bg-muted px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground"},null,512),[[w,r.value.api_url]])]),e("div",Se,[e("button",{onClick:s[7]||(s[7]=o=>B("airtel")),disabled:c.airtel,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[a(i(W),{class:"w-4 h-4"}),e("span",null,_(r.value.is_active?"Désactiver":"Activer"),1)],8,Pe),e("button",{onClick:s[8]||(s[8]=o=>D("airtel")),disabled:!r.value.username||!r.value.password||g.airtel,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[g.airtel?(l(),u("div",Te)):(l(),v(i(J),{key:0,class:"w-4 h-4"})),e("span",null,_(g.airtel?"Test en cours...":"Tester"),1)],8,Ee),e("button",{onClick:s[9]||(s[9]=o=>I("airtel")),disabled:!r.value.username||!r.value.password||c.airtel,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[c.airtel?(l(),u("div",Ve)):(l(),v(i(M),{key:0,class:"w-4 h-4"})),e("span",null,_(c.airtel?"Enregistrement...":"Enregistrer"),1)],8,Ue)])])):A("",!0)])]),s[23]||(s[23]=e("div",{class:"rounded-lg border bg-card shadow-sm overflow-hidden opacity-60"},[e("div",{class:"p-6"},[e("div",{class:"flex items-start justify-between mb-6"},[e("div",{class:"flex items-start gap-4"},[e("div",{class:"w-16 h-16 rounded-lg flex items-center justify-center text-2xl font-bold bg-muted text-muted-foreground"}," MV "),e("div",null,[e("div",{class:"flex items-center gap-3"},[e("h3",{class:"text-xl font-bold"},"Moov Gabon"),e("span",{class:"px-2 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-medium"}," Bientôt disponible ")]),e("p",{class:"text-sm text-muted-foreground mt-1"},"API SMS Moov - Préfixes: 60, 62, 65, 66"),e("p",{class:"text-xs text-muted-foreground mt-2"},"L'API Moov sera configurée dès qu'elle sera disponible")])])])])],-1)),d.value?(l(),u("div",je,[e("div",Ie,[a(i(M),{class:"w-5 h-5"}),e("p",Be,_(d.value),1)])])):A("",!0),f.value?(l(),u("div",De,[e("div",ze,[a(i(X),{class:"w-5 h-5"}),e("p",Ne,_(f.value),1)])])):A("",!0)]))])]),_:1}))}});export{Xe as default};
