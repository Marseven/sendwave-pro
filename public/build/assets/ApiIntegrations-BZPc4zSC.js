import{o as r,c as l,b as e,d as U,k as G,r as g,a as F,m as H,n as O,p as W,x as m,y as p,F as I,q as $,t as u,s as J,g as b,i as M,w as V,f as _,v as j,C as Q,D as X}from"./main-CTJ9pDlc.js";import{f as x,_ as Y,i as Z}from"./api-BPmnD8jt.js";import{b as C,s as T,a as L}from"./notifications-CHQAjgV4.js";import{r as K}from"./KeyIcon-CfyUkoql.js";import{r as ee}from"./ArrowPathIcon-0CqkSBZ2.js";import{r as z}from"./XMarkIcon-DRPl7OBm.js";import{r as te}from"./CheckCircleIcon-3ggcwbb1.js";function se(o,n){return r(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"})])}function oe(o,n){return r(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})])}const A={async getAll(){const o=await x.get("/api-keys");return o.data.data||o.data},async getById(o){const n=await x.get(`/api-keys/${o}`);return n.data.data||n.data},async create(o){const n=await x.post("/api-keys",o);return n.data.data||n.data},async update(o,n){const f=await x.put(`/api-keys/${o}`,n);return f.data.data||f.data},async revoke(o){const n=await x.post(`/api-keys/${o}/revoke`);return n.data.data||n.data},async regenerate(o){const n=await x.post(`/api-keys/${o}/regenerate`);return n.data.data||n.data},async delete(o){await x.delete(`/api-keys/${o}`)}},ne={class:"p-8"},re={class:"mb-8 flex items-center justify-between"},ae={class:"space-y-6"},le={class:"rounded-lg border bg-card"},de={key:0,class:"p-8 flex items-center justify-center"},ie={key:1,class:"p-8 text-center text-muted-foreground"},ue={key:2,class:"divide-y"},ce={class:"flex items-start justify-between"},me={class:"flex-1"},pe={class:"flex items-center gap-2"},xe={class:"font-medium"},fe={key:0,class:"px-2 py-0.5 text-xs rounded-full bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"},ve={class:"mt-1 flex items-center gap-2"},ge={class:"text-sm font-mono bg-muted px-2 py-1 rounded"},be=["onClick"],ye={class:"mt-2 flex items-center gap-4 text-xs text-muted-foreground"},we={key:0},ke={class:"mt-2 flex flex-wrap gap-1"},he={class:"flex gap-2"},_e=["onClick","disabled"],Ce=["onClick","disabled"],Ae={class:"rounded-lg border bg-card"},Pe={class:"p-6 border-b"},Ie={class:"font-semibold flex items-center gap-2"},$e={class:"p-6 space-y-6"},qe={class:"block p-3 bg-muted rounded-lg text-sm font-mono"},Se={class:"bg-background rounded-lg shadow-lg w-full max-w-md p-6"},Ee={class:"flex items-center justify-between mb-6"},Me={class:"space-y-2"},Ve={class:"space-y-2"},je={class:"space-y-2"},Te={class:"space-y-2"},Le=["value"],ze={class:"text-sm"},Be={class:"space-y-2"},De={class:"flex gap-3 pt-4 border-t"},Ne=["disabled"],Re={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Ue={class:"bg-background rounded-lg shadow-lg w-full max-w-md p-6"},Ge={class:"text-center mb-6"},Fe={class:"w-16 h-16 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mx-auto mb-4"},He={class:"p-4 bg-muted rounded-lg mb-6"},Oe={class:"text-sm font-mono break-all"},We={class:"flex gap-3"},tt=U({__name:"ApiIntegrations",setup(o){const n=G(()=>window.location.origin),f=g([]),P=g(!1),y=g(!1),v=g(!1),w=g(!1),k=g(""),q={send_sms:"Envoyer des SMS",view_history:"Voir l'historique",manage_contacts:"Gérer les contacts",view_balance:"Voir le solde"},d=F({name:"",type:"production",permissions:["send_sms","view_history"],rate_limit:100});async function h(){P.value=!0;try{f.value=await A.getAll()}catch(i){console.error("Error loading API keys:",i)}finally{P.value=!1}}function B(){d.name="",d.type="production",d.permissions=["send_sms","view_history"],d.rate_limit=100,v.value=!0}async function D(){var i,t;if(!d.name){C("Veuillez entrer un nom pour la clé");return}y.value=!0;try{const s=await A.create(d);v.value=!1,k.value=s.full_key||s.key,w.value=!0,await h()}catch(s){C(((t=(i=s.response)==null?void 0:i.data)==null?void 0:t.message)||"Erreur lors de la création")}finally{y.value=!1}}async function N(i){var s,a;if(await T("Révoquer la clé API ?","Cette action est irréversible. Les applications utilisant cette clé ne pourront plus accéder à l'API."))try{await A.revoke(i),L("Clé API révoquée"),await h()}catch(c){C(((a=(s=c.response)==null?void 0:s.data)==null?void 0:a.message)||"Erreur lors de la révocation")}}async function R(i){var s,a;if(await T("Régénérer la clé API ?","L'ancienne clé sera invalidée et remplacée par une nouvelle."))try{const c=await A.regenerate(i);k.value=c.full_key||c.key,w.value=!0,await h()}catch(c){C(((a=(s=c.response)==null?void 0:s.data)==null?void 0:a.message)||"Erreur lors de la régénération")}}function S(i){navigator.clipboard.writeText(i),L("Clé copiée dans le presse-papier")}function E(i){return new Date(i).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}return H(()=>{h()}),(i,t)=>(r(),O(Y,null,{default:W(()=>[e("div",ne,[e("div",re,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Clés API"),e("p",{class:"text-muted-foreground mt-2"},"Gérez vos clés API pour intégrer SendWave dans vos applications")],-1)),e("button",{onClick:B,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[m(p(Z),{class:"w-4 h-4"}),t[8]||(t[8]=e("span",null,"Nouvelle clé API",-1))])]),e("div",ae,[e("div",le,[t[13]||(t[13]=e("div",{class:"p-6 border-b"},[e("h3",{class:"font-semibold"},"Clés API actives"),e("p",{class:"text-sm text-muted-foreground"},"Les clés permettent aux applications externes d'accéder à l'API SendWave")],-1)),P.value?(r(),l("div",de,[...t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):f.value.length===0?(r(),l("div",ie,[m(p(K),{class:"w-12 h-12 mx-auto mb-4 opacity-50"}),t[11]||(t[11]=e("p",null,"Aucune clé API créée",-1)),t[12]||(t[12]=e("p",{class:"text-sm"},"Créez une clé pour commencer à utiliser l'API",-1))])):(r(),l("div",ue,[(r(!0),l(I,null,$(f.value,s=>(r(),l("div",{key:s.id,class:"p-4 hover:bg-muted/50"},[e("div",ce,[e("div",me,[e("div",pe,[e("span",xe,u(s.name),1),e("span",{class:J(["px-2 py-0.5 text-xs rounded-full",s.type==="production"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300"])},u(s.type==="production"?"Production":"Test"),3),s.status==="revoked"?(r(),l("span",fe," Révoquée ")):b("",!0)]),e("div",ve,[e("code",ge,u(s.key),1),s.full_key?(r(),l("button",{key:0,onClick:a=>S(s.full_key),class:"text-xs text-primary hover:underline"}," Copier ",8,be)):b("",!0)]),e("div",ye,[e("span",null,"Créée le "+u(E(s.created_at)),1),s.last_used_at?(r(),l("span",we,"Dernière utilisation: "+u(E(s.last_used_at)),1)):b("",!0),e("span",null,"Limite: "+u(s.rate_limit)+" req/min",1)]),e("div",ke,[(r(!0),l(I,null,$(s.permissions,a=>(r(),l("span",{key:a,class:"px-2 py-0.5 text-xs rounded bg-primary/10 text-primary"},u(q[a]||a),1))),128))])]),e("div",he,[e("button",{onClick:a=>R(s.id),disabled:s.status==="revoked",class:"text-sm px-3 py-1 rounded border hover:bg-accent disabled:opacity-50",title:"Régénérer"},[m(p(ee),{class:"w-4 h-4"})],8,_e),e("button",{onClick:a=>N(s.id),disabled:s.status==="revoked",class:"text-sm px-3 py-1 rounded border hover:bg-destructive/10 text-destructive disabled:opacity-50",title:"Révoquer"},[m(p(z),{class:"w-4 h-4"})],8,Ce)])])]))),128))]))]),e("div",Ae,[e("div",Pe,[e("h3",Ie,[m(p(se),{class:"w-5 h-5"}),t[14]||(t[14]=M(" Documentation API ",-1))])]),e("div",$e,[e("div",null,[t[15]||(t[15]=e("h4",{class:"font-medium mb-2"},"URL de base",-1)),e("code",qe,u(n.value)+"/api",1)]),t[16]||(t[16]=e("div",null,[e("h4",{class:"font-medium mb-2"},"Authentification"),e("p",{class:"text-sm text-muted-foreground mb-2"},"Ajoutez votre clé API dans l'en-tête de chaque requête:"),e("pre",{class:"p-3 bg-muted rounded-lg text-sm font-mono overflow-x-auto"},"Authorization: Bearer sk_live_xxxxxxxxxxxxx")],-1)),t[17]||(t[17]=e("div",null,[e("h4",{class:"font-medium mb-2"},"Envoyer un SMS"),e("div",{class:"p-3 bg-muted rounded-lg"},[e("div",{class:"flex items-center gap-2 mb-2"},[e("span",{class:"px-2 py-0.5 bg-green-600 text-white text-xs rounded font-medium"},"POST"),e("code",{class:"text-sm font-mono"},"/api/messages/send")]),e("pre",{class:"text-sm font-mono text-muted-foreground overflow-x-auto"},`{
  "recipients": ["+24177123456", "+24162987654"],
  "message": "Votre message ici"
}`)])],-1)),t[18]||(t[18]=e("div",null,[e("h4",{class:"font-medium mb-2"},"Exemple de réponse"),e("pre",{class:"p-3 bg-muted rounded-lg text-sm font-mono overflow-x-auto text-green-600 dark:text-green-400"},`{
  "message": "Message envoyé avec succès",
  "data": {
    "message_id": 12345,
    "provider": "airtel",
    "phone": "24177123456",
    "sms_count": 1,
    "cost": 20
  }
}`)],-1)),t[19]||(t[19]=e("div",null,[e("h4",{class:"font-medium mb-2"},"Autres endpoints"),e("div",{class:"space-y-2"},[e("div",{class:"flex items-center gap-2 p-2 bg-muted/50 rounded"},[e("span",{class:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded font-medium"},"GET"),e("code",{class:"text-sm font-mono"},"/api/messages/history"),e("span",{class:"text-xs text-muted-foreground ml-auto"},"Historique des messages")]),e("div",{class:"flex items-center gap-2 p-2 bg-muted/50 rounded"},[e("span",{class:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded font-medium"},"GET"),e("code",{class:"text-sm font-mono"},"/api/contacts"),e("span",{class:"text-xs text-muted-foreground ml-auto"},"Liste des contacts")]),e("div",{class:"flex items-center gap-2 p-2 bg-muted/50 rounded"},[e("span",{class:"px-2 py-0.5 bg-green-600 text-white text-xs rounded font-medium"},"POST"),e("code",{class:"text-sm font-mono"},"/api/contacts"),e("span",{class:"text-xs text-muted-foreground ml-auto"},"Créer un contact")]),e("div",{class:"flex items-center gap-2 p-2 bg-muted/50 rounded"},[e("span",{class:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded font-medium"},"GET"),e("code",{class:"text-sm font-mono"},"/api/analytics/dashboard"),e("span",{class:"text-xs text-muted-foreground ml-auto"},"Statistiques")])])],-1)),t[20]||(t[20]=e("div",{class:"p-4 bg-yellow-50 dark:bg-yellow-950 rounded-lg border border-yellow-200 dark:border-yellow-800"},[e("h4",{class:"font-medium text-yellow-800 dark:text-yellow-200 mb-1"},"Limites de requêtes"),e("p",{class:"text-sm text-yellow-700 dark:text-yellow-300"}," Chaque clé API a une limite de requêtes par minute. En cas de dépassement, vous recevrez une erreur 429 (Too Many Requests). ")],-1))])])])]),v.value?(r(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:t[6]||(t[6]=V(s=>v.value=!1,["self"]))},[e("div",Se,[e("div",Ee,[t[21]||(t[21]=e("h2",{class:"text-xl font-bold"},"Nouvelle clé API",-1)),e("button",{onClick:t[0]||(t[0]=s=>v.value=!1),class:"hover:bg-accent rounded-full p-1"},[m(p(z),{class:"w-5 h-5"})])]),e("form",{onSubmit:V(D,["prevent"]),class:"space-y-4"},[e("div",Me,[t[22]||(t[22]=e("label",{class:"text-sm font-medium"},"Nom de la clé *",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>d.name=s),type:"text",placeholder:"Ex: Application mobile",required:"",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[j,d.name]])]),e("div",Ve,[t[24]||(t[24]=e("label",{class:"text-sm font-medium"},"Type",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.type=s),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[...t[23]||(t[23]=[e("option",{value:"production"},"Production",-1),e("option",{value:"test"},"Test",-1)])],512),[[Q,d.type]])]),e("div",je,[t[25]||(t[25]=e("label",{class:"text-sm font-medium"},"Permissions",-1)),e("div",Te,[(r(),l(I,null,$(q,(s,a)=>e("label",{key:a,class:"flex items-center gap-2"},[_(e("input",{type:"checkbox",value:a,"onUpdate:modelValue":t[3]||(t[3]=c=>d.permissions=c),class:"rounded border-input"},null,8,Le),[[X,d.permissions]]),e("span",ze,u(s),1)])),64))])]),e("div",Be,[t[26]||(t[26]=e("label",{class:"text-sm font-medium"},"Limite de requêtes (par minute)",-1)),_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>d.rate_limit=s),type:"number",min:"1",max:"10000",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[j,d.rate_limit,void 0,{number:!0}]])]),e("div",De,[e("button",{type:"button",onClick:t[5]||(t[5]=s=>v.value=!1),class:"flex-1 h-10 px-4 rounded-md border hover:bg-accent"}," Annuler "),e("button",{type:"submit",disabled:y.value,class:"flex-1 h-10 px-4 rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50"},u(y.value?"Création...":"Créer la clé"),9,Ne)])],32)])])):b("",!0),w.value?(r(),l("div",Re,[e("div",Ue,[e("div",Ge,[e("div",Fe,[m(p(te),{class:"w-8 h-8 text-green-600 dark:text-green-400"})]),t[27]||(t[27]=e("h2",{class:"text-xl font-bold"},"Clé API créée",-1)),t[28]||(t[28]=e("p",{class:"text-sm text-muted-foreground mt-2"},"Copiez cette clé maintenant, elle ne sera plus affichée en entier.",-1))]),e("div",He,[e("code",Oe,u(k.value),1)]),e("div",We,[e("button",{onClick:t[7]||(t[7]=s=>{S(k.value),w.value=!1}),class:"flex-1 h-10 px-4 rounded-md bg-primary text-primary-foreground hover:bg-primary/90 flex items-center justify-center gap-2"},[m(p(oe),{class:"w-4 h-4"}),t[29]||(t[29]=M(" Copier et fermer ",-1))])])])])):b("",!0)]),_:1}))}});export{tt as default};
