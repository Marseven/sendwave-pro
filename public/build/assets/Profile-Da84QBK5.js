import{d as B,u as D,r as d,k as q,l as T,m as V,n as R,o as u,b as e,p as a,q as r,c as b,t as n,i as h,f as l,v,B as k,g as C}from"./main-QOMeYZLg.js";import{_ as I,e as j,f as L,b as U,r as z,c as F,a as G,g as H}from"./api-BdomKYOb.js";import{c as J}from"./campaignService-D8bkkWI1.js";import{c as K}from"./contactService-DM0lV7XT.js";import{r as O,a as Q}from"./CameraIcon-BjudTQz0.js";import{r as W}from"./CheckBadgeIcon-Dn7v2cvp.js";import{r as X}from"./IdentificationIcon-Cl8g3Nrr.js";import{r as Y}from"./UserIcon-B7_3Qs1s.js";import{r as S}from"./EnvelopeIcon-DTHM63Ok.js";import{r as Z}from"./PhoneIcon-BA4INBz6.js";import{r as ee}from"./KeyIcon-DDWUxDIt.js";import{r as se}from"./BellAlertIcon-BvrxWtFX.js";import{r as N}from"./CheckCircleIcon-Ci5j4t4y.js";import{r as te,a as oe}from"./XCircleIcon-D4D8hFkk.js";const re={class:"p-8"},ae={class:"mb-8"},ie={class:"flex items-center gap-2"},ne={key:0,class:"flex items-center justify-center py-12"},le={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},de={class:"space-y-6"},ue={class:"rounded-lg border bg-card p-6"},ce={class:"flex flex-col items-center text-center"},me={class:"relative mb-4"},pe={class:"w-24 h-24 rounded-full bg-primary flex items-center justify-center text-primary-foreground text-3xl font-bold"},fe={class:"absolute bottom-0 right-0 w-8 h-8 rounded-full bg-accent border-2 border-background flex items-center justify-center hover:bg-accent/80 transition-colors"},ge={class:"text-xl font-bold"},ve={class:"text-sm text-muted-foreground"},be={class:"mt-4 flex items-center gap-2"},xe={class:"px-3 py-1 rounded-full bg-success/10 text-success text-xs font-medium flex items-center gap-1"},_e={class:"rounded-lg border bg-card p-6"},ye={class:"font-semibold mb-4 flex items-center gap-2"},he={class:"space-y-3"},we={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50"},ke={class:"flex items-center gap-2"},$e={class:"font-bold"},Ve={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50"},Ce={class:"flex items-center gap-2"},je={class:"font-bold"},Ue={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50"},Se={class:"flex items-center gap-2"},Ne={class:"font-bold"},Ee={class:"lg:col-span-2 space-y-6"},Me={class:"rounded-lg border bg-card p-6"},Pe={class:"flex items-center gap-2 mb-4"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be={class:"space-y-2"},De={class:"text-sm font-medium flex items-center gap-2"},qe={class:"space-y-2"},Te={class:"text-sm font-medium flex items-center gap-2"},Re={class:"space-y-2"},Ie={class:"text-sm font-medium flex items-center gap-2"},Le={class:"space-y-2"},ze={class:"text-sm font-medium flex items-center gap-2"},Fe={class:"rounded-lg border bg-card p-6"},Ge={class:"flex items-center gap-2 mb-4"},He={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Je={class:"space-y-2"},Ke={class:"space-y-2"},Oe={class:"rounded-lg border bg-card p-6"},Qe={class:"flex items-center gap-2 mb-4"},We={class:"space-y-3"},Xe={class:"flex items-start gap-3 cursor-pointer p-3 rounded-lg hover:bg-muted/50 transition-colors"},Ye={class:"flex-1"},Ze={class:"flex items-center gap-2"},es={class:"flex items-start gap-3 cursor-pointer p-3 rounded-lg hover:bg-muted/50 transition-colors"},ss={class:"flex-1"},ts={class:"flex items-center gap-2"},os={class:"flex items-start gap-3 cursor-pointer p-3 rounded-lg hover:bg-muted/50 transition-colors"},rs={class:"flex-1"},as={class:"flex items-center gap-2"},is={key:0,class:"rounded-lg bg-success/10 border border-success/20 p-4"},ns={class:"flex items-center gap-2 text-success"},ls={class:"font-medium"},ds={key:1,class:"rounded-lg bg-destructive/10 border border-destructive/20 p-4"},us={class:"flex items-center gap-2 text-destructive"},cs={class:"font-medium"},ms={class:"flex gap-3"},ps=["disabled"],fs={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},gs=["disabled"],Es=B({__name:"Profile",setup(vs){const c=D(),w=d(!0),m=d(!1),p=d(""),f=d(""),t=d({name:"",email:"",phone:"",company:"",password:"",password_confirmation:"",email_notifications:!0,weekly_reports:!0,campaign_alerts:!0}),x=d({name:"",email:"",phone:"",company:"",password:"",password_confirmation:"",email_notifications:!0,weekly_reports:!0,campaign_alerts:!0}),g=d({campaigns:0,messagesSent:0,contacts:0}),E=q(()=>t.value.name?t.value.name.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2):"?");async function M(){w.value=!0;try{const i=await j.get("/user/profile"),s=i.data.data||i.data;t.value={name:s.name||"",email:s.email||"",phone:s.phone||"",company:s.company||"",password:"",password_confirmation:"",email_notifications:s.email_notifications??!0,weekly_reports:s.weekly_reports??!0,campaign_alerts:s.campaign_alerts??!0},x.value={...t.value};const[o,_]=await Promise.all([J.getAll(),K.getAll()]);g.value.campaigns=o.length,g.value.contacts=_.length,g.value.messagesSent=o.reduce((y,$)=>y+($.messages_sent||$.sent||0),0)}catch(i){console.error("Error loading profile:",i),c.user&&(t.value.name=c.user.name||"",t.value.email=c.user.email||"",x.value={...t.value})}finally{w.value=!1}}async function P(){var i,s;m.value=!0,p.value="",f.value="";try{if(t.value.password&&t.value.password!==t.value.password_confirmation){f.value="Les mots de passe ne correspondent pas";return}const o={name:t.value.name,email:t.value.email,phone:t.value.phone,company:t.value.company,email_notifications:t.value.email_notifications,weekly_reports:t.value.weekly_reports,campaign_alerts:t.value.campaign_alerts};t.value.password&&(o.password=t.value.password,o.password_confirmation=t.value.password_confirmation);const _=await j.put("/user/profile",o),y=_.data.data||_.data;c.user&&(c.user.name=y.name,c.user.email=y.email),t.value.password="",t.value.password_confirmation="",x.value={...t.value},p.value="Profil mis à jour avec succès",setTimeout(()=>{p.value=""},3e3)}catch(o){console.error("Error saving profile:",o),f.value=((s=(i=o.response)==null?void 0:i.data)==null?void 0:s.message)||"Erreur lors de la mise à jour du profil"}finally{m.value=!1}}function A(){t.value={...x.value},p.value="",f.value=""}return T(()=>{M()}),(i,s)=>(u(),V(I,null,{default:R(()=>[e("div",re,[e("div",ae,[e("div",ie,[a(r(L),{class:"w-8 h-8 text-primary"}),s[9]||(s[9]=e("h1",{class:"text-3xl font-bold"},"Mon Profil",-1))]),s[10]||(s[10]=e("p",{class:"text-muted-foreground mt-2"},"Gérez vos informations personnelles et préférences",-1))]),w.value?(u(),b("div",ne,[...s[11]||(s[11]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(u(),b("div",le,[e("div",de,[e("div",ue,[e("div",ce,[e("div",me,[e("div",pe,n(E.value),1),e("button",fe,[a(r(O),{class:"w-4 h-4"})])]),e("h2",ge,n(t.value.name),1),e("p",ve,n(t.value.email),1),e("div",be,[e("span",xe,[a(r(W),{class:"w-4 h-4"}),s[12]||(s[12]=e("span",null,"Compte actif",-1))])])])]),e("div",_e,[e("h3",ye,[a(r(U),{class:"w-5 h-5 text-primary"}),s[13]||(s[13]=e("span",null,"Statistiques",-1))]),e("div",he,[e("div",we,[e("div",ke,[a(r(z),{class:"w-4 h-4 text-muted-foreground"}),s[14]||(s[14]=e("span",{class:"text-sm"},"Campagnes créées",-1))]),e("span",$e,n(g.value.campaigns),1)]),e("div",Ve,[e("div",Ce,[a(r(F),{class:"w-4 h-4 text-muted-foreground"}),s[15]||(s[15]=e("span",{class:"text-sm"},"Messages envoyés",-1))]),e("span",je,n(g.value.messagesSent),1)]),e("div",Ue,[e("div",Se,[a(r(G),{class:"w-4 h-4 text-muted-foreground"}),s[16]||(s[16]=e("span",{class:"text-sm"},"Contacts",-1))]),e("span",Ne,n(g.value.contacts),1)])])])]),e("div",Ee,[e("div",Me,[e("div",Pe,[a(r(X),{class:"w-5 h-5 text-primary"}),s[17]||(s[17]=e("h3",{class:"font-semibold"},"Informations personnelles",-1))]),e("div",Ae,[e("div",Be,[e("label",De,[a(r(Y),{class:"w-4 h-4 text-muted-foreground"}),s[18]||(s[18]=h(" Nom complet ",-1))]),l(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.name=o),type:"text",placeholder:"Votre nom complet",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[v,t.value.name]])]),e("div",qe,[e("label",Te,[a(r(S),{class:"w-4 h-4 text-muted-foreground"}),s[19]||(s[19]=h(" Email ",-1))]),l(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.email=o),type:"email",placeholder:"votre@email.com",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[v,t.value.email]])]),e("div",Re,[e("label",Ie,[a(r(Z),{class:"w-4 h-4 text-muted-foreground"}),s[20]||(s[20]=h(" Téléphone ",-1))]),l(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.phone=o),type:"tel",placeholder:"+33612345678",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[v,t.value.phone]])]),e("div",Le,[e("label",ze,[a(r(Q),{class:"w-4 h-4 text-muted-foreground"}),s[21]||(s[21]=h(" Entreprise ",-1))]),l(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.company=o),type:"text",placeholder:"Nom de l'entreprise",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[v,t.value.company]])])])]),e("div",Fe,[e("div",Ge,[a(r(ee),{class:"w-5 h-5 text-primary"}),s[22]||(s[22]=e("h3",{class:"font-semibold"},"Sécurité",-1))]),e("div",He,[e("div",Je,[s[23]||(s[23]=e("label",{class:"text-sm font-medium"},"Nouveau mot de passe",-1)),l(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.value.password=o),type:"password",placeholder:"••••••••",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[v,t.value.password]])]),e("div",Ke,[s[24]||(s[24]=e("label",{class:"text-sm font-medium"},"Confirmer le mot de passe",-1)),l(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.value.password_confirmation=o),type:"password",placeholder:"••••••••",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[v,t.value.password_confirmation]])])]),s[25]||(s[25]=e("p",{class:"text-xs text-muted-foreground mt-2"},"Laisser vide pour ne pas modifier le mot de passe",-1))]),e("div",Oe,[e("div",Qe,[a(r(H),{class:"w-5 h-5 text-primary"}),s[26]||(s[26]=e("h3",{class:"font-semibold"},"Préférences de notifications",-1))]),e("div",We,[e("label",Xe,[l(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>t.value.email_notifications=o),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[k,t.value.email_notifications]]),e("div",Ye,[e("div",Ze,[a(r(S),{class:"w-4 h-4 text-muted-foreground"}),s[27]||(s[27]=e("div",{class:"font-medium text-sm"},"Notifications par email",-1))]),s[28]||(s[28]=e("div",{class:"text-xs text-muted-foreground mt-1"},"Recevoir les alertes importantes par email",-1))])]),e("label",es,[l(e("input",{"onUpdate:modelValue":s[7]||(s[7]=o=>t.value.weekly_reports=o),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[k,t.value.weekly_reports]]),e("div",ss,[e("div",ts,[a(r(U),{class:"w-4 h-4 text-muted-foreground"}),s[29]||(s[29]=e("div",{class:"font-medium text-sm"},"Rapports hebdomadaires",-1))]),s[30]||(s[30]=e("div",{class:"text-xs text-muted-foreground mt-1"},"Recevoir les statistiques chaque lundi matin",-1))])]),e("label",os,[l(e("input",{"onUpdate:modelValue":s[8]||(s[8]=o=>t.value.campaign_alerts=o),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[k,t.value.campaign_alerts]]),e("div",rs,[e("div",as,[a(r(se),{class:"w-4 h-4 text-muted-foreground"}),s[31]||(s[31]=e("div",{class:"font-medium text-sm"},"Alertes campagnes",-1))]),s[32]||(s[32]=e("div",{class:"text-xs text-muted-foreground mt-1"},"Notifications lors de l'envoi ou de la fin d'une campagne",-1))])])])]),p.value?(u(),b("div",is,[e("div",ns,[a(r(N),{class:"w-5 h-5"}),e("p",ls,n(p.value),1)])])):C("",!0),f.value?(u(),b("div",ds,[e("div",us,[a(r(te),{class:"w-5 h-5"}),e("p",cs,n(f.value),1)])])):C("",!0),e("div",ms,[e("button",{onClick:P,disabled:m.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6 py-2"},[m.value?(u(),b("div",fs)):(u(),V(r(N),{key:0,class:"w-4 h-4"})),e("span",null,n(m.value?"Enregistrement...":"Enregistrer les modifications"),1)],8,ps),e("button",{onClick:A,disabled:m.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[a(r(oe),{class:"w-4 h-4"}),s[33]||(s[33]=e("span",null,"Annuler",-1))],8,gs)])])]))])]),_:1}))}});export{Es as default};
