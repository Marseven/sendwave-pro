import{o as i,c as l,b as e,d as Q,r as d,j as M,l as W,m as E,n as X,i as Y,s as c,x as m,t as r,F as j,p as V,A as ee,q as se,w as N,f,v as U,C as A,D as te,z as oe,g as $}from"./main-BdDPueRn.js";import{_ as ne,o as re,g as S,r as ie,i as le,q as ae}from"./api-Cq_Jaxkk.js";import{t as b}from"./templateService-CO4mGeVv.js";import{a as T,b as B,s as de}from"./notifications-CHQAjgV4.js";import{r as ue}from"./PencilIcon-U20i-2i4.js";import{r as ce}from"./TrashIcon-BRVkVwoK.js";import{r as me}from"./EyeIcon-D1909HX9.js";import{r as pe}from"./SunIcon-C4J-xyDU.js";import{r as fe}from"./CheckCircleIcon-BGjVDXct.js";function ge(h,v){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8.25v-1.5m0 1.5c-1.355 0-2.697.056-4.024.166C6.845 8.51 6 9.473 6 10.608v2.513m6-4.871c1.355 0 2.697.056 4.024.166C17.155 8.51 18 9.473 18 10.608v2.513M15 8.25v-1.5m-6 1.5v-1.5m12 9.75-1.5.75a3.354 3.354 0 0 1-3 0 3.354 3.354 0 0 0-3 0 3.354 3.354 0 0 1-3 0 3.354 3.354 0 0 0-3 0 3.354 3.354 0 0 1-3 0L3 16.5m15-3.379a48.474 48.474 0 0 0-6-.371c-2.032 0-4.034.126-6 .371m12 0c.39.049.777.102 1.163.16 1.07.16 1.837 1.094 1.837 2.175v5.169c0 .621-.504 1.125-1.125 1.125H4.125A1.125 1.125 0 0 1 3 20.625v-5.17c0-1.08.768-2.014 1.837-2.174A47.78 47.78 0 0 1 6 13.12M12.265 3.11a.375.375 0 1 1-.53 0L12 2.845l.265.265Zm-3 0a.375.375 0 1 1-.53 0L9 2.845l.265.265Zm6 0a.375.375 0 1 1-.53 0L15 2.845l.265.265Z"})])}function ve(h,v){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"})])}function xe(h,v){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"})])}const be={class:"p-4 sm:p-6 lg:p-8"},he={class:"mb-4 sm:mb-6 lg:mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4"},we={class:"grid grid-cols-3 gap-3 sm:gap-4 lg:gap-6 mb-4 sm:mb-6 lg:mb-8"},ye={class:"rounded-lg border bg-card p-3 sm:p-4"},_e={class:"text-xl sm:text-2xl font-bold mt-1"},ke={class:"rounded-lg border bg-card p-3 sm:p-4"},Ce={class:"text-xl sm:text-2xl font-bold mt-1 text-success"},Me={class:"rounded-lg border bg-card p-3 sm:p-4"},je={class:"text-xl sm:text-2xl font-bold mt-1 text-primary"},Ve={key:0,class:"flex items-center justify-center py-8 sm:py-12"},Ae={key:1,class:"flex flex-col items-center justify-center py-8 sm:py-12 rounded-lg border bg-card px-4"},$e={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6"},Se={class:"p-4 sm:p-6"},Te={class:"flex items-start justify-between gap-2 mb-3 sm:mb-4"},De={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Ee={class:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0"},Ne={class:"min-w-0"},Ue={class:"font-semibold text-sm sm:text-base truncate"},Be={class:"text-xs text-muted-foreground truncate"},Le={class:"mb-3 sm:mb-4 p-2 sm:p-3 bg-muted/50 rounded-lg"},qe={class:"text-xs sm:text-sm text-muted-foreground line-clamp-3"},ze={class:"flex items-center justify-between text-xs text-muted-foreground mb-3 sm:mb-4"},Fe={class:"flex gap-1 sm:gap-2"},Re=["onClick"],He=["onClick"],Ie=["onClick"],Ze={class:"bg-background rounded-lg shadow-lg w-full max-w-sm sm:max-w-2xl p-4 sm:p-6 max-h-[90vh] overflow-y-auto"},Pe={class:"flex items-center justify-between mb-4 sm:mb-6"},Je={class:"text-lg sm:text-xl font-bold"},Ge={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4"},Oe={class:"space-y-1.5 sm:space-y-2"},Ke={class:"space-y-1.5 sm:space-y-2"},Qe=["value"],We={class:"flex items-center gap-2"},Xe={class:"space-y-2"},Ye={class:"flex items-center justify-between"},es={class:"text-xs text-muted-foreground"},ss={class:"p-4 bg-muted/50 rounded-lg"},ts={class:"grid grid-cols-2 gap-2 mb-3"},os=["onClick"],ns={class:"font-mono"},rs={class:"text-muted-foreground ml-2"},is={key:0,class:"p-4 bg-primary/5 border border-primary/20 rounded-lg"},ls={class:"flex items-center justify-between mb-3"},as={class:"text-sm font-medium flex items-center gap-2"},ds={class:"p-3 bg-background rounded border font-mono text-sm whitespace-pre-wrap"},us={class:"text-xs text-muted-foreground mt-2"},cs={class:"grid grid-cols-2 gap-4"},ms={class:"space-y-2"},ps={class:"space-y-2"},fs={class:"flex gap-3 pt-4 border-t"},gs=["disabled"],vs={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Vs=Q({__name:"Templates",setup(h){const v=Y(),w=d(!1),y=d(!1),p=d([]),_=d(!1),g=d(!1),D=d(""),u=d(null),L=d({marketing:"Marketing",notifications:"Notifications",alerts:"Alertes",reminders:"Rappels",confirmations:"Confirmations",promotions:"Promotions",other:"Autre"}),q={"{nom}":"Nom complet","{prenom}":"Prénom","{phone}":"Téléphone","{email}":"Email","{date}":"Date actuelle","{heure}":"Heure actuelle","{code}":"Code unique"},z={"{nom}":"Jean Dupont","{prenom}":"Jean","{phone}":"+241 77 00 00 00","{email}":"jean@exemple.com","{date}":new Date().toLocaleDateString("fr-FR"),"{heure}":new Date().toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),"{code}":"ABC123"},n=d({name:"",category:"",content:"",is_public:!1,icon:"document",status:"active"}),F={hand:xe,sun:pe,check:fe,calendar:ae,cake:ge,gift:ve,document:S};function R(o){return F[o]||S}const H=M(()=>p.value.filter(o=>o.status==="active").length),I=M(()=>p.value.reduce((o,s)=>o+(s.uses||0),0)),k=M(()=>{let o=n.value.content;for(const[s,t]of Object.entries(z))o=o.replaceAll(s,t);return o});async function C(){_.value=!0,D.value="";try{p.value=await b.getAll()}catch(o){D.value=o.message||"Erreur lors du chargement des modèles",console.error("Error loading templates:",o)}finally{_.value=!1}}function Z(){u.value=null,n.value={name:"",category:"",content:"",is_public:!1,icon:"document",status:"active"},w.value=!0}function P(o){u.value=o,n.value={name:o.name,category:o.category,content:o.content||o.message||"",is_public:o.is_public||!1,icon:o.icon||"document",status:o.status},y.value=!0}function x(){w.value=!1,y.value=!1,u.value=null}function J(o){n.value.content+=o}async function G(){var o,s;g.value=!0;try{u.value?(await b.update(u.value.id,n.value),T("Modèle modifié avec succès")):(await b.create(n.value),T("Modèle créé avec succès")),x(),await C()}catch(t){B(((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||t.message||"Erreur lors de l'enregistrement")}finally{g.value=!1}}async function O(o){if(await de("Supprimer le modèle ?",`Êtes-vous sûr de vouloir supprimer "${o.name}" ?`))try{await b.delete(o.id),T("Modèle supprimé avec succès"),await C()}catch(t){B(t.message||"Erreur lors de la suppression")}}function K(o){v.push({path:"/campaign/create",query:{templateId:o.id.toString()}})}return W(()=>{C()}),(o,s)=>(i(),E(ne,null,{default:X(()=>[e("div",be,[e("div",he,[s[7]||(s[7]=e("div",null,[e("h1",{class:"text-2xl sm:text-3xl font-bold"},"Modèles SMS"),e("p",{class:"text-sm text-muted-foreground mt-1 sm:mt-2"},"Créez et gérez vos modèles de messages")],-1)),e("button",{onClick:Z,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90 h-9 sm:h-10 px-3 sm:px-4 py-2"},[c(m(re),{class:"w-4 h-4"}),s[6]||(s[6]=e("span",null,"Nouveau modèle",-1))])]),e("div",we,[e("div",ye,[s[8]||(s[8]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Total modèles",-1)),e("div",_e,r(p.value.length),1)]),e("div",ke,[s[9]||(s[9]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Actifs",-1)),e("div",Ce,r(H.value),1)]),e("div",Me,[s[10]||(s[10]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Utilisations",-1)),e("div",je,r(I.value.toLocaleString("fr-FR")),1)])]),_.value?(i(),l("div",Ve,[...s[11]||(s[11]=[e("div",{class:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-primary"},null,-1)])])):p.value.length===0?(i(),l("div",Ae,[c(m(S),{class:"w-12 h-12 sm:w-16 sm:h-16 text-muted-foreground mb-3 sm:mb-4"}),s[12]||(s[12]=e("p",{class:"text-base sm:text-lg font-medium text-center"},"Aucun modèle trouvé",-1)),s[13]||(s[13]=e("p",{class:"text-xs sm:text-sm text-muted-foreground mt-1 text-center"},"Créez votre premier modèle pour commencer",-1))])):(i(),l("div",$e,[(i(!0),l(j,null,V(p.value,t=>(i(),l("div",{key:t.id,class:"rounded-lg border bg-card shadow-sm hover:shadow-md transition-shadow"},[e("div",Se,[e("div",Te,[e("div",De,[e("div",Ee,[(i(),E(ee(R(t.icon)),{class:"w-5 h-5 sm:w-6 sm:h-6 text-primary"}))]),e("div",Ne,[e("h3",Ue,r(t.name),1),e("p",Be,r(t.category),1)])]),e("span",{class:se(["text-xs px-2 py-0.5 sm:py-1 rounded-full flex-shrink-0",t.status==="active"?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},r(t.status==="active"?"Actif":"Inactif"),3)]),e("div",Le,[e("p",qe,r(t.message),1)]),e("div",ze,[e("span",null,r(t.uses||0)+" utilisations",1),e("span",null,r(t.message.length)+" car.",1)]),e("div",Fe,[e("button",{onClick:a=>P(t),class:"flex-1 inline-flex items-center justify-center gap-1 sm:gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors border border-input bg-background hover:bg-accent hover:text-accent-foreground h-8 sm:h-9"},[c(m(ue),{class:"w-3 h-3 sm:w-4 sm:h-4"}),s[14]||(s[14]=e("span",{class:"hidden sm:inline"},"Modifier",-1))],8,Re),e("button",{onClick:a=>O(t),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors hover:bg-destructive/10 hover:text-destructive h-8 w-8 sm:h-9 sm:w-9"},[c(m(ce),{class:"w-3 h-3 sm:w-4 sm:h-4"})],8,He),e("button",{onClick:a=>K(t),class:"flex-1 inline-flex items-center justify-center gap-1 sm:gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90 h-8 sm:h-9"},[c(m(ie),{class:"w-3 h-3 sm:w-4 sm:h-4"}),s[15]||(s[15]=e("span",{class:"hidden sm:inline"},"Utiliser",-1))],8,Ie)])])]))),128))]))]),w.value||y.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:N(x,["self"])},[e("div",Ze,[e("div",Pe,[e("h2",Je,r(u.value?"Modifier le modèle":"Nouveau modèle"),1),e("button",{onClick:x,class:"hover:bg-accent rounded-full p-1"},[c(m(le),{class:"w-5 h-5"})])]),e("form",{onSubmit:N(G,["prevent"]),class:"space-y-3 sm:space-y-4"},[e("div",Ge,[e("div",Oe,[s[16]||(s[16]=e("label",{class:"text-xs sm:text-sm font-medium"},"Nom du modèle *",-1)),f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.value.name=t),type:"text",required:"",placeholder:"Promotion été",class:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},null,512),[[U,n.value.name]])]),e("div",Ke,[s[18]||(s[18]=e("label",{class:"text-xs sm:text-sm font-medium"},"Catégorie *",-1)),f(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>n.value.category=t),required:"",class:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},[s[17]||(s[17]=e("option",{value:""},"Sélectionner...",-1)),(i(!0),l(j,null,V(L.value,(t,a)=>(i(),l("option",{key:a,value:a},r(t),9,Qe))),128))],512),[[A,n.value.category]])])]),e("div",We,[f(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>n.value.is_public=t),type:"checkbox",id:"is_public",class:"rounded border-gray-300"},null,512),[[te,n.value.is_public]]),s[19]||(s[19]=e("label",{for:"is_public",class:"text-sm font-medium cursor-pointer"}," Rendre ce modèle public (accessible à tous les utilisateurs) ",-1))]),e("div",Xe,[e("div",Ye,[s[20]||(s[20]=e("label",{class:"text-sm font-medium"},"Message *",-1)),e("span",es,r(n.value.content.length)+"/320 caractères",1)]),f(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=t=>n.value.content=t),required:"",rows:"6",maxlength:"320",placeholder:"Votre message avec des variables {nom}, {email}, etc.",class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 resize-none font-mono"},null,512),[[U,n.value.content]])]),e("div",ss,[s[21]||(s[21]=e("p",{class:"text-sm font-medium mb-3"},"Variables disponibles :",-1)),e("div",ts,[(i(),l(j,null,V(q,(t,a)=>e("button",{key:a,type:"button",onClick:xs=>J(a),class:"flex items-center justify-between text-xs px-3 py-2 rounded-md bg-background hover:bg-primary hover:text-primary-foreground border border-border hover:border-primary transition-colors text-left"},[e("span",ns,r(a),1),e("span",rs,r(t),1)],8,os)),64))])]),n.value.content?(i(),l("div",is,[e("div",ls,[e("p",as,[c(m(me),{class:"w-4 h-4"}),s[22]||(s[22]=oe(" Aperçu du message ",-1))]),s[23]||(s[23]=e("span",{class:"text-xs text-muted-foreground"},"Variables remplacées par des exemples",-1))]),e("div",ds,r(k.value),1),e("p",us,r(k.value.length)+" caractères • "+r(Math.ceil(k.value.length/160))+" SMS",1)])):$("",!0),e("div",cs,[e("div",ms,[s[25]||(s[25]=e("label",{class:"text-sm font-medium"},"Icône",-1)),f(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>n.value.icon=t),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...s[24]||(s[24]=[e("option",{value:"document"},"Document",-1),e("option",{value:"hand"},"Main levée",-1),e("option",{value:"sun"},"Soleil",-1),e("option",{value:"check"},"Check",-1),e("option",{value:"calendar"},"Calendrier",-1),e("option",{value:"cake"},"Gâteau",-1),e("option",{value:"gift"},"Cadeau",-1)])],512),[[A,n.value.icon]])]),e("div",ps,[s[27]||(s[27]=e("label",{class:"text-sm font-medium"},"Statut",-1)),f(e("select",{"onUpdate:modelValue":s[5]||(s[5]=t=>n.value.status=t),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...s[26]||(s[26]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[A,n.value.status]])])]),e("div",fs,[e("button",{type:"button",onClick:x,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"submit",disabled:g.value,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[g.value?(i(),l("div",vs)):$("",!0),e("span",null,r(g.value?"Enregistrement...":u.value?"Modifier":"Créer"),1)],8,gs)])],32)])])):$("",!0)]),_:1}))}});export{Vs as default};
