import{d as de,r as _,l as ce,m as h,n as ue,o as d,b as e,p,q as l,c as b,f as Z,v as ee,t as o,s as S,D as $,F as se,x as te}from"./main-QOMeYZLg.js";import{e as f,_ as pe,b as w,r as ve,l as me}from"./api-BdomKYOb.js";import{b as F,a as ge}from"./notifications-CHQAjgV4.js";import{r as D}from"./ArrowDownTrayIcon-DDHcSKeD.js";import{r as oe,a as ne,b as be}from"./TrophyIcon-x0IGMA49.js";import{r as fe}from"./CheckCircleIcon-Ci5j4t4y.js";import{r as xe}from"./RocketLaunchIcon-s1q-tiZu.js";import{r as _e}from"./CheckBadgeIcon-Dn7v2cvp.js";const y={async getDashboard(n="today"){return(await f.get("/analytics/dashboard",{params:{period:n}})).data},async getChartData(n="week"){return(await f.get("/analytics/chart",{params:{period:n}})).data},async getReport(n,r){return(await f.get("/analytics/report",{params:{start_date:n,end_date:r}})).data},async exportPdf(n,r){return(await f.get("/analytics/export/pdf",{params:{start_date:n,end_date:r},responseType:"blob"})).data},async exportExcel(n,r){return(await f.get("/analytics/export/excel",{params:{start_date:n,end_date:r},responseType:"blob"})).data},async exportCsv(n,r){return(await f.get("/analytics/export/csv",{params:{start_date:n,end_date:r},responseType:"blob"})).data},async getProviders(n="month"){return(await f.get("/analytics/providers",{params:{period:n}})).data},async getTopCampaigns(n="month",r=5){return(await f.get("/analytics/top-campaigns",{params:{period:n,limit:r}})).data},async updateAnalytics(n){return(await f.post("/analytics/update",{date:n})).data},downloadFile(n,r){const c=window.URL.createObjectURL(n),t=document.createElement("a");t.href=c,t.download=r,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(c)}},he={class:"p-8"},ye={class:"mb-8 flex items-center justify-between"},we={class:"flex items-center gap-2"},ke={class:"flex gap-3"},Ce=["disabled"],Se=["disabled"],$e=["disabled"],Fe={key:0,class:"flex items-center justify-center py-12"},De={key:1},Le={class:"rounded-lg border bg-card p-4 mb-6"},Ee={class:"flex items-center gap-4"},Me={class:"flex-1"},Ae={class:"flex-1"},je={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Re={class:"rounded-lg border bg-card p-6"},Te={class:"flex items-center gap-2 mb-4"},Ue={class:"text-3xl font-bold text-primary mb-2"},Ve={class:"flex items-center gap-2"},Be={class:"rounded-lg border bg-card p-6"},ze={class:"flex items-center gap-2 mb-4"},Oe={class:"text-3xl font-bold text-success mb-2"},Pe={class:"text-xs text-muted-foreground"},qe={class:"rounded-lg border bg-card p-6"},Ne={class:"flex items-center gap-2 mb-4"},Ie={class:"text-3xl font-bold mb-2"},He={class:"flex items-center gap-2"},Ke={class:"rounded-lg border bg-card p-6"},Ge={class:"flex items-center gap-2 mb-4"},Je={class:"text-3xl font-bold mb-2"},Qe={class:"text-xs text-muted-foreground"},We={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Xe={class:"rounded-lg border bg-card p-6"},Ye={class:"flex items-center gap-2 mb-6"},Ze={class:"space-y-4"},es={class:"flex items-center justify-between mb-2"},ss={class:"text-sm font-semibold"},ts={class:"w-full bg-gray-200 rounded-full h-3"},os={class:"text-xs text-muted-foreground mt-1"},ns={class:"flex items-center justify-between mb-2"},rs={class:"text-sm font-semibold"},as={class:"w-full bg-gray-200 rounded-full h-3"},is={class:"text-xs text-muted-foreground mt-1"},ls={class:"rounded-lg border bg-card p-6"},ds={class:"flex items-center gap-2 mb-6"},cs={key:0,class:"text-center py-8"},us={key:1,class:"space-y-3"},ps={class:"flex-1"},vs={class:"font-medium text-sm"},ms={class:"text-xs text-muted-foreground"},gs={class:"rounded-lg border bg-card p-6 mb-8"},bs={class:"flex items-center gap-2 mb-6"},fs={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},xs={class:"text-2xl font-bold"},_s={class:"text-2xl font-bold"},hs={class:"text-2xl font-bold"},ys={class:"rounded-lg border bg-card p-6"},ws={class:"flex items-center gap-2 mb-6"},ks={key:0,class:"text-center py-12"},Cs={key:1,class:"grid grid-cols-12 gap-2"},Ss=["title"],$s={class:"text-xs text-muted-foreground mt-1"},Ts=de({__name:"Reports",setup(n){const r=_(!0),c=_(!1),t=_(null),m=_(""),g=_("");function re(){const a=new Date,s=new Date;s.setDate(s.getDate()-30),g.value=a.toISOString().split("T")[0],m.value=s.toISOString().split("T")[0]}async function k(){var a,s;try{r.value=!0;const u=await y.getDashboard("month");t.value=u.data}catch(u){console.error("Error loading dashboard:",u),F(((s=(a=u.response)==null?void 0:a.data)==null?void 0:s.message)||"Erreur lors du chargement des statistiques")}finally{r.value=!1}}async function C(a){var s,u;if(!m.value||!g.value){F("Veuillez sélectionner une période");return}try{c.value=!0;let v,x;switch(a){case"pdf":v=await y.exportPdf(m.value,g.value),x=`rapport_${m.value}_${g.value}.pdf`;break;case"excel":v=await y.exportExcel(m.value,g.value),x=`rapport_${m.value}_${g.value}.xlsx`;break;case"csv":v=await y.exportCsv(m.value,g.value),x=`rapport_${m.value}_${g.value}.csv`;break}y.downloadFile(v,x),ge(`Rapport ${a.toUpperCase()} téléchargé avec succès`)}catch(v){console.error("Error exporting report:",v),F(((u=(s=v.response)==null?void 0:s.data)==null?void 0:u.message)||"Erreur lors de l'export")}finally{c.value=!1}}function ae(a){return a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toString()}function ie(a){const s=a.toLowerCase();return s==="actif"||s==="active"||s==="completed"?"bg-success/10 text-success":s==="planifié"||s==="scheduled"||s==="pending"?"bg-warning/10 text-warning":s==="terminé"||s==="sent"?"bg-blue-100 text-blue-700":"bg-muted text-muted-foreground"}function le(a){var u;if(!((u=t.value)!=null&&u.hourly_distribution.length))return 0;const s=Math.max(...t.value.hourly_distribution.map(v=>v.count));return s===0?0:Math.max(20,a/s*100)}return ce(()=>{re(),k()}),(a,s)=>(d(),h(pe,null,{default:ue(()=>{var u,v,x,L,E,M,A,j,R,T,U,V,B,z,O,P,q,N,I,H,K,G,J,Q,W,X,Y;return[e("div",he,[e("div",ye,[e("div",null,[e("div",we,[p(l(w),{class:"w-8 h-8 text-primary"}),s[5]||(s[5]=e("h1",{class:"text-3xl font-bold"},"Rapports & Statistiques",-1))]),s[6]||(s[6]=e("p",{class:"text-muted-foreground mt-2"},"Analysez les performances de vos campagnes",-1))]),e("div",ke,[e("button",{onClick:s[0]||(s[0]=i=>C("pdf")),disabled:c.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[p(l(D),{class:"w-4 h-4"}),s[7]||(s[7]=e("span",null,"Exporter PDF",-1))],8,Ce),e("button",{onClick:s[1]||(s[1]=i=>C("excel")),disabled:c.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[p(l(D),{class:"w-4 h-4"}),s[8]||(s[8]=e("span",null,"Exporter Excel",-1))],8,Se),e("button",{onClick:s[2]||(s[2]=i=>C("csv")),disabled:c.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[p(l(D),{class:"w-4 h-4"}),s[9]||(s[9]=e("span",null,"Exporter CSV",-1))],8,$e)])]),r.value?(d(),b("div",Fe,[...s[10]||(s[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(d(),b("div",De,[e("div",Le,[e("div",Ee,[e("div",Me,[s[11]||(s[11]=e("label",{class:"text-sm font-medium mb-1 block"},"Date de début",-1)),Z(e("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>m.value=i),type:"date",onChange:k,class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,544),[[ee,m.value]])]),e("div",Ae,[s[12]||(s[12]=e("label",{class:"text-sm font-medium mb-1 block"},"Date de fin",-1)),Z(e("input",{"onUpdate:modelValue":s[4]||(s[4]=i=>g.value=i),type:"date",onChange:k,class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,544),[[ee,g.value]])])])]),e("div",je,[e("div",Re,[e("div",Te,[p(l(ve),{class:"w-5 h-5 text-primary"}),s[13]||(s[13]=e("h3",{class:"font-semibold text-sm"},"SMS Envoyés",-1))]),e("div",Ue,o(ae(((u=t.value)==null?void 0:u.overview.sms_sent)||0)),1),e("div",Ve,[((v=t.value)==null?void 0:v.trends.sms_sent_change)>0?(d(),h(l(oe),{key:0,class:"w-4 h-4 text-success"})):(d(),h(l(ne),{key:1,class:"w-4 h-4 text-destructive"})),e("p",{class:S(["text-xs",((x=t.value)==null?void 0:x.trends.sms_sent_change)>0?"text-success":"text-destructive"])},o(((L=t.value)==null?void 0:L.trends.sms_sent_change)>0?"+":"")+o((E=t.value)==null?void 0:E.trends.sms_sent_change.toFixed(1))+"% ",3)])]),e("div",Be,[e("div",ze,[p(l(fe),{class:"w-5 h-5 text-success"}),s[14]||(s[14]=e("h3",{class:"font-semibold text-sm"},"Taux de livraison",-1))]),e("div",Oe,o((M=t.value)==null?void 0:M.overview.success_rate.toFixed(1))+"%",1),e("p",Pe,o((A=t.value)==null?void 0:A.overview.sms_delivered.toLocaleString())+" livrés",1)]),e("div",qe,[e("div",Ne,[p(l(xe),{class:"w-5 h-5 text-primary"}),s[15]||(s[15]=e("h3",{class:"font-semibold text-sm"},"Campagnes",-1))]),e("div",Ie,o(((j=t.value)==null?void 0:j.overview.campaigns_executed)||0),1),e("div",He,[((R=t.value)==null?void 0:R.trends.campaigns_change)>0?(d(),h(l(oe),{key:0,class:"w-4 h-4 text-success"})):(d(),h(l(ne),{key:1,class:"w-4 h-4 text-destructive"})),e("p",{class:S(["text-xs",((T=t.value)==null?void 0:T.trends.campaigns_change)>0?"text-success":"text-destructive"])},o(((U=t.value)==null?void 0:U.trends.campaigns_change)>0?"+":"")+o((V=t.value)==null?void 0:V.trends.campaigns_change.toFixed(1))+"% ",3)])]),e("div",Ke,[e("div",Ge,[p(l(_e),{class:"w-5 h-5 text-warning"}),s[16]||(s[16]=e("h3",{class:"font-semibold text-sm"},"Coût Total",-1))]),e("div",Je,o((B=t.value)==null?void 0:B.overview.total_cost.toLocaleString())+" FCFA",1),e("p",Qe,o((z=t.value)==null?void 0:z.overview.average_cost_per_sms.toFixed(2))+" FCFA/SMS",1)])]),e("div",We,[e("div",Xe,[e("div",Ye,[p(l(w),{class:"w-5 h-5 text-primary"}),s[17]||(s[17]=e("h3",{class:"font-semibold"},"Distribution par opérateur",-1))]),e("div",Ze,[e("div",null,[e("div",es,[s[18]||(s[18]=e("span",{class:"text-sm font-medium"},"Airtel",-1)),e("span",ss,o((O=t.value)==null?void 0:O.providers.airtel.percentage.toFixed(1))+"%",1)]),e("div",ts,[e("div",{class:"bg-red-500 h-3 rounded-full transition-all",style:$({width:((P=t.value)==null?void 0:P.providers.airtel.percentage)+"%"})},null,4)]),e("p",os,o((q=t.value)==null?void 0:q.providers.airtel.count.toLocaleString())+" SMS",1)]),e("div",null,[e("div",ns,[s[19]||(s[19]=e("span",{class:"text-sm font-medium"},"Moov",-1)),e("span",rs,o((N=t.value)==null?void 0:N.providers.moov.percentage.toFixed(1))+"%",1)]),e("div",as,[e("div",{class:"bg-blue-500 h-3 rounded-full transition-all",style:$({width:((I=t.value)==null?void 0:I.providers.moov.percentage)+"%"})},null,4)]),e("p",is,o((H=t.value)==null?void 0:H.providers.moov.count.toLocaleString())+" SMS",1)])])]),e("div",ls,[e("div",ds,[p(l(be),{class:"w-5 h-5 text-primary"}),s[20]||(s[20]=e("h3",{class:"font-semibold"},"Top Campagnes",-1))]),((K=t.value)==null?void 0:K.campaigns.length)===0?(d(),b("div",cs,[p(l(w),{class:"w-12 h-12 text-muted-foreground mx-auto mb-2"}),s[21]||(s[21]=e("p",{class:"text-sm text-muted-foreground"},"Aucune campagne",-1))])):(d(),b("div",us,[(d(!0),b(se,null,te((G=t.value)==null?void 0:G.campaigns.slice(0,5),i=>(d(),b("div",{key:i.id,class:"flex items-center justify-between p-3 bg-muted/50 rounded-lg"},[e("div",ps,[e("div",vs,o(i.name),1),e("div",ms,o(i.messages_sent.toLocaleString())+" envois",1)]),e("span",{class:S(["text-xs px-2 py-1 rounded-full",ie(i.status)])},o(i.status),3)]))),128))]))])]),e("div",gs,[e("div",bs,[p(l(w),{class:"w-5 h-5 text-primary"}),s[22]||(s[22]=e("h3",{class:"font-semibold"},"Analyse des coûts",-1))]),e("div",fs,[e("div",null,[s[23]||(s[23]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Coût Airtel",-1)),e("div",xs,o((J=t.value)==null?void 0:J.cost_analysis.airtel_cost.toLocaleString())+" FCFA",1)]),e("div",null,[s[24]||(s[24]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Coût Moov",-1)),e("div",_s,o((Q=t.value)==null?void 0:Q.cost_analysis.moov_cost.toLocaleString())+" FCFA",1)]),e("div",null,[s[25]||(s[25]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Moyenne journalière",-1)),e("div",hs,o((W=t.value)==null?void 0:W.cost_analysis.average_daily_cost.toLocaleString())+" FCFA",1)])])]),e("div",ys,[e("div",ws,[p(l(me),{class:"w-5 h-5 text-primary"}),s[26]||(s[26]=e("h3",{class:"font-semibold"},"Distribution horaire des envois",-1))]),((X=t.value)==null?void 0:X.hourly_distribution.length)===0?(d(),b("div",ks,[...s[27]||(s[27]=[e("p",{class:"text-muted-foreground"},"Aucune donnée disponible",-1)])])):(d(),b("div",Cs,[(d(!0),b(se,null,te((Y=t.value)==null?void 0:Y.hourly_distribution,i=>(d(),b("div",{key:i.hour,class:"flex flex-col items-center"},[e("div",{class:"w-full bg-primary/20 rounded-t",style:$({height:le(i.count)+"px"})},[e("div",{class:"w-full bg-primary rounded-t transition-all",style:{height:"100%"},title:`${i.count} SMS à ${i.hour}h`},null,8,Ss)],4),e("div",$s,o(i.hour)+"h",1)]))),128))]))])]))])]}),_:1}))}});export{Ts as default};
