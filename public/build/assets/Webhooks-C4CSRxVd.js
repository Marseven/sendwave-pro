const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DzxFOu40.js","assets/main-QOMeYZLg.js","assets/main-Dgx8liR_.css","assets/ArrowDownTrayIcon-DDHcSKeD.js","assets/api-BdomKYOb.js","assets/TrophyIcon-x0IGMA49.js","assets/ChevronRightIcon-BhH_CpAE.js","assets/BellAlertIcon-BvrxWtFX.js","assets/BoltIcon-H1sy8rsx.js","assets/BookOpenIcon-pj4OKJg2.js","assets/CameraIcon-BjudTQz0.js","assets/SunIcon-BUHnk8tV.js","assets/CalendarDaysIcon-AyD0u1cy.js","assets/CheckBadgeIcon-Dn7v2cvp.js","assets/CheckCircleIcon-Ci5j4t4y.js","assets/SignalIcon-xbGorREd.js","assets/DocumentArrowDownIcon-DQxmIYOm.js","assets/InformationCircleIcon-Bq5Ee9X4.js","assets/EnvelopeIcon-DTHM63Ok.js","assets/XCircleIcon-D4D8hFkk.js","assets/ExclamationTriangleIcon-D7oYYh82.js","assets/EyeIcon-CdJQ5_-h.js","assets/FolderOpenIcon-BzKA73zu.js","assets/IdentificationIcon-Cl8g3Nrr.js","assets/KeyIcon-DDWUxDIt.js","assets/LockOpenIcon-C-EMRSG3.js","assets/PencilIcon-CQf5oVaA.js","assets/PhoneIcon-BA4INBz6.js","assets/RocketLaunchIcon-s1q-tiZu.js","assets/TagIcon-BTAdzGdP.js","assets/TrashIcon-XbWTkXzE.js","assets/UserGroupIcon-C60upjqe.js","assets/UserIcon-B7_3Qs1s.js","assets/XMarkIcon-BZI0ZsR5.js","assets/notifications-CHQAjgV4.js"])))=>i.map(i=>d[i]);
import{o as d,c as u,b as e,d as H,E as X,G as Z,r as g,k as $,l as J,m as S,n as K,_ as Q,p as b,q as v,i as A,y as T,t as a,x as E,F as M,s as Y,w as V,f as D,v as z,B as ee,g as te}from"./main-QOMeYZLg.js";import{e as i,_ as se,h as B,l as oe}from"./api-BdomKYOb.js";import{b as f,a as w,s as re}from"./notifications-CHQAjgV4.js";import{r as ne}from"./CheckCircleIcon-Ci5j4t4y.js";import{r as ae}from"./ExclamationTriangleIcon-D7oYYh82.js";function de(o,r){return d(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}function le(o,r){return d(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"})])}const x={async getAll(){const o=await i.get("/webhooks");return o.data.data||o.data},async getById(o){const r=await i.get(`/webhooks/${o}`);return r.data.data||r.data},async create(o){const r=await i.post("/webhooks",o);return r.data.data||r.data},async update(o,r){const c=await i.put(`/webhooks/${o}`,r);return c.data.data||c.data},async delete(o){await i.delete(`/webhooks/${o}`)},async toggle(o){const r=await i.post(`/webhooks/${o}/toggle`);return r.data.data||r.data},async test(o){return(await i.post(`/webhooks/${o}/test`)).data},async getLogs(o,r){const c=await i.get(`/webhooks/${o}/logs`,{params:r});return c.data.data||c.data},async getStats(o){const r=await i.get(`/webhooks/${o}/stats`);return r.data.data||r.data},async getEvents(){const o=await i.get("/webhooks/events");return o.data.data||o.data}},ie={class:"p-8"},ue={class:"mb-8 flex justify-between items-center"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},me={class:"rounded-lg border bg-card text-card-foreground shadow-sm p-6"},pe={class:"flex items-center justify-between mb-2"},be={class:"text-3xl font-bold"},ve={class:"text-xs text-muted-foreground mt-2"},fe={class:"rounded-lg border bg-card text-card-foreground shadow-sm p-6"},ge={class:"flex items-center justify-between mb-2"},xe={class:"text-3xl font-bold text-success"},he={class:"rounded-lg border bg-card text-card-foreground shadow-sm p-6"},we={class:"flex items-center justify-between mb-2"},ye={class:"text-3xl font-bold text-destructive"},_e={class:"rounded-lg border bg-card shadow-sm mb-8"},ke={class:"p-6"},Ce={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},We={class:"rounded-lg border bg-card shadow-sm"},$e={class:"p-6"},Se={key:0,class:"text-center py-12"},Ae={key:1,class:"text-center py-12"},Ee={key:2,class:"overflow-x-auto"},Me={class:"w-full"},De={class:"p-4"},Ie={class:"p-4"},Le={class:"text-sm font-mono text-muted-foreground truncate block max-w-xs"},je={class:"p-4"},Te={class:"p-4"},Ve={class:"p-4 text-success font-medium"},ze={class:"p-4 text-destructive font-medium"},Be={class:"p-4"},Ne={class:"flex gap-2"},Re=["onClick"],qe=["onClick","title"],Ue=["onClick"],Pe=["onClick"],Fe={class:"rounded-lg border bg-card shadow-sm mt-8"},Oe={class:"p-6 space-y-4 text-sm"},Ge={class:"flex items-center gap-2 mb-2"},He={class:"flex items-center gap-2 mb-2"},Xe={class:"flex items-center gap-2 mb-2"},Ze={class:"bg-card rounded-lg shadow-xl max-w-2xl w-full m-4 max-h-[90vh] overflow-y-auto"},Je={class:"p-6 border-b border-border"},Ke={class:"text-xl font-semibold"},Qe={class:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto p-2 border border-border rounded-lg"},Ye=["value"],et={class:"text-sm"},tt={class:"flex gap-3 pt-4"},st=["disabled"],ot=H({__name:"Webhooks",async setup(o){let r,c;const I=X(([r,c]=Z(()=>Q(()=>import("./index-DzxFOu40.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]))),r=await r,c(),r).LinkIcon),m=g([]),C=g(!1),y=g(!1),_=g(!1),p=g(null),l=g({name:"",url:"",events:[]}),L=["message.sent","message.delivered","message.failed","campaign.started","campaign.completed","campaign.failed","contact.created","contact.updated","contact.deleted","sub_account.created","sub_account.suspended","blacklist.added"],N=$(()=>m.value.filter(n=>n.is_active).length),R=$(()=>m.value.reduce((n,t)=>n+t.success_count,0)),q=$(()=>m.value.reduce((n,t)=>n+t.failure_count,0));async function k(){C.value=!0;try{m.value=await x.getAll()}catch(n){console.error("Error loading webhooks:",n),f("Impossible de charger les webhooks")}finally{C.value=!1}}function j(){p.value=null,l.value={name:"",url:"",events:[]},_.value=!0}function U(n){p.value=n,l.value={name:n.name,url:n.url,events:[...n.events]},_.value=!0}function W(){_.value=!1,p.value=null}async function P(){if(l.value.events.length===0){f("Veuillez sélectionner au moins un événement");return}y.value=!0;try{p.value?(await x.update(p.value.id,l.value),w("Webhook modifié avec succès")):(await x.create(l.value),w("Webhook créé avec succès")),await k(),W()}catch(n){console.error("Error saving webhook:",n),f("Impossible de sauvegarder le webhook")}finally{y.value=!1}}async function F(n){try{const t=await x.test(n.id);t.success?w(`Test réussi (Code: ${t.response_code})`):f(`Test échoué (Code: ${t.response_code})`)}catch(t){console.error("Error testing webhook:",t),f("Impossible de tester le webhook")}}async function O(n){try{await x.toggle(n.id),w(`Webhook ${n.is_active?"désactivé":"activé"} avec succès`),await k()}catch(t){console.error("Error toggling webhook:",t),f("Impossible de modifier le statut du webhook")}}async function G(n){if(await re("Êtes-vous sûr de vouloir supprimer ce webhook ?",`Le webhook "${n.name}" sera définitivement supprimé.`))try{await x.delete(n.id),w("Webhook supprimé avec succès"),await k()}catch(s){console.error("Error deleting webhook:",s),f("Impossible de supprimer le webhook")}}return J(()=>{k()}),(n,t)=>(d(),S(se,null,{default:K(()=>[e("div",ie,[e("div",ue,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-foreground"},"Webhooks"),e("p",{class:"text-muted-foreground mt-2"},"Intégrez SendWave Pro avec vos applications tierces")],-1)),e("button",{onClick:j,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors flex items-center gap-2"},[b(v(B),{class:"w-5 h-5"}),t[3]||(t[3]=A(" Nouveau Webhook ",-1))])]),e("div",ce,[e("div",me,[e("div",pe,[t[5]||(t[5]=e("h3",{class:"text-sm font-medium text-muted-foreground"},"Webhooks Actifs",-1)),(d(),S(T(I.value),{class:"w-8 h-8 text-primary"}))]),e("p",be,a(N.value),1),e("p",ve,"sur "+a(m.value.length)+" total",1)]),e("div",fe,[e("div",ge,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-muted-foreground"},"Livraisons Réussies",-1)),b(v(ne),{class:"w-8 h-8 text-success"})]),e("p",xe,a(R.value),1),t[7]||(t[7]=e("p",{class:"text-xs text-muted-foreground mt-2"},"au total",-1))]),e("div",he,[e("div",we,[t[8]||(t[8]=e("h3",{class:"text-sm font-medium text-muted-foreground"},"Échecs",-1)),b(v(ae),{class:"w-8 h-8 text-destructive"})]),e("p",ye,a(q.value),1),t[9]||(t[9]=e("p",{class:"text-xs text-muted-foreground mt-2"},"au total",-1))])]),e("div",_e,[t[10]||(t[10]=e("div",{class:"p-6 border-b border-border"},[e("h2",{class:"text-xl font-semibold"},"Événements Disponibles"),e("p",{class:"text-sm text-muted-foreground mt-1"},"12 types d'événements pour déclencher vos webhooks")],-1)),e("div",ke,[e("div",Ce,[(d(),u(M,null,E(L,s=>e("div",{key:s,class:"px-3 py-2 bg-secondary rounded-lg text-sm font-medium text-center"},a(s),1)),64))])])]),e("div",We,[t[16]||(t[16]=e("div",{class:"p-6 border-b border-border"},[e("h2",{class:"text-xl font-semibold"},"Vos Webhooks"),e("p",{class:"text-sm text-muted-foreground mt-1"},"Gérez vos endpoints de webhooks et surveillez leur statut")],-1)),e("div",$e,[C.value?(d(),u("div",Se,[...t[11]||(t[11]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"},null,-1),e("p",{class:"text-muted-foreground"},"Chargement des webhooks...",-1)])])):m.value.length===0?(d(),u("div",Ae,[(d(),S(T(I.value),{class:"w-12 h-12 text-muted-foreground mx-auto mb-4"})),t[13]||(t[13]=e("h3",{class:"text-lg font-medium mb-2"},"Aucun webhook configuré",-1)),t[14]||(t[14]=e("p",{class:"text-muted-foreground mb-4"},"Commencez par créer votre premier webhook pour recevoir des événements",-1)),e("button",{onClick:j,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors inline-flex items-center gap-2"},[b(v(B),{class:"w-5 h-5"}),t[12]||(t[12]=A(" Créer un Webhook ",-1))])])):(d(),u("div",Ee,[e("table",Me,[t[15]||(t[15]=e("thead",null,[e("tr",{class:"border-b border-border"},[e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"Nom"),e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"URL"),e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"Événements"),e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"Statut"),e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"Succès"),e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"Échecs"),e("th",{class:"text-left p-4 font-medium text-muted-foreground"},"Actions")])],-1)),e("tbody",null,[(d(!0),u(M,null,E(m.value,s=>(d(),u("tr",{key:s.id,class:"border-b border-border hover:bg-muted/50"},[e("td",De,a(s.name),1),e("td",Ie,[e("span",Le,a(s.url),1)]),e("td",je,a(s.events.length)+" événement(s)",1),e("td",Te,[e("span",{class:Y(["px-2 py-1 rounded-full text-xs font-medium",s.is_active?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},a(s.is_active?"Actif":"Inactif"),3)]),e("td",Ve,a(s.success_count),1),e("td",ze,a(s.failure_count),1),e("td",Be,[e("div",Ne,[e("button",{onClick:h=>F(s),class:"px-3 py-1 text-sm border border-border rounded hover:bg-muted transition-colors",title:"Tester"}," Tester ",8,Re),e("button",{onClick:h=>O(s),class:"px-3 py-1 text-sm border border-border rounded hover:bg-muted transition-colors",title:s.is_active?"Désactiver":"Activer"},a(s.is_active?"Désactiver":"Activer"),9,qe),e("button",{onClick:h=>U(s),class:"px-3 py-1 text-sm border border-border rounded hover:bg-muted transition-colors",title:"Modifier"}," Modifier ",8,Ue),e("button",{onClick:h=>G(s),class:"px-3 py-1 text-sm border border-destructive text-destructive rounded hover:bg-destructive/10 transition-colors",title:"Supprimer"}," Supprimer ",8,Pe)])])]))),128))])])]))])]),e("div",Fe,[t[23]||(t[23]=e("div",{class:"p-6 border-b border-border"},[e("h2",{class:"text-xl font-semibold"},"Documentation")],-1)),e("div",Oe,[e("div",null,[e("div",Ge,[b(v(le),{class:"w-5 h-5 text-primary"}),t[17]||(t[17]=e("h4",{class:"font-semibold"},"Sécurité",-1))]),t[18]||(t[18]=e("p",{class:"text-muted-foreground"},[A(" Tous les webhooks incluent une signature HMAC-SHA256 dans le header "),e("code",{class:"px-1 py-0.5 bg-secondary rounded"},"X-Webhook-Signature")],-1))]),e("div",null,[e("div",He,[b(v(de),{class:"w-5 h-5 text-primary"}),t[19]||(t[19]=e("h4",{class:"font-semibold"},"Retry Logic",-1))]),t[20]||(t[20]=e("p",{class:"text-muted-foreground"}," Les webhooks échoués sont automatiquement retry jusqu'à 3 fois avec un délai exponentiel (1s, 2s, 4s) ",-1))]),e("div",null,[e("div",Xe,[b(v(oe),{class:"w-5 h-5 text-primary"}),t[21]||(t[21]=e("h4",{class:"font-semibold"},"Timeout",-1))]),t[22]||(t[22]=e("p",{class:"text-muted-foreground"}," Le timeout par défaut est de 30 secondes, configurable entre 5 et 120 secondes ",-1))])])])]),_.value?(d(),u("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:V(W,["self"])},[e("div",Ze,[e("div",Je,[e("h2",Ke,a(p.value?"Modifier le webhook":"Créer un nouveau webhook"),1)]),e("form",{onSubmit:V(P,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium mb-2"},"Nom du webhook",-1)),D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Ex: Notification Slack"},null,512),[[z,l.value.name]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium mb-2"},"URL du webhook",-1)),D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.url=s),type:"url",required:"",class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"https://example.com/webhook"},null,512),[[z,l.value.url]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium mb-2"},"Événements à écouter",-1)),e("div",Qe,[(d(),u(M,null,E(L,s=>e("label",{key:s,class:"flex items-center gap-2 p-2 hover:bg-muted rounded cursor-pointer"},[D(e("input",{type:"checkbox",value:s,"onUpdate:modelValue":t[2]||(t[2]=h=>l.value.events=h),class:"w-4 h-4"},null,8,Ye),[[ee,l.value.events]]),e("span",et,a(s),1)])),64))])]),e("div",tt,[e("button",{type:"submit",disabled:y.value,class:"flex-1 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50"},a(y.value?"Enregistrement...":p.value?"Modifier":"Créer"),9,st),e("button",{type:"button",onClick:W,class:"px-4 py-2 border border-border rounded-lg hover:bg-muted transition-colors"}," Annuler ")])],32)])])):te("",!0)]),_:1}))}}),it=Object.freeze(Object.defineProperty({__proto__:null,default:ot},Symbol.toStringTag,{value:"Module"}));export{it as W,le as a,de as r};
