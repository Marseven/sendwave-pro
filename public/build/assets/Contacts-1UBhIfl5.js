import{o as n,c as l,b as e,d as Ie,r,k as b,l as Fe,m as ne,n as Ne,p as d,q as a,t as i,g as m,f as v,v as M,A as O,F as D,x as L,s as Ue,w as Z}from"./main-CruKEy0d.js";import{_ as De,e as ie,h as le,a as Le,i as Te}from"./api-Da-TWCKA.js";import{c as T}from"./contactService-CvAcG5pH.js";import{b as x,a as z,s as Ge}from"./notifications-CHQAjgV4.js";import{r as re}from"./UserGroupIcon-DNg47t0c.js";import{r as qe}from"./PencilIcon-DorPZ9G_.js";import{r as ee}from"./TrashIcon-07V3VCe3.js";import{r as te}from"./XMarkIcon-BO5n6oz2.js";import{r as Be}from"./TagIcon-C295OLtd.js";import{r as He}from"./ExclamationTriangleIcon-CK6owchZ.js";function ue(K,k){return n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function Re(K,k){return n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function Oe(K,k){return n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}const Ze={class:"p-8"},Ke={class:"mb-8 flex items-center justify-between"},Pe={class:"flex gap-3"},Je={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Qe={class:"rounded-lg border bg-card p-4"},We={class:"text-2xl font-bold mt-1"},Xe={class:"rounded-lg border bg-card p-4"},Ye={class:"text-2xl font-bold mt-1 text-success"},et={class:"rounded-lg border bg-card p-4"},tt={class:"text-2xl font-bold mt-1 text-muted-foreground"},st={class:"rounded-lg border bg-card p-4"},ot={class:"text-2xl font-bold mt-1 text-primary"},nt={class:"rounded-lg border bg-card shadow-sm mb-6 p-6"},it={class:"flex gap-4"},lt={class:"flex-1"},rt={class:"rounded-lg border bg-card shadow-sm"},ut={key:0,class:"flex items-center justify-center py-12"},at={key:1,class:"flex flex-col items-center justify-center py-12"},dt={key:2,class:"overflow-x-auto"},ct={class:"w-full"},ft={class:"border-b bg-muted/50"},mt={class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},vt=["checked"],pt={class:"p-4"},gt=["checked","onChange"],bt={class:"p-4 font-medium"},xt={class:"p-4 text-sm text-muted-foreground"},ht={class:"p-4 text-sm"},yt={class:"p-4"},wt={class:"p-4 text-sm text-muted-foreground"},kt={class:"p-4"},_t={class:"flex gap-2"},Ct=["onClick"],jt=["onClick"],At={class:"flex items-center justify-between mt-6"},Vt={class:"text-sm text-muted-foreground"},$t={class:"bg-background rounded-lg shadow-lg w-full max-w-md p-6"},St={class:"flex items-center justify-between mb-6"},Et={class:"text-xl font-bold"},Mt={class:"space-y-2"},zt={class:"space-y-2"},It={class:"space-y-2"},Ft={class:"space-y-2"},Nt={class:"space-y-3 pt-4 border-t"},Ut={class:"flex items-center justify-between"},Dt={key:0,class:"space-y-2"},Lt={class:"flex-1"},Tt={class:"text-xs font-medium text-muted-foreground"},Gt={class:"text-sm"},qt=["onClick"],Bt={class:"space-y-2 p-3 bg-muted/30 rounded-lg"},Ht={class:"grid grid-cols-2 gap-2"},Rt={class:"flex gap-3 pt-4 border-t"},Ot=["disabled"],Zt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Kt={class:"bg-background rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6"},Pt={class:"flex items-center justify-between mb-6"},Jt={key:0,class:"space-y-6"},Qt={class:"border-2 border-dashed rounded-lg p-8 text-center"},Wt={key:0,class:"p-4 bg-muted rounded-lg"},Xt={class:"flex items-center justify-between"},Yt={class:"flex items-center gap-3"},es={class:"font-medium"},ts={class:"text-xs text-muted-foreground"},ss={class:"p-4 bg-primary/10 rounded-lg border border-primary/20"},os={class:"flex items-start gap-3"},ns={class:"flex justify-end gap-3 pt-4 border-t"},is=["disabled"],ls={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},rs={key:1,class:"space-y-6"},us={class:"p-4 bg-muted/50 rounded-lg"},as={class:"text-xs text-muted-foreground"},ds={class:"space-y-4"},cs={class:"p-3 bg-muted rounded-lg"},fs={class:"font-medium"},ms={class:"text-xs text-muted-foreground mt-1"},vs={class:"space-y-2"},ps=["onUpdate:modelValue"],gs={class:"p-4 bg-warning/10 rounded-lg border border-warning/20"},bs={class:"flex items-start gap-3"},xs={class:"flex justify-between gap-3 pt-4 border-t"},hs=["disabled"],ys={key:2,class:"space-y-6"},ws={class:"p-4 bg-muted/50 rounded-lg"},ks={class:"text-xs text-muted-foreground"},_s={class:"rounded-lg border overflow-hidden max-h-96 overflow-y-auto"},Cs={class:"w-full"},js={class:"p-3 text-sm"},As={class:"p-3 text-sm text-muted-foreground"},Vs={class:"p-3 text-sm"},$s={key:0,class:"text-center text-sm text-muted-foreground"},Ss={class:"flex justify-between gap-3 pt-4 border-t"},Es=["disabled"],Ms={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},zs={class:"bg-background rounded-lg shadow-lg w-full max-w-md"},Is={class:"border-b p-6"},Fs={class:"flex items-center justify-between"},Ns={class:"text-sm text-muted-foreground mt-2"},Us={class:"p-6 space-y-4"},Ds={key:0,class:"text-center py-6"},Ls={key:1,class:"space-y-2"},Ts=["value"],Gs={class:"flex gap-3 pt-4 border-t"},qs=["disabled"],Bs={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Ys=Ie({__name:"Contacts",setup(K){const k=r(""),G=r("all"),P=r(!1),J=r(!1),Q=r(!1),W=r(!1),p=r([]),q=r([]),f=r([]),_=r(null),X=r(!1),I=r(!1),se=r(""),F=r(!1),c=r({name:"",email:"",phone:"",status:"active",custom_fields:{}}),C=r(null),j=r(""),A=r(""),h=r(1),g=r(null),N=r([]),V=r([]),y=r({}),$=r(!1),U=r(!1),ae=r(null),S=b(()=>{let o=p.value;if(k.value){const t=k.value.toLowerCase();o=o.filter(s=>s.name.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)||s.phone.includes(t))}return G.value!=="all"&&(o=o.filter(t=>t.status===G.value)),o}),de=b(()=>p.value.length),ce=b(()=>p.value.filter(o=>o.status==="active").length),fe=b(()=>p.value.filter(o=>o.status==="inactive").length),me=b(()=>{const o=new Date;return o.setDate(o.getDate()-30),p.value.filter(t=>new Date(t.created_at||"")>=o).length}),ve=b(()=>{const o=Object.values(y.value).filter(t=>t);return o.includes("name")&&o.includes("email")&&o.includes("phone")}),w=b(()=>V.value.map(o=>{const t={status:"active"};return N.value.forEach((s,u)=>{const E=y.value[s];E&&(t[E]=o[u])}),t}).filter(o=>o.name&&o.email&&o.phone)),oe=b(()=>S.value.length>0&&S.value.every(o=>f.value.includes(o.id))),pe=b(()=>f.value.length>0);function ge(o){return o?new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}async function Y(){X.value=!0,se.value="";try{const o=await T.getAll();console.log("Contacts loaded:",o),p.value=o}catch(o){se.value=o.message||"Erreur lors du chargement des contacts",console.error("Error loading contacts:",o)}finally{X.value=!1}}function be(){C.value=null,c.value={name:"",email:"",phone:"",status:"active",custom_fields:{}},j.value="",A.value="",P.value=!0}function xe(o){C.value=o,c.value={name:o.name,email:o.email,phone:o.phone,status:o.status,custom_fields:o.custom_fields||{}},j.value="",A.value="",J.value=!0}function he(){if(!j.value.trim()){x("Le nom du champ est requis");return}c.value.custom_fields[j.value]=A.value,j.value="",A.value=""}function ye(o){delete c.value.custom_fields[o]}function B(){P.value=!1,J.value=!1,C.value=null}async function we(){var o,t;I.value=!0;try{C.value?(await T.update(C.value.id,c.value),z("Contact modifié avec succès")):(await T.create(c.value),z("Contact ajouté avec succès")),B(),await Y()}catch(s){x(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||s.message||"Erreur lors de l'enregistrement")}finally{I.value=!1}}async function ke(o){if(await Ge("Supprimer le contact ?",`Êtes-vous sûr de vouloir supprimer ${o.name} ?`))try{await T.delete(o.id),z("Contact supprimé avec succès"),p.value=p.value.filter(s=>s.id!==o.id)}catch(s){x(s.message||"Erreur lors de la suppression"),console.error("Error deleting contact:",s)}}function H(){Q.value=!1,h.value=1,g.value=null,N.value=[],V.value=[],y.value={}}function _e(o){const t=o.target;t.files&&t.files[0]&&(g.value=t.files[0])}async function Ce(){if(g.value){$.value=!0;try{const t=(await g.value.text()).split(`
`).filter(s=>s.trim());if(t.length===0){x("Le fichier CSV est vide"),$.value=!1;return}N.value=t[0].split(",").map(s=>s.trim().replace(/"/g,"")),V.value=t.slice(1,101).map(s=>s.split(",").map(u=>u.trim().replace(/"/g,""))),N.value.forEach(s=>{const u=s.toLowerCase();u.includes("nom")||u.includes("name")?y.value[s]="name":u.includes("email")||u.includes("mail")?y.value[s]="email":(u.includes("tel")||u.includes("phone")||u.includes("mobile"))&&(y.value[s]="phone")}),h.value=2}catch(o){x("Erreur lors de la lecture du fichier: "+o.message)}finally{$.value=!1}}}async function je(){if(w.value.length!==0){U.value=!0;try{let o=0,t=0;for(const s of w.value)try{await T.create(s),o++}catch(u){t++,console.error("Error importing contact:",u)}t>0?z(`Importation terminée: ${o} contacts importés, ${t} erreurs`):z(`${o} contacts importés avec succès !`),await Y(),H()}catch(o){x(o.message||"Erreur lors de l'importation")}finally{U.value=!1}}}function Ae(){oe.value?f.value=[]:f.value=S.value.map(o=>o.id)}function Ve(o){const t=f.value.indexOf(o);t>-1?f.value.splice(t,1):f.value.push(o)}function $e(o){return f.value.includes(o)}async function Se(){try{const o=await ie.get("/contact-groups");q.value=o.data.data}catch(o){console.error("Error loading groups:",o)}}function Ee(){if(f.value.length===0){x("Veuillez sélectionner au moins un contact");return}_.value=null,W.value=!0}function R(){W.value=!1,_.value=null}async function Me(){var o,t;if(!_.value){x("Veuillez sélectionner un groupe");return}F.value=!0;try{await ie.post(`/contact-groups/${_.value}/contacts/add`,{contact_ids:f.value}),z(`${f.value.length} contact(s) ajouté(s) au groupe`),f.value=[],R()}catch(s){x(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Erreur lors de l'ajout au groupe")}finally{F.value=!1}}return Fe(()=>{Y(),Se()}),(o,t)=>(n(),ne(De,null,{default:Ne(()=>[e("div",Ze,[e("div",Ke,[t[17]||(t[17]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Contacts"),e("p",{class:"text-muted-foreground mt-2"},"Gérez votre liste de contacts")],-1)),e("div",Pe,[pe.value?(n(),l("button",{key:0,onClick:Ee,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(a(re),{class:"w-4 h-4"}),e("span",null,"Ajouter à un groupe ("+i(f.value.length)+")",1)])):m("",!0),e("button",{onClick:t[0]||(t[0]=s=>Q.value=!0),class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(a(ue),{class:"w-4 h-4"}),t[15]||(t[15]=e("span",null,"Importer",-1))]),e("button",{onClick:be,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[d(a(le),{class:"w-4 h-4"}),t[16]||(t[16]=e("span",null,"Nouveau contact",-1))])])]),e("div",Je,[e("div",Qe,[t[18]||(t[18]=e("div",{class:"text-sm text-muted-foreground"},"Total contacts",-1)),e("div",We,i(de.value),1)]),e("div",Xe,[t[19]||(t[19]=e("div",{class:"text-sm text-muted-foreground"},"Actifs",-1)),e("div",Ye,i(ce.value),1)]),e("div",et,[t[20]||(t[20]=e("div",{class:"text-sm text-muted-foreground"},"Inactifs",-1)),e("div",tt,i(fe.value),1)]),e("div",st,[t[21]||(t[21]=e("div",{class:"text-sm text-muted-foreground"},"Nouveaux (30j)",-1)),e("div",ot,i(me.value),1)])]),e("div",nt,[e("div",it,[e("div",lt,[v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>k.value=s),type:"text",placeholder:"Rechercher par nom, email ou téléphone...",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},null,512),[[M,k.value]])]),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>G.value=s),class:"flex h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[...t[22]||(t[22]=[e("option",{value:"all"},"Tous les statuts",-1),e("option",{value:"active"},"Actifs",-1),e("option",{value:"inactive"},"Inactifs",-1)])],512),[[O,G.value]])])]),e("div",rt,[X.value?(n(),l("div",ut,[...t[23]||(t[23]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):S.value.length===0?(n(),l("div",at,[d(a(Le),{class:"w-16 h-16 text-muted-foreground mb-4"}),t[24]||(t[24]=e("p",{class:"text-lg font-medium"},"Aucun contact trouvé",-1)),t[25]||(t[25]=e("p",{class:"text-sm text-muted-foreground mt-1"},"Commencez par ajouter ou importer des contacts",-1))])):(n(),l("div",dt,[e("table",ct,[e("thead",ft,[e("tr",null,[e("th",mt,[e("input",{type:"checkbox",checked:oe.value,onChange:Ae,class:"rounded border-gray-300 cursor-pointer"},null,40,vt)]),t[26]||(t[26]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Nom",-1)),t[27]||(t[27]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email",-1)),t[28]||(t[28]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Téléphone",-1)),t[29]||(t[29]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Statut",-1)),t[30]||(t[30]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Date d'ajout",-1)),t[31]||(t[31]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Actions",-1))])]),e("tbody",null,[(n(!0),l(D,null,L(S.value,s=>(n(),l("tr",{key:s.id,class:"border-b transition-colors hover:bg-muted/50"},[e("td",pt,[e("input",{type:"checkbox",checked:$e(s.id),onChange:u=>Ve(s.id),class:"rounded border-gray-300 cursor-pointer"},null,40,gt)]),e("td",bt,i(s.name),1),e("td",xt,i(s.email),1),e("td",ht,i(s.phone),1),e("td",yt,[e("span",{class:Ue(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",s.status==="active"?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},i(s.status==="active"?"Actif":"Inactif"),3)]),e("td",wt,i(ge(s.created_at)),1),e("td",kt,[e("div",_t,[e("button",{onClick:u=>xe(s),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-8 w-8",title:"Modifier"},[d(a(qe),{class:"w-4 h-4"})],8,Ct),e("button",{onClick:u=>ke(s),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-destructive/10 hover:text-destructive h-8 w-8",title:"Supprimer"},[d(a(ee),{class:"w-4 h-4"})],8,jt)])])]))),128))])])]))]),e("div",At,[e("p",Vt," Affichage de 1 à "+i(S.value.length)+" sur "+i(p.value.length)+" contacts ",1),t[32]||(t[32]=e("div",{class:"flex gap-2"},[e("button",{class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3"}," Précédent "),e("button",{class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3"}," Suivant ")],-1))])]),P.value||J.value?(n(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:Z(B,["self"])},[e("div",$t,[e("div",St,[e("h2",Et,i(C.value?"Modifier le contact":"Nouveau contact"),1),e("button",{onClick:B,class:"hover:bg-accent rounded-full p-1"},[d(a(te),{class:"w-5 h-5"})])]),e("form",{onSubmit:Z(we,["prevent"]),class:"space-y-4"},[e("div",Mt,[t[33]||(t[33]=e("label",{class:"text-sm font-medium"},"Nom complet *",-1)),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>c.value.name=s),type:"text",required:"",placeholder:"Jean Dupont",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[M,c.value.name]])]),e("div",zt,[t[34]||(t[34]=e("label",{class:"text-sm font-medium"},"Email *",-1)),v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>c.value.email=s),type:"email",required:"",placeholder:"jean.dupont@example.com",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[M,c.value.email]])]),e("div",It,[t[35]||(t[35]=e("label",{class:"text-sm font-medium"},"Téléphone *",-1)),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>c.value.phone=s),type:"tel",required:"",placeholder:"+237600000000",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[M,c.value.phone]])]),e("div",Ft,[t[37]||(t[37]=e("label",{class:"text-sm font-medium"},"Statut",-1)),v(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>c.value.status=s),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[36]||(t[36]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[O,c.value.status]])]),e("div",Nt,[e("div",Ut,[t[38]||(t[38]=e("label",{class:"text-sm font-medium"},"Champs personnalisés",-1)),d(a(Be),{class:"w-4 h-4 text-muted-foreground"})]),Object.keys(c.value.custom_fields).length>0?(n(),l("div",Dt,[(n(!0),l(D,null,L(c.value.custom_fields,(s,u)=>(n(),l("div",{key:u,class:"flex items-center gap-2 p-2 bg-muted/50 rounded border"},[e("div",Lt,[e("p",Tt,i(u),1),e("p",Gt,i(s),1)]),e("button",{type:"button",onClick:E=>ye(u),class:"text-destructive hover:bg-destructive/10 rounded p-1"},[d(a(ee),{class:"w-4 h-4"})],8,qt)]))),128))])):m("",!0),e("div",Bt,[t[40]||(t[40]=e("p",{class:"text-xs text-muted-foreground"},"Ajouter un nouveau champ",-1)),e("div",Ht,[v(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>j.value=s),type:"text",placeholder:"Nom du champ",class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[M,j.value]]),v(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>A.value=s),type:"text",placeholder:"Valeur",class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[M,A.value]])]),e("button",{type:"button",onClick:he,class:"w-full inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9"},[d(a(le),{class:"w-4 h-4"}),t[39]||(t[39]=e("span",null,"Ajouter",-1))])])]),e("div",Rt,[e("button",{type:"button",onClick:B,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"submit",disabled:I.value,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[I.value?(n(),l("div",Zt)):m("",!0),e("span",null,i(I.value?"Enregistrement...":C.value?"Modifier":"Ajouter"),1)],8,Ot)])],32)])])):m("",!0),Q.value?(n(),l("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:Z(H,["self"])},[e("div",Kt,[e("div",Pt,[t[41]||(t[41]=e("div",null,[e("h2",{class:"text-xl font-bold"},"Importer des contacts"),e("p",{class:"text-sm text-muted-foreground mt-1"},"Importez vos contacts depuis un fichier CSV")],-1)),e("button",{onClick:H,class:"hover:bg-accent rounded-full p-1"},[d(a(te),{class:"w-5 h-5"})])]),h.value===1?(n(),l("div",Jt,[e("div",Qt,[d(a(Re),{class:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),t[42]||(t[42]=e("div",{class:"space-y-2"},[e("p",{class:"text-sm font-medium"},"Glissez-déposez votre fichier CSV ici"),e("p",{class:"text-xs text-muted-foreground"},"ou cliquez pour sélectionner un fichier")],-1)),e("input",{type:"file",accept:".csv",onChange:_e,class:"hidden",ref_key:"fileInput",ref:ae},null,544),e("button",{onClick:t[9]||(t[9]=s=>o.$refs.fileInput.click()),class:"mt-4 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Sélectionner un fichier ")]),g.value?(n(),l("div",Wt,[e("div",Xt,[e("div",Yt,[d(a(Te),{class:"w-8 h-8 text-primary"}),e("div",null,[e("p",es,i(g.value.name),1),e("p",ts,i((g.value.size/1024).toFixed(2))+" KB",1)])]),e("button",{onClick:t[10]||(t[10]=s=>g.value=null),class:"text-destructive hover:bg-destructive/10 rounded p-2"},[d(a(ee),{class:"w-4 h-4"})])])])):m("",!0),e("div",ss,[e("div",os,[d(a(Oe),{class:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),t[43]||(t[43]=e("div",{class:"text-sm"},[e("p",{class:"font-medium mb-2"},"Format du fichier CSV :"),e("ul",{class:"space-y-1 text-muted-foreground"},[e("li",null,"• La première ligne doit contenir les en-têtes de colonnes"),e("li",null,"• Les champs doivent être séparés par des virgules (,)"),e("li",null,"• Format recommandé : nom, email, téléphone"),e("li",null,"• Encodage UTF-8 recommandé")])],-1))])]),e("div",ns,[e("button",{onClick:H,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{onClick:Ce,disabled:!g.value||$.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[$.value?(n(),l("div",ls)):m("",!0),e("span",null,i($.value?"Analyse...":"Continuer"),1)],8,is)])])):m("",!0),h.value===2?(n(),l("div",rs,[e("div",us,[t[44]||(t[44]=e("p",{class:"text-sm font-medium mb-2"},"Mappage des colonnes",-1)),e("p",as," Associez les colonnes de votre fichier CSV aux champs du système. "+i(V.value.length)+" lignes détectées. ",1)]),e("div",ds,[(n(!0),l(D,null,L(N.value,(s,u)=>{var E;return n(),l("div",{key:u,class:"grid grid-cols-2 gap-4 items-center"},[e("div",cs,[t[45]||(t[45]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Colonne CSV",-1)),e("p",fs,i(s),1),e("p",ms,"Exemple: "+i(((E=V.value[0])==null?void 0:E[u])||"-"),1)]),e("div",vs,[t[47]||(t[47]=e("label",{class:"text-xs text-muted-foreground"},"Associer à",-1)),v(e("select",{"onUpdate:modelValue":ze=>y.value[s]=ze,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[46]||(t[46]=[e("option",{value:""},"-- Ne pas importer --",-1),e("option",{value:"name"},"Nom",-1),e("option",{value:"email"},"Email",-1),e("option",{value:"phone"},"Téléphone",-1)])],8,ps),[[O,y.value[s]]])])])}),128))]),e("div",gs,[e("div",bs,[d(a(He),{class:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),t[48]||(t[48]=e("div",{class:"text-sm"},[e("p",{class:"font-medium mb-1"},"Champs obligatoires"),e("p",{class:"text-muted-foreground"},"Les champs Nom, Email et Téléphone sont obligatoires pour chaque contact.")],-1))])]),e("div",xs,[e("button",{onClick:t[11]||(t[11]=s=>h.value=1),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Retour "),e("button",{onClick:t[12]||(t[12]=s=>h.value=3),disabled:!ve.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Continuer ",8,hs)])])):m("",!0),h.value===3?(n(),l("div",ys,[e("div",ws,[t[49]||(t[49]=e("p",{class:"text-sm font-medium mb-2"},"Aperçu des données",-1)),e("p",ks," Vérifiez les données avant l'importation. "+i(w.value.length)+" contacts valides sur "+i(V.value.length)+". ",1)]),e("div",_s,[e("table",Cs,[t[51]||(t[51]=e("thead",{class:"border-b bg-muted/50 sticky top-0"},[e("tr",null,[e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Nom"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Email"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Téléphone"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Statut")])],-1)),e("tbody",null,[(n(!0),l(D,null,L(w.value.slice(0,20),(s,u)=>(n(),l("tr",{key:u,class:"border-b"},[e("td",js,i(s.name),1),e("td",As,i(s.email),1),e("td",Vs,i(s.phone),1),t[50]||(t[50]=e("td",{class:"p-3 text-sm"},[e("span",{class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold bg-success/10 text-success"}," Valide ")],-1))]))),128))])])]),w.value.length>20?(n(),l("div",$s," ... et "+i(w.value.length-20)+" autres contacts ",1)):m("",!0),e("div",Ss,[e("button",{onClick:t[13]||(t[13]=s=>h.value=2),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Retour "),e("button",{onClick:je,disabled:U.value||w.value.length===0,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-success text-success-foreground hover:bg-success/90 h-10 px-4 py-2"},[U.value?(n(),l("div",Ms)):(n(),ne(a(ue),{key:1,class:"w-4 h-4"})),e("span",null,i(U.value?"Importation...":`Importer ${w.value.length} contacts`),1)],8,Es)])])):m("",!0)])])):m("",!0),W.value?(n(),l("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:Z(R,["self"])},[e("div",zs,[e("div",Is,[e("div",Fs,[t[52]||(t[52]=e("h2",{class:"text-xl font-bold"},"Ajouter à un groupe",-1)),e("button",{onClick:R,class:"hover:bg-accent rounded-full p-1"},[d(a(te),{class:"w-5 h-5"})])]),e("p",Ns,i(f.value.length)+" contact(s) sélectionné(s) ",1)]),e("div",Us,[q.value.length===0?(n(),l("div",Ds,[d(a(re),{class:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),t[53]||(t[53]=e("p",{class:"text-sm text-muted-foreground"},"Aucun groupe disponible",-1)),t[54]||(t[54]=e("p",{class:"text-xs text-muted-foreground mt-1"},"Créez un groupe depuis la page Groupes",-1))])):(n(),l("div",Ls,[t[56]||(t[56]=e("label",{class:"text-sm font-medium"},"Sélectionner un groupe *",-1)),v(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>_.value=s),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[t[55]||(t[55]=e("option",{value:null},"-- Choisir un groupe --",-1)),(n(!0),l(D,null,L(q.value,s=>(n(),l("option",{key:s.id,value:s.id},i(s.name)+" ("+i(s.contacts_count)+" contacts) ",9,Ts))),128))],512),[[O,_.value]])])),e("div",Gs,[e("button",{type:"button",onClick:R,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"button",onClick:Me,disabled:!_.value||F.value||q.value.length===0,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[F.value?(n(),l("div",Bs)):m("",!0),e("span",null,i(F.value?"Ajout...":"Ajouter"),1)],8,qs)])])])])):m("",!0)]),_:1}))}});export{Ys as default};
