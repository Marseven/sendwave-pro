import{o as d,c as m,b as e,d as D,u as q,r as c,k as T,l as H,m as C,n as R,p as n,q as r,t as a,i as w,f as l,v as b,B as k,g as M}from"./main-otUjUrWA.js";import{_ as Z,e as j,f as I,b as U,r as L,c as z,a as F,g as G}from"./api-DYRyZdVO.js";import{c as J}from"./campaignService-DgeKtCs9.js";import{c as K}from"./contactService-CHhK5OJ8.js";import{r as O}from"./CheckBadgeIcon-Cm20FJn7.js";import{r as Q}from"./IdentificationIcon-CvLq1HVC.js";import{r as W}from"./UserIcon-DM4CAUqR.js";import{r as S}from"./EnvelopeIcon-Bc32rQIV.js";import{r as X}from"./PhoneIcon-BDtVlXYy.js";import{r as Y}from"./KeyIcon-BAf7I7Md.js";import{r as ee}from"./BellAlertIcon-DC0VdBou.js";import{r as N}from"./CheckCircleIcon-DNUV8qZz.js";import{r as se,a as te}from"./XCircleIcon-BBgHEpUO.js";function oe(V,u){return d(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"})])}function re(V,u){return d(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})])}const ne={class:"p-8"},ie={class:"mb-8"},ae={class:"flex items-center gap-2"},le={key:0,class:"flex items-center justify-center py-12"},de={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ue={class:"space-y-6"},ce={class:"rounded-lg border bg-card p-6"},me={class:"flex flex-col items-center text-center"},pe={class:"relative mb-4"},fe={class:"w-24 h-24 rounded-full bg-primary flex items-center justify-center text-primary-foreground text-3xl font-bold"},ge={class:"absolute bottom-0 right-0 w-8 h-8 rounded-full bg-accent border-2 border-background flex items-center justify-center hover:bg-accent/80 transition-colors"},ve={class:"text-xl font-bold"},be={class:"text-sm text-muted-foreground"},xe={class:"mt-4 flex items-center gap-2"},_e={class:"px-3 py-1 rounded-full bg-success/10 text-success text-xs font-medium flex items-center gap-1"},he={class:"rounded-lg border bg-card p-6"},we={class:"font-semibold mb-4 flex items-center gap-2"},ye={class:"space-y-3"},ke={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50"},Ve={class:"flex items-center gap-2"},$e={class:"font-bold"},Ce={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50"},Me={class:"flex items-center gap-2"},je={class:"font-bold"},Ue={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50"},Se={class:"flex items-center gap-2"},Ne={class:"font-bold"},Ee={class:"lg:col-span-2 space-y-6"},Ae={class:"rounded-lg border bg-card p-6"},Be={class:"flex items-center gap-2 mb-4"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},De={class:"space-y-2"},qe={class:"text-sm font-medium flex items-center gap-2"},Te={class:"space-y-2"},He={class:"text-sm font-medium flex items-center gap-2"},Re={class:"space-y-2"},Ze={class:"text-sm font-medium flex items-center gap-2"},Ie={class:"space-y-2"},Le={class:"text-sm font-medium flex items-center gap-2"},ze={class:"rounded-lg border bg-card p-6"},Fe={class:"flex items-center gap-2 mb-4"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Je={class:"space-y-2"},Ke={class:"space-y-2"},Oe={class:"rounded-lg border bg-card p-6"},Qe={class:"flex items-center gap-2 mb-4"},We={class:"space-y-3"},Xe={class:"flex items-start gap-3 cursor-pointer p-3 rounded-lg hover:bg-muted/50 transition-colors"},Ye={class:"flex-1"},es={class:"flex items-center gap-2"},ss={class:"flex items-start gap-3 cursor-pointer p-3 rounded-lg hover:bg-muted/50 transition-colors"},ts={class:"flex-1"},os={class:"flex items-center gap-2"},rs={class:"flex items-start gap-3 cursor-pointer p-3 rounded-lg hover:bg-muted/50 transition-colors"},ns={class:"flex-1"},is={class:"flex items-center gap-2"},as={key:0,class:"rounded-lg bg-success/10 border border-success/20 p-4"},ls={class:"flex items-center gap-2 text-success"},ds={class:"font-medium"},us={key:1,class:"rounded-lg bg-destructive/10 border border-destructive/20 p-4"},cs={class:"flex items-center gap-2 text-destructive"},ms={class:"font-medium"},ps={class:"flex gap-3"},fs=["disabled"],gs={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},vs=["disabled"],Ss=D({__name:"Profile",setup(V){const u=q(),y=c(!0),p=c(!1),f=c(""),g=c(""),t=c({name:"",email:"",phone:"",company:"",password:"",password_confirmation:"",email_notifications:!0,weekly_reports:!0,campaign_alerts:!0}),x=c({name:"",email:"",phone:"",company:"",password:"",password_confirmation:"",email_notifications:!0,weekly_reports:!0,campaign_alerts:!0}),v=c({campaigns:0,messagesSent:0,contacts:0}),E=T(()=>t.value.name?t.value.name.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2):"?");async function A(){y.value=!0;try{const i=await j.get("/user/profile"),s=i.data.data||i.data;t.value={name:s.name||"",email:s.email||"",phone:s.phone||"",company:s.company||"",password:"",password_confirmation:"",email_notifications:s.email_notifications??!0,weekly_reports:s.weekly_reports??!0,campaign_alerts:s.campaign_alerts??!0},x.value={...t.value};const[o,_]=await Promise.all([J.getAll(),K.getAll()]);v.value.campaigns=o.length,v.value.contacts=_.length,v.value.messagesSent=o.reduce((h,$)=>h+($.messages_sent||$.sent||0),0)}catch(i){console.error("Error loading profile:",i),u.user&&(t.value.name=u.user.name||"",t.value.email=u.user.email||"",x.value={...t.value})}finally{y.value=!1}}async function B(){var i,s;p.value=!0,f.value="",g.value="";try{if(t.value.password&&t.value.password!==t.value.password_confirmation){g.value="Les mots de passe ne correspondent pas";return}const o={name:t.value.name,email:t.value.email,phone:t.value.phone,company:t.value.company,email_notifications:t.value.email_notifications,weekly_reports:t.value.weekly_reports,campaign_alerts:t.value.campaign_alerts};t.value.password&&(o.password=t.value.password,o.password_confirmation=t.value.password_confirmation);const _=await j.put("/user/profile",o),h=_.data.data||_.data;u.user&&(u.user.name=h.name,u.user.email=h.email),t.value.password="",t.value.password_confirmation="",x.value={...t.value},f.value="Profil mis à jour avec succès",setTimeout(()=>{f.value=""},3e3)}catch(o){console.error("Error saving profile:",o),g.value=((s=(i=o.response)==null?void 0:i.data)==null?void 0:s.message)||"Erreur lors de la mise à jour du profil"}finally{p.value=!1}}function P(){t.value={...x.value},f.value="",g.value=""}return H(()=>{A()}),(i,s)=>(d(),C(Z,null,{default:R(()=>[e("div",ne,[e("div",ie,[e("div",ae,[n(r(I),{class:"w-8 h-8 text-primary"}),s[9]||(s[9]=e("h1",{class:"text-3xl font-bold"},"Mon Profil",-1))]),s[10]||(s[10]=e("p",{class:"text-muted-foreground mt-2"},"Gérez vos informations personnelles et préférences",-1))]),y.value?(d(),m("div",le,[...s[11]||(s[11]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(d(),m("div",de,[e("div",ue,[e("div",ce,[e("div",me,[e("div",pe,[e("div",fe,a(E.value),1),e("button",ge,[n(r(re),{class:"w-4 h-4"})])]),e("h2",ve,a(t.value.name),1),e("p",be,a(t.value.email),1),e("div",xe,[e("span",_e,[n(r(O),{class:"w-4 h-4"}),s[12]||(s[12]=e("span",null,"Compte actif",-1))])])])]),e("div",he,[e("h3",we,[n(r(U),{class:"w-5 h-5 text-primary"}),s[13]||(s[13]=e("span",null,"Statistiques",-1))]),e("div",ye,[e("div",ke,[e("div",Ve,[n(r(L),{class:"w-4 h-4 text-muted-foreground"}),s[14]||(s[14]=e("span",{class:"text-sm"},"Campagnes créées",-1))]),e("span",$e,a(v.value.campaigns),1)]),e("div",Ce,[e("div",Me,[n(r(z),{class:"w-4 h-4 text-muted-foreground"}),s[15]||(s[15]=e("span",{class:"text-sm"},"Messages envoyés",-1))]),e("span",je,a(v.value.messagesSent),1)]),e("div",Ue,[e("div",Se,[n(r(F),{class:"w-4 h-4 text-muted-foreground"}),s[16]||(s[16]=e("span",{class:"text-sm"},"Contacts",-1))]),e("span",Ne,a(v.value.contacts),1)])])])]),e("div",Ee,[e("div",Ae,[e("div",Be,[n(r(Q),{class:"w-5 h-5 text-primary"}),s[17]||(s[17]=e("h3",{class:"font-semibold"},"Informations personnelles",-1))]),e("div",Pe,[e("div",De,[e("label",qe,[n(r(W),{class:"w-4 h-4 text-muted-foreground"}),s[18]||(s[18]=w(" Nom complet ",-1))]),l(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.name=o),type:"text",placeholder:"Votre nom complet",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[b,t.value.name]])]),e("div",Te,[e("label",He,[n(r(S),{class:"w-4 h-4 text-muted-foreground"}),s[19]||(s[19]=w(" Email ",-1))]),l(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.email=o),type:"email",placeholder:"votre@email.com",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[b,t.value.email]])]),e("div",Re,[e("label",Ze,[n(r(X),{class:"w-4 h-4 text-muted-foreground"}),s[20]||(s[20]=w(" Téléphone ",-1))]),l(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.phone=o),type:"tel",placeholder:"+33612345678",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[b,t.value.phone]])]),e("div",Ie,[e("label",Le,[n(r(oe),{class:"w-4 h-4 text-muted-foreground"}),s[21]||(s[21]=w(" Entreprise ",-1))]),l(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.company=o),type:"text",placeholder:"Nom de l'entreprise",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[b,t.value.company]])])])]),e("div",ze,[e("div",Fe,[n(r(Y),{class:"w-5 h-5 text-primary"}),s[22]||(s[22]=e("h3",{class:"font-semibold"},"Sécurité",-1))]),e("div",Ge,[e("div",Je,[s[23]||(s[23]=e("label",{class:"text-sm font-medium"},"Nouveau mot de passe",-1)),l(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.value.password=o),type:"password",placeholder:"••••••••",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[b,t.value.password]])]),e("div",Ke,[s[24]||(s[24]=e("label",{class:"text-sm font-medium"},"Confirmer le mot de passe",-1)),l(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.value.password_confirmation=o),type:"password",placeholder:"••••••••",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[b,t.value.password_confirmation]])])]),s[25]||(s[25]=e("p",{class:"text-xs text-muted-foreground mt-2"},"Laisser vide pour ne pas modifier le mot de passe",-1))]),e("div",Oe,[e("div",Qe,[n(r(G),{class:"w-5 h-5 text-primary"}),s[26]||(s[26]=e("h3",{class:"font-semibold"},"Préférences de notifications",-1))]),e("div",We,[e("label",Xe,[l(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>t.value.email_notifications=o),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[k,t.value.email_notifications]]),e("div",Ye,[e("div",es,[n(r(S),{class:"w-4 h-4 text-muted-foreground"}),s[27]||(s[27]=e("div",{class:"font-medium text-sm"},"Notifications par email",-1))]),s[28]||(s[28]=e("div",{class:"text-xs text-muted-foreground mt-1"},"Recevoir les alertes importantes par email",-1))])]),e("label",ss,[l(e("input",{"onUpdate:modelValue":s[7]||(s[7]=o=>t.value.weekly_reports=o),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[k,t.value.weekly_reports]]),e("div",ts,[e("div",os,[n(r(U),{class:"w-4 h-4 text-muted-foreground"}),s[29]||(s[29]=e("div",{class:"font-medium text-sm"},"Rapports hebdomadaires",-1))]),s[30]||(s[30]=e("div",{class:"text-xs text-muted-foreground mt-1"},"Recevoir les statistiques chaque lundi matin",-1))])]),e("label",rs,[l(e("input",{"onUpdate:modelValue":s[8]||(s[8]=o=>t.value.campaign_alerts=o),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[k,t.value.campaign_alerts]]),e("div",ns,[e("div",is,[n(r(ee),{class:"w-4 h-4 text-muted-foreground"}),s[31]||(s[31]=e("div",{class:"font-medium text-sm"},"Alertes campagnes",-1))]),s[32]||(s[32]=e("div",{class:"text-xs text-muted-foreground mt-1"},"Notifications lors de l'envoi ou de la fin d'une campagne",-1))])])])]),f.value?(d(),m("div",as,[e("div",ls,[n(r(N),{class:"w-5 h-5"}),e("p",ds,a(f.value),1)])])):M("",!0),g.value?(d(),m("div",us,[e("div",cs,[n(r(se),{class:"w-5 h-5"}),e("p",ms,a(g.value),1)])])):M("",!0),e("div",ps,[e("button",{onClick:B,disabled:p.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6 py-2"},[p.value?(d(),m("div",gs)):(d(),C(r(N),{key:0,class:"w-4 h-4"})),e("span",null,a(p.value?"Enregistrement...":"Enregistrer les modifications"),1)],8,fs),e("button",{onClick:P,disabled:p.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[n(r(te),{class:"w-4 h-4"}),s[33]||(s[33]=e("span",null,"Annuler",-1))],8,vs)])])]))])]),_:1}))}});export{Ss as default};
