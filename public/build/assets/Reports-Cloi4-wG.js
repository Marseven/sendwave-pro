import{o as i,c,b as e,d as ae,r as x,m as de,n as b,p as ce,x as d,y as l,f as Y,v as Z,t as o,s as S,z as C,F as ee,q as te}from"./main-Is5TlHEk.js";import{_ as ue,a as h,r as ve,n as me}from"./api-DOf-pn4k.js";import{a as _}from"./analyticsService-JIXza-Nz.js";import{b as $,a as ge}from"./notifications-CHQAjgV4.js";import{r as F}from"./ArrowDownTrayIcon-C_dTY_6u.js";import{r as pe}from"./CheckCircleIcon-BG4_XIyi.js";import{r as fe}from"./RocketLaunchIcon-BqfHVhSY.js";import{r as xe}from"./CheckBadgeIcon-BHXz_Us2.js";function se(w,p){return i(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"})])}function oe(w,p){return i(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"})])}function be(w,p){return i(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"})])}const _e={class:"p-8"},he={class:"mb-8 flex items-center justify-between"},we={class:"flex items-center gap-2"},ye={class:"flex gap-3"},ke=["disabled"],Se=["disabled"],Ce=["disabled"],$e={key:0,class:"flex items-center justify-center py-12"},Fe={key:1},Me={class:"rounded-lg border bg-card p-4 mb-6"},De={class:"flex items-center gap-4"},je={class:"flex-1"},Ae={class:"flex-1"},Ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Le={class:"rounded-lg border bg-card p-6"},Ve={class:"flex items-center gap-2 mb-4"},Be={class:"text-3xl font-bold text-primary mb-2"},Te={class:"flex items-center gap-2"},ze={class:"rounded-lg border bg-card p-6"},Re={class:"flex items-center gap-2 mb-4"},qe={class:"text-3xl font-bold text-success mb-2"},Ne={class:"text-xs text-muted-foreground"},Ue={class:"rounded-lg border bg-card p-6"},He={class:"flex items-center gap-2 mb-4"},Ie={class:"text-3xl font-bold mb-2"},Oe={class:"flex items-center gap-2"},Pe={class:"rounded-lg border bg-card p-6"},Ke={class:"flex items-center gap-2 mb-4"},Ge={class:"text-3xl font-bold mb-2"},Je={class:"text-xs text-muted-foreground"},Qe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},We={class:"rounded-lg border bg-card p-6"},Xe={class:"flex items-center gap-2 mb-6"},Ye={class:"space-y-4"},Ze={class:"flex items-center justify-between mb-2"},et={class:"text-sm font-semibold"},tt={class:"w-full bg-gray-200 rounded-full h-3"},st={class:"text-xs text-muted-foreground mt-1"},ot={class:"flex items-center justify-between mb-2"},rt={class:"text-sm font-semibold"},nt={class:"w-full bg-gray-200 rounded-full h-3"},it={class:"text-xs text-muted-foreground mt-1"},lt={class:"rounded-lg border bg-card p-6"},at={class:"flex items-center gap-2 mb-6"},dt={key:0,class:"text-center py-8"},ct={key:1,class:"space-y-3"},ut={class:"flex-1"},vt={class:"font-medium text-sm"},mt={class:"text-xs text-muted-foreground"},gt={class:"rounded-lg border bg-card p-6 mb-8"},pt={class:"flex items-center gap-2 mb-6"},ft={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},xt={class:"text-2xl font-bold"},bt={class:"text-2xl font-bold"},_t={class:"text-2xl font-bold"},ht={class:"rounded-lg border bg-card p-6"},wt={class:"flex items-center gap-2 mb-6"},yt={key:0,class:"text-center py-12"},kt={key:1,class:"grid grid-cols-12 gap-2"},St=["title"],Ct={class:"text-xs text-muted-foreground mt-1"},Vt=ae({__name:"Reports",setup(w){const p=x(!0),f=x(!1),s=x(null),v=x(""),m=x("");function re(){const r=new Date,t=new Date;t.setDate(t.getDate()-30),m.value=r.toISOString().split("T")[0],v.value=t.toISOString().split("T")[0]}async function y(){var r,t;try{p.value=!0;const a=await _.getDashboard("month");s.value=a.data}catch(a){console.error("Error loading dashboard:",a),$(((t=(r=a.response)==null?void 0:r.data)==null?void 0:t.message)||"Erreur lors du chargement des statistiques")}finally{p.value=!1}}async function k(r){var t,a;if(!v.value||!m.value){$("Veuillez sélectionner une période");return}try{f.value=!0;let u,g;switch(r){case"pdf":u=await _.exportPdf(v.value,m.value),g=`rapport_${v.value}_${m.value}.pdf`;break;case"excel":u=await _.exportExcel(v.value,m.value),g=`rapport_${v.value}_${m.value}.xlsx`;break;case"csv":u=await _.exportCsv(v.value,m.value),g=`rapport_${v.value}_${m.value}.csv`;break}_.downloadFile(u,g),ge(`Rapport ${r.toUpperCase()} téléchargé avec succès`)}catch(u){console.error("Error exporting report:",u),$(((a=(t=u.response)==null?void 0:t.data)==null?void 0:a.message)||"Erreur lors de l'export")}finally{f.value=!1}}function ne(r){return r>=1e6?`${(r/1e6).toFixed(1)}M`:r>=1e3?`${(r/1e3).toFixed(1)}K`:r.toString()}function ie(r){const t=(r||"").toLowerCase();return["completed","terminé","termine"].includes(t)?"bg-success/10 text-success":["actif","active","sending"].includes(t)?"bg-blue-100 text-blue-700":["planifié","planifie","scheduled","pending","draft"].includes(t)?"bg-warning/10 text-warning":["failed","error","échoué"].includes(t)?"bg-destructive/10 text-destructive":"bg-muted text-muted-foreground"}function le(r){var a;if(!((a=s.value)!=null&&a.hourly_distribution.length))return 0;const t=Math.max(...s.value.hourly_distribution.map(u=>u.count));return t===0?0:Math.max(20,r/t*100)}return de(()=>{re(),y()}),(r,t)=>(i(),b(ue,null,{default:ce(()=>{var a,u,g,M,D,j,A,E,L,V,B,T,z,R,q,N,U,H,I,O,P,K,G,J,Q,W,X;return[e("div",_e,[e("div",he,[e("div",null,[e("div",we,[d(l(h),{class:"w-8 h-8 text-primary"}),t[5]||(t[5]=e("h1",{class:"text-3xl font-bold"},"Rapports & Statistiques",-1))]),t[6]||(t[6]=e("p",{class:"text-muted-foreground mt-2"},"Analysez les performances de vos campagnes",-1))]),e("div",ye,[e("button",{onClick:t[0]||(t[0]=n=>k("pdf")),disabled:f.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(l(F),{class:"w-4 h-4"}),t[7]||(t[7]=e("span",null,"Exporter PDF",-1))],8,ke),e("button",{onClick:t[1]||(t[1]=n=>k("excel")),disabled:f.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(l(F),{class:"w-4 h-4"}),t[8]||(t[8]=e("span",null,"Exporter Excel",-1))],8,Se),e("button",{onClick:t[2]||(t[2]=n=>k("csv")),disabled:f.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(l(F),{class:"w-4 h-4"}),t[9]||(t[9]=e("span",null,"Exporter CSV",-1))],8,Ce)])]),p.value?(i(),c("div",$e,[...t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(i(),c("div",Fe,[e("div",Me,[e("div",De,[e("div",je,[t[11]||(t[11]=e("label",{class:"text-sm font-medium mb-1 block"},"Date de début",-1)),Y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>v.value=n),type:"date",onChange:y,class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,544),[[Z,v.value]])]),e("div",Ae,[t[12]||(t[12]=e("label",{class:"text-sm font-medium mb-1 block"},"Date de fin",-1)),Y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>m.value=n),type:"date",onChange:y,class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,544),[[Z,m.value]])])])]),e("div",Ee,[e("div",Le,[e("div",Ve,[d(l(ve),{class:"w-5 h-5 text-primary"}),t[13]||(t[13]=e("h3",{class:"font-semibold text-sm"},"SMS Envoyés",-1))]),e("div",Be,o(ne(((a=s.value)==null?void 0:a.overview.sms_sent)||0)),1),e("div",Te,[((u=s.value)==null?void 0:u.trends.sms_sent_change)>0?(i(),b(l(oe),{key:0,class:"w-4 h-4 text-success"})):(i(),b(l(se),{key:1,class:"w-4 h-4 text-destructive"})),e("p",{class:S(["text-xs",((g=s.value)==null?void 0:g.trends.sms_sent_change)>0?"text-success":"text-destructive"])},o(((M=s.value)==null?void 0:M.trends.sms_sent_change)>0?"+":"")+o((D=s.value)==null?void 0:D.trends.sms_sent_change.toFixed(1))+"% ",3)])]),e("div",ze,[e("div",Re,[d(l(pe),{class:"w-5 h-5 text-success"}),t[14]||(t[14]=e("h3",{class:"font-semibold text-sm"},"Taux de livraison",-1))]),e("div",qe,o((j=s.value)==null?void 0:j.overview.success_rate.toFixed(1))+"%",1),e("p",Ne,o((A=s.value)==null?void 0:A.overview.sms_delivered.toLocaleString())+" livrés",1)]),e("div",Ue,[e("div",He,[d(l(fe),{class:"w-5 h-5 text-primary"}),t[15]||(t[15]=e("h3",{class:"font-semibold text-sm"},"Campagnes",-1))]),e("div",Ie,o(((E=s.value)==null?void 0:E.overview.campaigns_executed)||0),1),e("div",Oe,[((L=s.value)==null?void 0:L.trends.campaigns_change)>0?(i(),b(l(oe),{key:0,class:"w-4 h-4 text-success"})):(i(),b(l(se),{key:1,class:"w-4 h-4 text-destructive"})),e("p",{class:S(["text-xs",((V=s.value)==null?void 0:V.trends.campaigns_change)>0?"text-success":"text-destructive"])},o(((B=s.value)==null?void 0:B.trends.campaigns_change)>0?"+":"")+o((T=s.value)==null?void 0:T.trends.campaigns_change.toFixed(1))+"% ",3)])]),e("div",Pe,[e("div",Ke,[d(l(xe),{class:"w-5 h-5 text-warning"}),t[16]||(t[16]=e("h3",{class:"font-semibold text-sm"},"Coût Total",-1))]),e("div",Ge,o((z=s.value)==null?void 0:z.overview.total_cost.toLocaleString())+" FCFA",1),e("p",Je,o((R=s.value)==null?void 0:R.overview.average_cost_per_sms.toFixed(2))+" FCFA/SMS",1)])]),e("div",Qe,[e("div",We,[e("div",Xe,[d(l(h),{class:"w-5 h-5 text-primary"}),t[17]||(t[17]=e("h3",{class:"font-semibold"},"Distribution par opérateur",-1))]),e("div",Ye,[e("div",null,[e("div",Ze,[t[18]||(t[18]=e("span",{class:"text-sm font-medium"},"Airtel",-1)),e("span",et,o((q=s.value)==null?void 0:q.providers.airtel.percentage.toFixed(1))+"%",1)]),e("div",tt,[e("div",{class:"bg-red-500 h-3 rounded-full transition-all",style:C({width:((N=s.value)==null?void 0:N.providers.airtel.percentage)+"%"})},null,4)]),e("p",st,o((U=s.value)==null?void 0:U.providers.airtel.count.toLocaleString())+" SMS",1)]),e("div",null,[e("div",ot,[t[19]||(t[19]=e("span",{class:"text-sm font-medium"},"Moov",-1)),e("span",rt,o((H=s.value)==null?void 0:H.providers.moov.percentage.toFixed(1))+"%",1)]),e("div",nt,[e("div",{class:"bg-blue-500 h-3 rounded-full transition-all",style:C({width:((I=s.value)==null?void 0:I.providers.moov.percentage)+"%"})},null,4)]),e("p",it,o((O=s.value)==null?void 0:O.providers.moov.count.toLocaleString())+" SMS",1)])])]),e("div",lt,[e("div",at,[d(l(be),{class:"w-5 h-5 text-primary"}),t[20]||(t[20]=e("h3",{class:"font-semibold"},"Top Campagnes",-1))]),((P=s.value)==null?void 0:P.campaigns.length)===0?(i(),c("div",dt,[d(l(h),{class:"w-12 h-12 text-muted-foreground mx-auto mb-2"}),t[21]||(t[21]=e("p",{class:"text-sm text-muted-foreground"},"Aucune campagne",-1))])):(i(),c("div",ct,[(i(!0),c(ee,null,te((K=s.value)==null?void 0:K.campaigns.slice(0,5),n=>(i(),c("div",{key:n.id,class:"flex items-center justify-between p-3 bg-muted/50 rounded-lg"},[e("div",ut,[e("div",vt,o(n.name),1),e("div",mt,o(n.messages_sent.toLocaleString())+" envois",1)]),e("span",{class:S(["text-xs px-2 py-1 rounded-full",ie(n.status)])},o(n.status),3)]))),128))]))])]),e("div",gt,[e("div",pt,[d(l(h),{class:"w-5 h-5 text-primary"}),t[22]||(t[22]=e("h3",{class:"font-semibold"},"Analyse des coûts",-1))]),e("div",ft,[e("div",null,[t[23]||(t[23]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Coût Airtel",-1)),e("div",xt,o((G=s.value)==null?void 0:G.cost_analysis.airtel_cost.toLocaleString())+" FCFA",1)]),e("div",null,[t[24]||(t[24]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Coût Moov",-1)),e("div",bt,o((J=s.value)==null?void 0:J.cost_analysis.moov_cost.toLocaleString())+" FCFA",1)]),e("div",null,[t[25]||(t[25]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Moyenne journalière",-1)),e("div",_t,o((Q=s.value)==null?void 0:Q.cost_analysis.average_daily_cost.toLocaleString())+" FCFA",1)])])]),e("div",ht,[e("div",wt,[d(l(me),{class:"w-5 h-5 text-primary"}),t[26]||(t[26]=e("h3",{class:"font-semibold"},"Distribution horaire des envois",-1))]),((W=s.value)==null?void 0:W.hourly_distribution.length)===0?(i(),c("div",yt,[...t[27]||(t[27]=[e("p",{class:"text-muted-foreground"},"Aucune donnée disponible",-1)])])):(i(),c("div",kt,[(i(!0),c(ee,null,te((X=s.value)==null?void 0:X.hourly_distribution,n=>(i(),c("div",{key:n.hour,class:"flex flex-col items-center"},[e("div",{class:"w-full bg-primary/20 rounded-t",style:C({height:le(n.count)+"px"})},[e("div",{class:"w-full bg-primary rounded-t transition-all",style:{height:"100%"},title:`${n.count} SMS à ${n.hour}h`},null,8,St)],4),e("div",Ct,o(n.hour)+"h",1)]))),128))]))])]))])]}),_:1}))}});export{Vt as default};
