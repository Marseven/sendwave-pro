import{o as i,c as l,b as e,d as $e,r,k as g,l as Se,m as te,n as Ee,p as d,q as u,t as n,g as m,f as y,v as G,A as B,F as q,x as H,s as Me,w as R}from"./main-CcTjvTZ9.js";import{_ as ze,e as se,h as Ie,a as De,i as Ne}from"./api-B6W7dzY-.js";import{c as D}from"./contactService-D-OTLWGZ.js";import{a as $,b as w,s as Fe}from"./notifications-CHQAjgV4.js";import{r as oe}from"./UserGroupIcon-Bvlfm9KL.js";import{r as Le}from"./PencilIcon-Cg5qivSf.js";import{r as ne}from"./TrashIcon-BnSx88rg.js";import{r as X}from"./XMarkIcon-D-0r4Qzz.js";import{r as Te}from"./ExclamationTriangleIcon-CsG0IckF.js";function ie(Z,k){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function Ue(Z,k){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function Ge(Z,k){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}const Be={class:"p-8"},qe={class:"mb-8 flex items-center justify-between"},He={class:"flex gap-3"},Re={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Ze={class:"rounded-lg border bg-card p-4"},Oe={class:"text-2xl font-bold mt-1"},Pe={class:"rounded-lg border bg-card p-4"},Je={class:"text-2xl font-bold mt-1 text-success"},Ke={class:"rounded-lg border bg-card p-4"},Qe={class:"text-2xl font-bold mt-1 text-muted-foreground"},We={class:"rounded-lg border bg-card p-4"},Xe={class:"text-2xl font-bold mt-1 text-primary"},Ye={class:"rounded-lg border bg-card shadow-sm mb-6 p-6"},et={class:"flex gap-4"},tt={class:"flex-1"},st={class:"rounded-lg border bg-card shadow-sm"},ot={key:0,class:"flex items-center justify-center py-12"},nt={key:1,class:"flex flex-col items-center justify-center py-12"},it={key:2,class:"overflow-x-auto"},lt={class:"w-full"},rt={class:"border-b bg-muted/50"},at={class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},ut=["checked"],dt={class:"p-4"},ct=["checked","onChange"],ft={class:"p-4 font-medium"},mt={class:"p-4 text-sm text-muted-foreground"},vt={class:"p-4 text-sm"},pt={class:"p-4"},gt={class:"p-4 text-sm text-muted-foreground"},bt={class:"p-4"},xt={class:"flex gap-2"},ht=["onClick"],yt=["onClick"],wt={class:"flex items-center justify-between mt-6"},kt={class:"text-sm text-muted-foreground"},_t={class:"bg-background rounded-lg shadow-lg w-full max-w-md p-6"},Ct={class:"flex items-center justify-between mb-6"},jt={class:"text-xl font-bold"},At={class:"space-y-2"},Vt={class:"space-y-2"},$t={class:"space-y-2"},St={class:"space-y-2"},Et={class:"flex gap-3 pt-4 border-t"},Mt=["disabled"],zt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},It={class:"bg-background rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6"},Dt={class:"flex items-center justify-between mb-6"},Nt={key:0,class:"space-y-6"},Ft={class:"border-2 border-dashed rounded-lg p-8 text-center"},Lt={key:0,class:"p-4 bg-muted rounded-lg"},Tt={class:"flex items-center justify-between"},Ut={class:"flex items-center gap-3"},Gt={class:"font-medium"},Bt={class:"text-xs text-muted-foreground"},qt={class:"p-4 bg-primary/10 rounded-lg border border-primary/20"},Ht={class:"flex items-start gap-3"},Rt={class:"flex justify-end gap-3 pt-4 border-t"},Zt=["disabled"],Ot={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Pt={key:1,class:"space-y-6"},Jt={class:"p-4 bg-muted/50 rounded-lg"},Kt={class:"text-xs text-muted-foreground"},Qt={class:"space-y-4"},Wt={class:"p-3 bg-muted rounded-lg"},Xt={class:"font-medium"},Yt={class:"text-xs text-muted-foreground mt-1"},es={class:"space-y-2"},ts=["onUpdate:modelValue"],ss={class:"p-4 bg-warning/10 rounded-lg border border-warning/20"},os={class:"flex items-start gap-3"},ns={class:"flex justify-between gap-3 pt-4 border-t"},is=["disabled"],ls={key:2,class:"space-y-6"},rs={class:"p-4 bg-muted/50 rounded-lg"},as={class:"text-xs text-muted-foreground"},us={class:"rounded-lg border overflow-hidden max-h-96 overflow-y-auto"},ds={class:"w-full"},cs={class:"p-3 text-sm"},fs={class:"p-3 text-sm text-muted-foreground"},ms={class:"p-3 text-sm"},vs={key:0,class:"text-center text-sm text-muted-foreground"},ps={class:"flex justify-between gap-3 pt-4 border-t"},gs=["disabled"],bs={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},xs={class:"bg-background rounded-lg shadow-lg w-full max-w-md"},hs={class:"border-b p-6"},ys={class:"flex items-center justify-between"},ws={class:"text-sm text-muted-foreground mt-2"},ks={class:"p-6 space-y-4"},_s={key:0,class:"text-center py-6"},Cs={key:1,class:"space-y-2"},js=["value"],As={class:"flex gap-3 pt-4 border-t"},Vs=["disabled"],$s={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Ts=$e({__name:"Contacts",setup(Z){const k=r(""),N=r("all"),O=r(!1),P=r(!1),J=r(!1),K=r(!1),v=r([]),F=r([]),c=r([]),_=r(null),Q=r(!1),S=r(!1),Y=r(""),E=r(!1),f=r({name:"",email:"",phone:"",status:"active"}),C=r(null),b=r(1),p=r(null),M=r([]),j=r([]),x=r({}),A=r(!1),z=r(!1),le=r(null),V=g(()=>{let s=v.value;if(k.value){const t=k.value.toLowerCase();s=s.filter(o=>o.name.toLowerCase().includes(t)||o.email.toLowerCase().includes(t)||o.phone.includes(t))}return N.value!=="all"&&(s=s.filter(t=>t.status===N.value)),s}),re=g(()=>v.value.length),ae=g(()=>v.value.filter(s=>s.status==="active").length),ue=g(()=>v.value.filter(s=>s.status==="inactive").length),de=g(()=>{const s=new Date;return s.setDate(s.getDate()-30),v.value.filter(t=>new Date(t.created_at||"")>=s).length}),ce=g(()=>{const s=Object.values(x.value).filter(t=>t);return s.includes("name")&&s.includes("email")&&s.includes("phone")}),h=g(()=>j.value.map(s=>{const t={status:"active"};return M.value.forEach((o,a)=>{const I=x.value[o];I&&(t[I]=s[a])}),t}).filter(s=>s.name&&s.email&&s.phone)),ee=g(()=>V.value.length>0&&V.value.every(s=>c.value.includes(s.id))),fe=g(()=>c.value.length>0);function me(s){return s?new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}async function W(){Q.value=!0,Y.value="";try{const s=await D.getAll();console.log("Contacts loaded:",s),v.value=s}catch(s){Y.value=s.message||"Erreur lors du chargement des contacts",console.error("Error loading contacts:",s)}finally{Q.value=!1}}function ve(){C.value=null,f.value={name:"",email:"",phone:"",status:"active"},O.value=!0}function pe(s){C.value=s,f.value={name:s.name,email:s.email,phone:s.phone,status:s.status},P.value=!0}function L(){O.value=!1,P.value=!1,C.value=null}async function ge(){var s,t;S.value=!0;try{C.value?(await D.update(C.value.id,f.value),$("Contact modifié avec succès")):(await D.create(f.value),$("Contact ajouté avec succès")),L(),await W()}catch(o){w(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||o.message||"Erreur lors de l'enregistrement")}finally{S.value=!1}}async function be(s){if(await Fe("Supprimer le contact ?",`Êtes-vous sûr de vouloir supprimer ${s.name} ?`))try{await D.delete(s.id),$("Contact supprimé avec succès"),v.value=v.value.filter(o=>o.id!==s.id)}catch(o){w(o.message||"Erreur lors de la suppression"),console.error("Error deleting contact:",o)}}function T(){J.value=!1,b.value=1,p.value=null,M.value=[],j.value=[],x.value={}}function xe(s){const t=s.target;t.files&&t.files[0]&&(p.value=t.files[0])}async function he(){if(p.value){A.value=!0;try{const t=(await p.value.text()).split(`
`).filter(o=>o.trim());if(t.length===0){w("Le fichier CSV est vide"),A.value=!1;return}M.value=t[0].split(",").map(o=>o.trim().replace(/"/g,"")),j.value=t.slice(1,101).map(o=>o.split(",").map(a=>a.trim().replace(/"/g,""))),M.value.forEach(o=>{const a=o.toLowerCase();a.includes("nom")||a.includes("name")?x.value[o]="name":a.includes("email")||a.includes("mail")?x.value[o]="email":(a.includes("tel")||a.includes("phone")||a.includes("mobile"))&&(x.value[o]="phone")}),b.value=2}catch(s){w("Erreur lors de la lecture du fichier: "+s.message)}finally{A.value=!1}}}async function ye(){if(h.value.length!==0){z.value=!0;try{let s=0,t=0;for(const o of h.value)try{await D.create(o),s++}catch(a){t++,console.error("Error importing contact:",a)}t>0?$(`Importation terminée: ${s} contacts importés, ${t} erreurs`):$(`${s} contacts importés avec succès !`),await W(),T()}catch(s){w(s.message||"Erreur lors de l'importation")}finally{z.value=!1}}}function we(){ee.value?c.value=[]:c.value=V.value.map(s=>s.id)}function ke(s){const t=c.value.indexOf(s);t>-1?c.value.splice(t,1):c.value.push(s)}function _e(s){return c.value.includes(s)}async function Ce(){try{const s=await se.get("/contact-groups");F.value=s.data.data}catch(s){console.error("Error loading groups:",s)}}function je(){if(c.value.length===0){w("Veuillez sélectionner au moins un contact");return}_.value=null,K.value=!0}function U(){K.value=!1,_.value=null}async function Ae(){var s,t;if(!_.value){w("Veuillez sélectionner un groupe");return}E.value=!0;try{await se.post(`/contact-groups/${_.value}/contacts/add`,{contact_ids:c.value}),$(`${c.value.length} contact(s) ajouté(s) au groupe`),c.value=[],U()}catch(o){w(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Erreur lors de l'ajout au groupe")}finally{E.value=!1}}return Se(()=>{W(),Ce()}),(s,t)=>(i(),te(ze,null,{default:Ee(()=>[e("div",Be,[e("div",qe,[t[15]||(t[15]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Contacts"),e("p",{class:"text-muted-foreground mt-2"},"Gérez votre liste de contacts")],-1)),e("div",He,[fe.value?(i(),l("button",{key:0,onClick:je,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(u(oe),{class:"w-4 h-4"}),e("span",null,"Ajouter à un groupe ("+n(c.value.length)+")",1)])):m("",!0),e("button",{onClick:t[0]||(t[0]=o=>J.value=!0),class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[d(u(ie),{class:"w-4 h-4"}),t[13]||(t[13]=e("span",null,"Importer",-1))]),e("button",{onClick:ve,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[d(u(Ie),{class:"w-4 h-4"}),t[14]||(t[14]=e("span",null,"Nouveau contact",-1))])])]),e("div",Re,[e("div",Ze,[t[16]||(t[16]=e("div",{class:"text-sm text-muted-foreground"},"Total contacts",-1)),e("div",Oe,n(re.value),1)]),e("div",Pe,[t[17]||(t[17]=e("div",{class:"text-sm text-muted-foreground"},"Actifs",-1)),e("div",Je,n(ae.value),1)]),e("div",Ke,[t[18]||(t[18]=e("div",{class:"text-sm text-muted-foreground"},"Inactifs",-1)),e("div",Qe,n(ue.value),1)]),e("div",We,[t[19]||(t[19]=e("div",{class:"text-sm text-muted-foreground"},"Nouveaux (30j)",-1)),e("div",Xe,n(de.value),1)])]),e("div",Ye,[e("div",et,[e("div",tt,[y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>k.value=o),type:"text",placeholder:"Rechercher par nom, email ou téléphone...",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},null,512),[[G,k.value]])]),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>N.value=o),class:"flex h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[...t[20]||(t[20]=[e("option",{value:"all"},"Tous les statuts",-1),e("option",{value:"active"},"Actifs",-1),e("option",{value:"inactive"},"Inactifs",-1)])],512),[[B,N.value]])])]),e("div",st,[Q.value?(i(),l("div",ot,[...t[21]||(t[21]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):V.value.length===0?(i(),l("div",nt,[d(u(De),{class:"w-16 h-16 text-muted-foreground mb-4"}),t[22]||(t[22]=e("p",{class:"text-lg font-medium"},"Aucun contact trouvé",-1)),t[23]||(t[23]=e("p",{class:"text-sm text-muted-foreground mt-1"},"Commencez par ajouter ou importer des contacts",-1))])):(i(),l("div",it,[e("table",lt,[e("thead",rt,[e("tr",null,[e("th",at,[e("input",{type:"checkbox",checked:ee.value,onChange:we,class:"rounded border-gray-300 cursor-pointer"},null,40,ut)]),t[24]||(t[24]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Nom",-1)),t[25]||(t[25]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email",-1)),t[26]||(t[26]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Téléphone",-1)),t[27]||(t[27]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Statut",-1)),t[28]||(t[28]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Date d'ajout",-1)),t[29]||(t[29]=e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Actions",-1))])]),e("tbody",null,[(i(!0),l(q,null,H(V.value,o=>(i(),l("tr",{key:o.id,class:"border-b transition-colors hover:bg-muted/50"},[e("td",dt,[e("input",{type:"checkbox",checked:_e(o.id),onChange:a=>ke(o.id),class:"rounded border-gray-300 cursor-pointer"},null,40,ct)]),e("td",ft,n(o.name),1),e("td",mt,n(o.email),1),e("td",vt,n(o.phone),1),e("td",pt,[e("span",{class:Me(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",o.status==="active"?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},n(o.status==="active"?"Actif":"Inactif"),3)]),e("td",gt,n(me(o.created_at)),1),e("td",bt,[e("div",xt,[e("button",{onClick:a=>pe(o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-8 w-8",title:"Modifier"},[d(u(Le),{class:"w-4 h-4"})],8,ht),e("button",{onClick:a=>be(o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-destructive/10 hover:text-destructive h-8 w-8",title:"Supprimer"},[d(u(ne),{class:"w-4 h-4"})],8,yt)])])]))),128))])])]))]),e("div",wt,[e("p",kt," Affichage de 1 à "+n(V.value.length)+" sur "+n(v.value.length)+" contacts ",1),t[30]||(t[30]=e("div",{class:"flex gap-2"},[e("button",{class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3"}," Précédent "),e("button",{class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3"}," Suivant ")],-1))])]),O.value||P.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:R(L,["self"])},[e("div",_t,[e("div",Ct,[e("h2",jt,n(C.value?"Modifier le contact":"Nouveau contact"),1),e("button",{onClick:L,class:"hover:bg-accent rounded-full p-1"},[d(u(X),{class:"w-5 h-5"})])]),e("form",{onSubmit:R(ge,["prevent"]),class:"space-y-4"},[e("div",At,[t[31]||(t[31]=e("label",{class:"text-sm font-medium"},"Nom complet *",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>f.value.name=o),type:"text",required:"",placeholder:"Jean Dupont",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[G,f.value.name]])]),e("div",Vt,[t[32]||(t[32]=e("label",{class:"text-sm font-medium"},"Email *",-1)),y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>f.value.email=o),type:"email",required:"",placeholder:"jean.dupont@example.com",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[G,f.value.email]])]),e("div",$t,[t[33]||(t[33]=e("label",{class:"text-sm font-medium"},"Téléphone *",-1)),y(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>f.value.phone=o),type:"tel",required:"",placeholder:"+237600000000",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[G,f.value.phone]])]),e("div",St,[t[35]||(t[35]=e("label",{class:"text-sm font-medium"},"Statut",-1)),y(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>f.value.status=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[34]||(t[34]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[B,f.value.status]])]),e("div",Et,[e("button",{type:"button",onClick:L,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"submit",disabled:S.value,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[S.value?(i(),l("div",zt)):m("",!0),e("span",null,n(S.value?"Enregistrement...":C.value?"Modifier":"Ajouter"),1)],8,Mt)])],32)])])):m("",!0),J.value?(i(),l("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:R(T,["self"])},[e("div",It,[e("div",Dt,[t[36]||(t[36]=e("div",null,[e("h2",{class:"text-xl font-bold"},"Importer des contacts"),e("p",{class:"text-sm text-muted-foreground mt-1"},"Importez vos contacts depuis un fichier CSV")],-1)),e("button",{onClick:T,class:"hover:bg-accent rounded-full p-1"},[d(u(X),{class:"w-5 h-5"})])]),b.value===1?(i(),l("div",Nt,[e("div",Ft,[d(u(Ue),{class:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),t[37]||(t[37]=e("div",{class:"space-y-2"},[e("p",{class:"text-sm font-medium"},"Glissez-déposez votre fichier CSV ici"),e("p",{class:"text-xs text-muted-foreground"},"ou cliquez pour sélectionner un fichier")],-1)),e("input",{type:"file",accept:".csv",onChange:xe,class:"hidden",ref_key:"fileInput",ref:le},null,544),e("button",{onClick:t[7]||(t[7]=o=>s.$refs.fileInput.click()),class:"mt-4 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Sélectionner un fichier ")]),p.value?(i(),l("div",Lt,[e("div",Tt,[e("div",Ut,[d(u(Ne),{class:"w-8 h-8 text-primary"}),e("div",null,[e("p",Gt,n(p.value.name),1),e("p",Bt,n((p.value.size/1024).toFixed(2))+" KB",1)])]),e("button",{onClick:t[8]||(t[8]=o=>p.value=null),class:"text-destructive hover:bg-destructive/10 rounded p-2"},[d(u(ne),{class:"w-4 h-4"})])])])):m("",!0),e("div",qt,[e("div",Ht,[d(u(Ge),{class:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),t[38]||(t[38]=e("div",{class:"text-sm"},[e("p",{class:"font-medium mb-2"},"Format du fichier CSV :"),e("ul",{class:"space-y-1 text-muted-foreground"},[e("li",null,"• La première ligne doit contenir les en-têtes de colonnes"),e("li",null,"• Les champs doivent être séparés par des virgules (,)"),e("li",null,"• Format recommandé : nom, email, téléphone"),e("li",null,"• Encodage UTF-8 recommandé")])],-1))])]),e("div",Rt,[e("button",{onClick:T,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{onClick:he,disabled:!p.value||A.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[A.value?(i(),l("div",Ot)):m("",!0),e("span",null,n(A.value?"Analyse...":"Continuer"),1)],8,Zt)])])):m("",!0),b.value===2?(i(),l("div",Pt,[e("div",Jt,[t[39]||(t[39]=e("p",{class:"text-sm font-medium mb-2"},"Mappage des colonnes",-1)),e("p",Kt," Associez les colonnes de votre fichier CSV aux champs du système. "+n(j.value.length)+" lignes détectées. ",1)]),e("div",Qt,[(i(!0),l(q,null,H(M.value,(o,a)=>{var I;return i(),l("div",{key:a,class:"grid grid-cols-2 gap-4 items-center"},[e("div",Wt,[t[40]||(t[40]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Colonne CSV",-1)),e("p",Xt,n(o),1),e("p",Yt,"Exemple: "+n(((I=j.value[0])==null?void 0:I[a])||"-"),1)]),e("div",es,[t[42]||(t[42]=e("label",{class:"text-xs text-muted-foreground"},"Associer à",-1)),y(e("select",{"onUpdate:modelValue":Ve=>x.value[o]=Ve,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[41]||(t[41]=[e("option",{value:""},"-- Ne pas importer --",-1),e("option",{value:"name"},"Nom",-1),e("option",{value:"email"},"Email",-1),e("option",{value:"phone"},"Téléphone",-1)])],8,ts),[[B,x.value[o]]])])])}),128))]),e("div",ss,[e("div",os,[d(u(Te),{class:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),t[43]||(t[43]=e("div",{class:"text-sm"},[e("p",{class:"font-medium mb-1"},"Champs obligatoires"),e("p",{class:"text-muted-foreground"},"Les champs Nom, Email et Téléphone sont obligatoires pour chaque contact.")],-1))])]),e("div",ns,[e("button",{onClick:t[9]||(t[9]=o=>b.value=1),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Retour "),e("button",{onClick:t[10]||(t[10]=o=>b.value=3),disabled:!ce.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Continuer ",8,is)])])):m("",!0),b.value===3?(i(),l("div",ls,[e("div",rs,[t[44]||(t[44]=e("p",{class:"text-sm font-medium mb-2"},"Aperçu des données",-1)),e("p",as," Vérifiez les données avant l'importation. "+n(h.value.length)+" contacts valides sur "+n(j.value.length)+". ",1)]),e("div",us,[e("table",ds,[t[46]||(t[46]=e("thead",{class:"border-b bg-muted/50 sticky top-0"},[e("tr",null,[e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Nom"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Email"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Téléphone"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Statut")])],-1)),e("tbody",null,[(i(!0),l(q,null,H(h.value.slice(0,20),(o,a)=>(i(),l("tr",{key:a,class:"border-b"},[e("td",cs,n(o.name),1),e("td",fs,n(o.email),1),e("td",ms,n(o.phone),1),t[45]||(t[45]=e("td",{class:"p-3 text-sm"},[e("span",{class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold bg-success/10 text-success"}," Valide ")],-1))]))),128))])])]),h.value.length>20?(i(),l("div",vs," ... et "+n(h.value.length-20)+" autres contacts ",1)):m("",!0),e("div",ps,[e("button",{onClick:t[11]||(t[11]=o=>b.value=2),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Retour "),e("button",{onClick:ye,disabled:z.value||h.value.length===0,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-success text-success-foreground hover:bg-success/90 h-10 px-4 py-2"},[z.value?(i(),l("div",bs)):(i(),te(u(ie),{key:1,class:"w-4 h-4"})),e("span",null,n(z.value?"Importation...":`Importer ${h.value.length} contacts`),1)],8,gs)])])):m("",!0)])])):m("",!0),K.value?(i(),l("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:R(U,["self"])},[e("div",xs,[e("div",hs,[e("div",ys,[t[47]||(t[47]=e("h2",{class:"text-xl font-bold"},"Ajouter à un groupe",-1)),e("button",{onClick:U,class:"hover:bg-accent rounded-full p-1"},[d(u(X),{class:"w-5 h-5"})])]),e("p",ws,n(c.value.length)+" contact(s) sélectionné(s) ",1)]),e("div",ks,[F.value.length===0?(i(),l("div",_s,[d(u(oe),{class:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),t[48]||(t[48]=e("p",{class:"text-sm text-muted-foreground"},"Aucun groupe disponible",-1)),t[49]||(t[49]=e("p",{class:"text-xs text-muted-foreground mt-1"},"Créez un groupe depuis la page Groupes",-1))])):(i(),l("div",Cs,[t[51]||(t[51]=e("label",{class:"text-sm font-medium"},"Sélectionner un groupe *",-1)),y(e("select",{"onUpdate:modelValue":t[12]||(t[12]=o=>_.value=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[t[50]||(t[50]=e("option",{value:null},"-- Choisir un groupe --",-1)),(i(!0),l(q,null,H(F.value,o=>(i(),l("option",{key:o.id,value:o.id},n(o.name)+" ("+n(o.contacts_count)+" contacts) ",9,js))),128))],512),[[B,_.value]])])),e("div",As,[e("button",{type:"button",onClick:U,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"button",onClick:Ae,disabled:!_.value||E.value||F.value.length===0,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[E.value?(i(),l("div",$s)):m("",!0),e("span",null,n(E.value?"Ajout...":"Ajouter"),1)],8,Vs)])])])])):m("",!0)]),_:1}))}});export{Ts as default};
