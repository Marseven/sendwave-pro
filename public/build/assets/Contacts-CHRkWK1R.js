import{d as De,r as a,k as b,m as Ue,n as te,p as Ge,o as l,b as e,c as i,x as u,y as d,t as n,g as f,f as p,v as I,C as P,F as z,q as F,s as ue,w as H}from"./main-ls90rwIC.js";import{_ as Le,f as ce,l as me,c as Te,h as se,g as qe}from"./api-DPpa1nXl.js";import{c as $}from"./contactService-BGAfbhjD.js";import{a as A,b as v,s as Be}from"./notifications-CHQAjgV4.js";import{r as fe}from"./UserGroupIcon-D2zDNXJU.js";import{r as Oe}from"./ArrowUpTrayIcon-BEZaHx_8.js";import{r as pe}from"./ArrowDownTrayIcon-CVfufe0v.js";import{r as ve}from"./PencilIcon-DoPBHX3G.js";import{r as J}from"./TrashIcon-C2gqBzIZ.js";import{r as Re}from"./TagIcon-FRiez3TD.js";import{r as Ke}from"./DocumentArrowUpIcon-DtTvjXSt.js";import{r as Pe}from"./InformationCircleIcon-W8_DTi8w.js";import{r as He}from"./ExclamationTriangleIcon-D6StQkpA.js";const Je={class:"p-4 sm:p-6 lg:p-8"},Qe={class:"mb-4 sm:mb-6 lg:mb-8"},We={class:"flex flex-col gap-4"},Xe={class:"flex flex-wrap gap-2"},Ye=["disabled"],Ze={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"},et={class:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-4 sm:mb-6 lg:mb-8"},tt={class:"rounded-lg border bg-card p-3 sm:p-4"},st={class:"text-xl sm:text-2xl font-bold mt-1"},ot={class:"rounded-lg border bg-card p-3 sm:p-4"},nt={class:"text-xl sm:text-2xl font-bold mt-1 text-success"},lt={class:"rounded-lg border bg-card p-3 sm:p-4"},it={class:"text-xl sm:text-2xl font-bold mt-1 text-muted-foreground"},rt={class:"rounded-lg border bg-card p-3 sm:p-4"},at={class:"text-xl sm:text-2xl font-bold mt-1 text-primary"},dt={class:"rounded-lg border bg-card shadow-sm mb-4 sm:mb-6 p-3 sm:p-4 lg:p-6"},ut={class:"flex flex-col sm:flex-row gap-3 sm:gap-4"},ct={class:"flex-1"},mt={class:"rounded-lg border bg-card shadow-sm"},ft={key:0,class:"flex items-center justify-center py-8 sm:py-12"},pt={key:1,class:"flex flex-col items-center justify-center py-8 sm:py-12 px-4"},vt={key:2},gt={class:"hidden md:block overflow-x-auto"},xt={class:"w-full"},bt={class:"border-b bg-muted/50"},ht={class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm"},yt=["checked"],wt={class:"p-3 sm:p-4"},_t=["checked","onChange"],kt={class:"p-3 sm:p-4 font-medium text-sm"},Ct={class:"p-3 sm:p-4 text-xs sm:text-sm text-muted-foreground truncate max-w-[150px]"},jt={class:"p-3 sm:p-4 text-xs sm:text-sm"},$t={class:"p-3 sm:p-4"},At={class:"p-3 sm:p-4 text-xs sm:text-sm text-muted-foreground hidden lg:table-cell"},St={class:"p-3 sm:p-4"},Vt={class:"flex gap-1"},Et=["onClick"],Mt=["onClick"],It={class:"md:hidden divide-y"},zt={class:"flex items-start justify-between gap-3"},Ft={class:"flex items-start gap-3 flex-1 min-w-0"},Nt=["checked","onChange"],Dt={class:"flex-1 min-w-0"},Ut={class:"font-medium text-sm truncate"},Gt={class:"text-xs text-muted-foreground truncate"},Lt={class:"text-xs text-muted-foreground truncate"},Tt={class:"flex flex-wrap items-center gap-2 mt-2"},qt={class:"text-xs text-muted-foreground"},Bt={class:"flex gap-1 flex-shrink-0"},Ot=["onClick"],Rt=["onClick"],Kt={class:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 sm:mt-6"},Pt={class:"text-xs sm:text-sm text-muted-foreground text-center sm:text-left"},Ht={class:"bg-background rounded-lg shadow-lg w-full max-w-sm sm:max-w-md p-4 sm:p-6 max-h-[90vh] overflow-y-auto"},Jt={class:"flex items-center justify-between mb-6"},Qt={class:"text-xl font-bold"},Wt={class:"space-y-2"},Xt={class:"space-y-2"},Yt={class:"space-y-2"},Zt={class:"space-y-2"},es={class:"space-y-3 pt-4 border-t"},ts={class:"flex items-center justify-between"},ss={key:0,class:"space-y-2"},os={class:"flex-1"},ns={class:"text-xs font-medium text-muted-foreground"},ls={class:"text-sm"},is=["onClick"],rs={class:"space-y-2 p-3 bg-muted/30 rounded-lg"},as={class:"grid grid-cols-2 gap-2"},ds={class:"flex gap-3 pt-4 border-t"},us=["disabled"],cs={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},ms={class:"bg-background rounded-lg shadow-lg w-full max-w-sm sm:max-w-2xl lg:max-w-4xl max-h-[90vh] overflow-y-auto p-4 sm:p-6"},fs={class:"flex items-center justify-between mb-6"},ps={key:0,class:"space-y-6"},vs={class:"border-2 border-dashed rounded-lg p-8 text-center"},gs={key:0,class:"p-4 bg-muted rounded-lg"},xs={class:"flex items-center justify-between"},bs={class:"flex items-center gap-3"},hs={class:"font-medium"},ys={class:"text-xs text-muted-foreground"},ws={class:"p-4 bg-primary/10 rounded-lg border border-primary/20"},_s={class:"flex items-start gap-3"},ks={class:"flex justify-end gap-3 pt-4 border-t"},Cs=["disabled"],js={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},$s={key:1,class:"space-y-6"},As={class:"p-4 bg-muted/50 rounded-lg"},Ss={class:"text-xs text-muted-foreground"},Vs={class:"space-y-4"},Es={class:"p-3 bg-muted rounded-lg"},Ms={class:"font-medium"},Is={class:"text-xs text-muted-foreground mt-1"},zs={class:"space-y-2"},Fs=["onUpdate:modelValue"],Ns={class:"p-4 bg-warning/10 rounded-lg border border-warning/20"},Ds={class:"flex items-start gap-3"},Us={class:"flex justify-between gap-3 pt-4 border-t"},Gs=["disabled"],Ls={key:2,class:"space-y-6"},Ts={class:"p-4 bg-muted/50 rounded-lg"},qs={class:"text-xs text-muted-foreground"},Bs={class:"rounded-lg border overflow-hidden max-h-96 overflow-y-auto"},Os={class:"w-full"},Rs={class:"p-3 text-sm"},Ks={class:"p-3 text-sm text-muted-foreground"},Ps={class:"p-3 text-sm"},Hs={key:0,class:"text-center text-sm text-muted-foreground"},Js={class:"flex justify-between gap-3 pt-4 border-t"},Qs=["disabled"],Ws={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Xs={class:"bg-background rounded-lg shadow-lg w-full max-w-sm sm:max-w-md"},Ys={class:"border-b p-6"},Zs={class:"flex items-center justify-between"},eo={class:"text-sm text-muted-foreground mt-2"},to={class:"p-6 space-y-4"},so={key:0,class:"text-center py-6"},oo={key:1,class:"space-y-2"},no=["value"],lo={class:"flex gap-3 pt-4 border-t"},io=["disabled"],ro={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},ko=De({__name:"Contacts",setup(ao){const L=a(""),T=a("all"),Q=a(!1),W=a(!1),X=a(!1),Y=a(!1),g=a([]),q=a([]),m=a([]),_=a(null),Z=a(!1),N=a(!1),B=a(!1),oe=a(""),D=a(!1),c=a({name:"",email:"",phone:"",status:"active",custom_fields:{}}),k=a(null),C=a(""),S=a(""),h=a(1),x=a(null),U=a([]),V=a([]),y=a({}),E=a(!1),G=a(!1),ge=a(null),j=b(()=>{let o=g.value;if(L.value){const t=L.value.toLowerCase();o=o.filter(s=>s.name.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)||s.phone.includes(t))}return T.value!=="all"&&(o=o.filter(t=>t.status===T.value)),o}),xe=b(()=>g.value.length),be=b(()=>g.value.filter(o=>o.status==="active").length),he=b(()=>g.value.filter(o=>o.status==="inactive").length),ye=b(()=>{const o=new Date;return o.setDate(o.getDate()-30),g.value.filter(t=>new Date(t.created_at||"")>=o).length}),we=b(()=>{const o=Object.values(y.value).filter(t=>t);return o.includes("name")&&o.includes("email")&&o.includes("phone")}),w=b(()=>V.value.map(o=>{const t={status:"active"};return U.value.forEach((s,r)=>{const M=y.value[s];M&&(t[M]=o[r])}),t}).filter(o=>o.name&&o.email&&o.phone)),ne=b(()=>j.value.length>0&&j.value.every(o=>m.value.includes(o.id))),_e=b(()=>m.value.length>0);function le(o){return o?new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}async function ee(){Z.value=!0,oe.value="";try{const o=await $.getAll();console.log("Contacts loaded:",o),g.value=o}catch(o){oe.value=o.message||"Erreur lors du chargement des contacts",console.error("Error loading contacts:",o)}finally{Z.value=!1}}async function ke(){var o,t;B.value=!0;try{const s=await $.exportCsv(),r=`contacts_${new Date().toISOString().slice(0,10)}.csv`;$.downloadFile(s,r),A("Contacts exportés avec succès")}catch(s){console.error("Error exporting contacts:",s),v(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Erreur lors de l'export des contacts")}finally{B.value=!1}}function Ce(){k.value=null,c.value={name:"",email:"",phone:"",status:"active",custom_fields:{}},C.value="",S.value="",Q.value=!0}function ie(o){k.value=o,c.value={name:o.name,email:o.email,phone:o.phone,status:o.status,custom_fields:o.custom_fields||{}},C.value="",S.value="",W.value=!0}function je(){if(!C.value.trim()){v("Le nom du champ est requis");return}c.value.custom_fields[C.value]=S.value,C.value="",S.value=""}function $e(o){delete c.value.custom_fields[o]}function O(){Q.value=!1,W.value=!1,k.value=null}async function Ae(){var o,t;N.value=!0;try{k.value?(await $.update(k.value.id,c.value),A("Contact modifié avec succès")):(await $.create(c.value),A("Contact ajouté avec succès")),O(),await ee()}catch(s){v(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||s.message||"Erreur lors de l'enregistrement")}finally{N.value=!1}}async function re(o){if(await Be("Supprimer le contact ?",`Êtes-vous sûr de vouloir supprimer ${o.name} ?`))try{await $.delete(o.id),A("Contact supprimé avec succès"),g.value=g.value.filter(s=>s.id!==o.id)}catch(s){v(s.message||"Erreur lors de la suppression"),console.error("Error deleting contact:",s)}}function R(){X.value=!1,h.value=1,x.value=null,U.value=[],V.value=[],y.value={}}function Se(o){const t=o.target;t.files&&t.files[0]&&(x.value=t.files[0])}async function Ve(){if(x.value){E.value=!0;try{const t=(await x.value.text()).split(`
`).filter(s=>s.trim());if(t.length===0){v("Le fichier CSV est vide"),E.value=!1;return}U.value=t[0].split(",").map(s=>s.trim().replace(/"/g,"")),V.value=t.slice(1,101).map(s=>s.split(",").map(r=>r.trim().replace(/"/g,""))),U.value.forEach(s=>{const r=s.toLowerCase();r.includes("nom")||r.includes("name")?y.value[s]="name":r.includes("email")||r.includes("mail")?y.value[s]="email":(r.includes("tel")||r.includes("phone")||r.includes("mobile"))&&(y.value[s]="phone")}),h.value=2}catch(o){v("Erreur lors de la lecture du fichier: "+o.message)}finally{E.value=!1}}}async function Ee(){if(w.value.length!==0){G.value=!0;try{let o=0,t=0;for(const s of w.value)try{await $.create(s),o++}catch(r){t++,console.error("Error importing contact:",r)}t>0?A(`Importation terminée: ${o} contacts importés, ${t} erreurs`):A(`${o} contacts importés avec succès !`),await ee(),R()}catch(o){v(o.message||"Erreur lors de l'importation")}finally{G.value=!1}}}function Me(){ne.value?m.value=[]:m.value=j.value.map(o=>o.id)}function ae(o){const t=m.value.indexOf(o);t>-1?m.value.splice(t,1):m.value.push(o)}function de(o){return m.value.includes(o)}async function Ie(){try{const o=await ce.get("/contact-groups");q.value=o.data.data}catch(o){console.error("Error loading groups:",o)}}function ze(){if(m.value.length===0){v("Veuillez sélectionner au moins un contact");return}_.value=null,Y.value=!0}function K(){Y.value=!1,_.value=null}async function Fe(){var o,t;if(!_.value){v("Veuillez sélectionner un groupe");return}D.value=!0;try{await ce.post(`/contact-groups/${_.value}/contacts/add`,{contact_ids:m.value}),A(`${m.value.length} contact(s) ajouté(s) au groupe`),m.value=[],K()}catch(s){v(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Erreur lors de l'ajout au groupe")}finally{D.value=!1}}return Ue(()=>{ee(),Ie()}),(o,t)=>(l(),te(Le,null,{default:Ge(()=>[e("div",Je,[e("div",Qe,[e("div",We,[t[21]||(t[21]=e("div",null,[e("h1",{class:"text-2xl sm:text-3xl font-bold"},"Contacts"),e("p",{class:"text-sm text-muted-foreground mt-1 sm:mt-2"},"Gérez votre liste de contacts")],-1)),e("div",Xe,[_e.value?(l(),i("button",{key:0,onClick:ze,class:"inline-flex items-center justify-center gap-1 sm:gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 sm:h-10 px-3 sm:px-4 py-2"},[u(d(fe),{class:"w-4 h-4"}),t[15]||(t[15]=e("span",{class:"hidden sm:inline"},"Ajouter à un groupe",-1)),t[16]||(t[16]=e("span",{class:"sm:hidden"},"Groupe",-1)),e("span",null,"("+n(m.value.length)+")",1)])):f("",!0),e("button",{onClick:ke,disabled:B.value,class:"inline-flex items-center justify-center gap-1 sm:gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 sm:h-10 px-3 sm:px-4 py-2 disabled:opacity-50"},[B.value?(l(),i("div",Ze)):(l(),te(d(Oe),{key:0,class:"w-4 h-4"})),t[17]||(t[17]=e("span",{class:"hidden sm:inline"},"Exporter",-1))],8,Ye),e("button",{onClick:t[0]||(t[0]=s=>X.value=!0),class:"inline-flex items-center justify-center gap-1 sm:gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 sm:h-10 px-3 sm:px-4 py-2"},[u(d(pe),{class:"w-4 h-4"}),t[18]||(t[18]=e("span",{class:"hidden sm:inline"},"Importer",-1))]),e("button",{onClick:Ce,class:"inline-flex items-center justify-center gap-1 sm:gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90 h-9 sm:h-10 px-3 sm:px-4 py-2"},[u(d(me),{class:"w-4 h-4"}),t[19]||(t[19]=e("span",{class:"hidden sm:inline"},"Nouveau contact",-1)),t[20]||(t[20]=e("span",{class:"sm:hidden"},"Nouveau",-1))])])])]),e("div",et,[e("div",tt,[t[22]||(t[22]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Total contacts",-1)),e("div",st,n(xe.value),1)]),e("div",ot,[t[23]||(t[23]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Actifs",-1)),e("div",nt,n(be.value),1)]),e("div",lt,[t[24]||(t[24]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Inactifs",-1)),e("div",it,n(he.value),1)]),e("div",rt,[t[25]||(t[25]=e("div",{class:"text-xs sm:text-sm text-muted-foreground"},"Nouveaux (30j)",-1)),e("div",at,n(ye.value),1)])]),e("div",dt,[e("div",ut,[e("div",ct,[p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>L.value=s),type:"text",placeholder:"Rechercher...",class:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},null,512),[[I,L.value]])]),p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>T.value=s),class:"flex h-9 sm:h-10 rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},[...t[26]||(t[26]=[e("option",{value:"all"},"Tous les statuts",-1),e("option",{value:"active"},"Actifs",-1),e("option",{value:"inactive"},"Inactifs",-1)])],512),[[P,T.value]])])]),e("div",mt,[Z.value?(l(),i("div",ft,[...t[27]||(t[27]=[e("div",{class:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-primary"},null,-1)])])):j.value.length===0?(l(),i("div",pt,[u(d(Te),{class:"w-12 h-12 sm:w-16 sm:h-16 text-muted-foreground mb-3 sm:mb-4"}),t[28]||(t[28]=e("p",{class:"text-base sm:text-lg font-medium text-center"},"Aucun contact trouvé",-1)),t[29]||(t[29]=e("p",{class:"text-xs sm:text-sm text-muted-foreground mt-1 text-center"},"Commencez par ajouter ou importer des contacts",-1))])):(l(),i("div",vt,[e("div",gt,[e("table",xt,[e("thead",bt,[e("tr",null,[e("th",ht,[e("input",{type:"checkbox",checked:ne.value,onChange:Me,class:"rounded border-gray-300 cursor-pointer"},null,40,yt)]),t[30]||(t[30]=e("th",{class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm"},"Nom",-1)),t[31]||(t[31]=e("th",{class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm"},"Email",-1)),t[32]||(t[32]=e("th",{class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm"},"Téléphone",-1)),t[33]||(t[33]=e("th",{class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm"},"Statut",-1)),t[34]||(t[34]=e("th",{class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm hidden lg:table-cell"},"Date d'ajout",-1)),t[35]||(t[35]=e("th",{class:"h-10 sm:h-12 px-3 sm:px-4 text-left align-middle font-medium text-muted-foreground text-xs sm:text-sm"},"Actions",-1))])]),e("tbody",null,[(l(!0),i(z,null,F(j.value,s=>(l(),i("tr",{key:s.id,class:"border-b transition-colors hover:bg-muted/50"},[e("td",wt,[e("input",{type:"checkbox",checked:de(s.id),onChange:r=>ae(s.id),class:"rounded border-gray-300 cursor-pointer"},null,40,_t)]),e("td",kt,n(s.name),1),e("td",Ct,n(s.email),1),e("td",jt,n(s.phone),1),e("td",$t,[e("span",{class:ue(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",s.status==="active"?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},n(s.status==="active"?"Actif":"Inactif"),3)]),e("td",At,n(le(s.created_at)),1),e("td",St,[e("div",Vt,[e("button",{onClick:r=>ie(s),class:"inline-flex items-center justify-center rounded-md hover:bg-accent hover:text-accent-foreground h-8 w-8",title:"Modifier"},[u(d(ve),{class:"w-4 h-4"})],8,Et),e("button",{onClick:r=>re(s),class:"inline-flex items-center justify-center rounded-md hover:bg-destructive/10 hover:text-destructive h-8 w-8",title:"Supprimer"},[u(d(J),{class:"w-4 h-4"})],8,Mt)])])]))),128))])])]),e("div",It,[(l(!0),i(z,null,F(j.value,s=>(l(),i("div",{key:s.id,class:"p-3 sm:p-4 hover:bg-muted/30"},[e("div",zt,[e("div",Ft,[e("input",{type:"checkbox",checked:de(s.id),onChange:r=>ae(s.id),class:"rounded border-gray-300 cursor-pointer mt-1"},null,40,Nt),e("div",Dt,[e("p",Ut,n(s.name),1),e("p",Gt,n(s.phone),1),e("p",Lt,n(s.email),1),e("div",Tt,[e("span",{class:ue(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",s.status==="active"?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},n(s.status==="active"?"Actif":"Inactif"),3),e("span",qt,n(le(s.created_at)),1)])])]),e("div",Bt,[e("button",{onClick:r=>ie(s),class:"p-2 hover:bg-accent rounded"},[u(d(ve),{class:"w-4 h-4"})],8,Ot),e("button",{onClick:r=>re(s),class:"p-2 hover:bg-destructive/10 text-destructive rounded"},[u(d(J),{class:"w-4 h-4"})],8,Rt)])])]))),128))])]))]),e("div",Kt,[e("p",Pt,n(j.value.length)+" sur "+n(g.value.length)+" contacts ",1),t[36]||(t[36]=e("div",{class:"flex gap-2"},[e("button",{class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs sm:text-sm font-medium border border-input bg-background hover:bg-accent hover:text-accent-foreground h-8 sm:h-9 px-2 sm:px-3"}," Précédent "),e("button",{class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs sm:text-sm font-medium border border-input bg-background hover:bg-accent hover:text-accent-foreground h-8 sm:h-9 px-2 sm:px-3"}," Suivant ")],-1))])]),Q.value||W.value?(l(),i("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:H(O,["self"])},[e("div",Ht,[e("div",Jt,[e("h2",Qt,n(k.value?"Modifier le contact":"Nouveau contact"),1),e("button",{onClick:O,class:"hover:bg-accent rounded-full p-1"},[u(d(se),{class:"w-5 h-5"})])]),e("form",{onSubmit:H(Ae,["prevent"]),class:"space-y-4"},[e("div",Wt,[t[37]||(t[37]=e("label",{class:"text-sm font-medium"},"Nom complet *",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>c.value.name=s),type:"text",required:"",placeholder:"Jean Dupont",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[I,c.value.name]])]),e("div",Xt,[t[38]||(t[38]=e("label",{class:"text-sm font-medium"},"Email *",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>c.value.email=s),type:"email",required:"",placeholder:"jean.dupont@example.com",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[I,c.value.email]])]),e("div",Yt,[t[39]||(t[39]=e("label",{class:"text-sm font-medium"},"Téléphone *",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>c.value.phone=s),type:"tel",required:"",placeholder:"+237600000000",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[I,c.value.phone]])]),e("div",Zt,[t[41]||(t[41]=e("label",{class:"text-sm font-medium"},"Statut",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>c.value.status=s),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[40]||(t[40]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[P,c.value.status]])]),e("div",es,[e("div",ts,[t[42]||(t[42]=e("label",{class:"text-sm font-medium"},"Champs personnalisés",-1)),u(d(Re),{class:"w-4 h-4 text-muted-foreground"})]),Object.keys(c.value.custom_fields).length>0?(l(),i("div",ss,[(l(!0),i(z,null,F(c.value.custom_fields,(s,r)=>(l(),i("div",{key:r,class:"flex items-center gap-2 p-2 bg-muted/50 rounded border"},[e("div",os,[e("p",ns,n(r),1),e("p",ls,n(s),1)]),e("button",{type:"button",onClick:M=>$e(r),class:"text-destructive hover:bg-destructive/10 rounded p-1"},[u(d(J),{class:"w-4 h-4"})],8,is)]))),128))])):f("",!0),e("div",rs,[t[44]||(t[44]=e("p",{class:"text-xs text-muted-foreground"},"Ajouter un nouveau champ",-1)),e("div",as,[p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>C.value=s),type:"text",placeholder:"Nom du champ",class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[I,C.value]]),p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>S.value=s),type:"text",placeholder:"Valeur",class:"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[I,S.value]])]),e("button",{type:"button",onClick:je,class:"w-full inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9"},[u(d(me),{class:"w-4 h-4"}),t[43]||(t[43]=e("span",null,"Ajouter",-1))])])]),e("div",ds,[e("button",{type:"button",onClick:O,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"submit",disabled:N.value,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[N.value?(l(),i("div",cs)):f("",!0),e("span",null,n(N.value?"Enregistrement...":k.value?"Modifier":"Ajouter"),1)],8,us)])],32)])])):f("",!0),X.value?(l(),i("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:H(R,["self"])},[e("div",ms,[e("div",fs,[t[45]||(t[45]=e("div",null,[e("h2",{class:"text-xl font-bold"},"Importer des contacts"),e("p",{class:"text-sm text-muted-foreground mt-1"},"Importez vos contacts depuis un fichier CSV")],-1)),e("button",{onClick:R,class:"hover:bg-accent rounded-full p-1"},[u(d(se),{class:"w-5 h-5"})])]),h.value===1?(l(),i("div",ps,[e("div",vs,[u(d(Ke),{class:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),t[46]||(t[46]=e("div",{class:"space-y-2"},[e("p",{class:"text-sm font-medium"},"Glissez-déposez votre fichier CSV ici"),e("p",{class:"text-xs text-muted-foreground"},"ou cliquez pour sélectionner un fichier")],-1)),e("input",{type:"file",accept:".csv",onChange:Se,class:"hidden",ref_key:"fileInput",ref:ge},null,544),e("button",{onClick:t[9]||(t[9]=s=>o.$refs.fileInput.click()),class:"mt-4 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Sélectionner un fichier ")]),x.value?(l(),i("div",gs,[e("div",xs,[e("div",bs,[u(d(qe),{class:"w-8 h-8 text-primary"}),e("div",null,[e("p",hs,n(x.value.name),1),e("p",ys,n((x.value.size/1024).toFixed(2))+" KB",1)])]),e("button",{onClick:t[10]||(t[10]=s=>x.value=null),class:"text-destructive hover:bg-destructive/10 rounded p-2"},[u(d(J),{class:"w-4 h-4"})])])])):f("",!0),e("div",ws,[e("div",_s,[u(d(Pe),{class:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),t[47]||(t[47]=e("div",{class:"text-sm"},[e("p",{class:"font-medium mb-2"},"Format du fichier CSV :"),e("ul",{class:"space-y-1 text-muted-foreground"},[e("li",null,"• La première ligne doit contenir les en-têtes de colonnes"),e("li",null,"• Les champs doivent être séparés par des virgules (,)"),e("li",null,"• Format recommandé : nom, email, téléphone"),e("li",null,"• Encodage UTF-8 recommandé")])],-1))])]),e("div",ks,[e("button",{onClick:R,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{onClick:Ve,disabled:!x.value||E.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[E.value?(l(),i("div",js)):f("",!0),e("span",null,n(E.value?"Analyse...":"Continuer"),1)],8,Cs)])])):f("",!0),h.value===2?(l(),i("div",$s,[e("div",As,[t[48]||(t[48]=e("p",{class:"text-sm font-medium mb-2"},"Mappage des colonnes",-1)),e("p",Ss," Associez les colonnes de votre fichier CSV aux champs du système. "+n(V.value.length)+" lignes détectées. ",1)]),e("div",Vs,[(l(!0),i(z,null,F(U.value,(s,r)=>{var M;return l(),i("div",{key:r,class:"grid grid-cols-2 gap-4 items-center"},[e("div",Es,[t[49]||(t[49]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Colonne CSV",-1)),e("p",Ms,n(s),1),e("p",Is,"Exemple: "+n(((M=V.value[0])==null?void 0:M[r])||"-"),1)]),e("div",zs,[t[51]||(t[51]=e("label",{class:"text-xs text-muted-foreground"},"Associer à",-1)),p(e("select",{"onUpdate:modelValue":Ne=>y.value[s]=Ne,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[50]||(t[50]=[e("option",{value:""},"-- Ne pas importer --",-1),e("option",{value:"name"},"Nom",-1),e("option",{value:"email"},"Email",-1),e("option",{value:"phone"},"Téléphone",-1)])],8,Fs),[[P,y.value[s]]])])])}),128))]),e("div",Ns,[e("div",Ds,[u(d(He),{class:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),t[52]||(t[52]=e("div",{class:"text-sm"},[e("p",{class:"font-medium mb-1"},"Champs obligatoires"),e("p",{class:"text-muted-foreground"},"Les champs Nom, Email et Téléphone sont obligatoires pour chaque contact.")],-1))])]),e("div",Us,[e("button",{onClick:t[11]||(t[11]=s=>h.value=1),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Retour "),e("button",{onClick:t[12]||(t[12]=s=>h.value=3),disabled:!we.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Continuer ",8,Gs)])])):f("",!0),h.value===3?(l(),i("div",Ls,[e("div",Ts,[t[53]||(t[53]=e("p",{class:"text-sm font-medium mb-2"},"Aperçu des données",-1)),e("p",qs," Vérifiez les données avant l'importation. "+n(w.value.length)+" contacts valides sur "+n(V.value.length)+". ",1)]),e("div",Bs,[e("table",Os,[t[55]||(t[55]=e("thead",{class:"border-b bg-muted/50 sticky top-0"},[e("tr",null,[e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Nom"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Email"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Téléphone"),e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground text-xs"},"Statut")])],-1)),e("tbody",null,[(l(!0),i(z,null,F(w.value.slice(0,20),(s,r)=>(l(),i("tr",{key:r,class:"border-b"},[e("td",Rs,n(s.name),1),e("td",Ks,n(s.email),1),e("td",Ps,n(s.phone),1),t[54]||(t[54]=e("td",{class:"p-3 text-sm"},[e("span",{class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold bg-success/10 text-success"}," Valide ")],-1))]))),128))])])]),w.value.length>20?(l(),i("div",Hs," ... et "+n(w.value.length-20)+" autres contacts ",1)):f("",!0),e("div",Js,[e("button",{onClick:t[13]||(t[13]=s=>h.value=2),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Retour "),e("button",{onClick:Ee,disabled:G.value||w.value.length===0,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-success text-success-foreground hover:bg-success/90 h-10 px-4 py-2"},[G.value?(l(),i("div",Ws)):(l(),te(d(pe),{key:1,class:"w-4 h-4"})),e("span",null,n(G.value?"Importation...":`Importer ${w.value.length} contacts`),1)],8,Qs)])])):f("",!0)])])):f("",!0),Y.value?(l(),i("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:H(K,["self"])},[e("div",Xs,[e("div",Ys,[e("div",Zs,[t[56]||(t[56]=e("h2",{class:"text-xl font-bold"},"Ajouter à un groupe",-1)),e("button",{onClick:K,class:"hover:bg-accent rounded-full p-1"},[u(d(se),{class:"w-5 h-5"})])]),e("p",eo,n(m.value.length)+" contact(s) sélectionné(s) ",1)]),e("div",to,[q.value.length===0?(l(),i("div",so,[u(d(fe),{class:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),t[57]||(t[57]=e("p",{class:"text-sm text-muted-foreground"},"Aucun groupe disponible",-1)),t[58]||(t[58]=e("p",{class:"text-xs text-muted-foreground mt-1"},"Créez un groupe depuis la page Groupes",-1))])):(l(),i("div",oo,[t[60]||(t[60]=e("label",{class:"text-sm font-medium"},"Sélectionner un groupe *",-1)),p(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>_.value=s),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[t[59]||(t[59]=e("option",{value:null},"-- Choisir un groupe --",-1)),(l(!0),i(z,null,F(q.value,s=>(l(),i("option",{key:s.id,value:s.id},n(s.name)+" ("+n(s.contacts_count)+" contacts) ",9,no))),128))],512),[[P,_.value]])])),e("div",lo,[e("button",{type:"button",onClick:K,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"button",onClick:Fe,disabled:!_.value||D.value||q.value.length===0,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[D.value?(l(),i("div",ro)):f("",!0),e("span",null,n(D.value?"Ajout...":"Ajouter"),1)],8,io)])])])])):f("",!0)]),_:1}))}});export{ko as default};
