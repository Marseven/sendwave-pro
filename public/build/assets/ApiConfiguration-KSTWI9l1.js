import{d as z,r as m,a as C,l as N,m as v,n as q,o as l,b as s,p as a,q as i,c as u,s as S,i as b,f as x,v as h,h as G,t as _,g as A}from"./main-QOMeYZLg.js";import{_ as L,e as w,k as O}from"./api-BdomKYOb.js";import{r as P}from"./KeyIcon-DDWUxDIt.js";import{r as M}from"./CheckCircleIcon-Ci5j4t4y.js";import{a as F,r as J}from"./XCircleIcon-D4D8hFkk.js";import{r as E,a as R,b as H,c as K}from"./SignalIcon-xbGorREd.js";import{r as Q}from"./UserIcon-B7_3Qs1s.js";import{r as W}from"./EyeIcon-CdJQ5_-h.js";import{r as X}from"./IdentificationIcon-Cl8g3Nrr.js";import{r as Y}from"./BoltIcon-H1sy8rsx.js";const Z={class:"p-8"},ee={class:"mb-8"},se={class:"flex items-center gap-2"},te={key:0,class:"flex items-center justify-center py-12"},oe={key:1,class:"max-w-5xl mx-auto space-y-6"},re={class:"rounded-lg border bg-card shadow-sm overflow-hidden"},ne={class:"p-6"},ie={class:"flex items-start justify-between mb-6"},le={class:"flex items-start gap-4"},ae={class:"flex items-center gap-3"},de={key:0,class:"px-2 py-1 rounded-full bg-success/10 text-success text-xs font-medium flex items-center gap-1"},ue={key:1,class:"px-2 py-1 rounded-full bg-muted text-muted-foreground text-xs font-medium flex items-center gap-1"},ce={class:"flex items-center gap-4 mt-3"},fe={class:"flex items-center gap-1.5 text-xs"},me={key:0,class:"pt-6 border-t space-y-6"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"space-y-2"},ve={class:"text-sm font-medium flex items-center gap-2"},be={class:"space-y-2"},xe={class:"text-sm font-medium flex items-center gap-2"},_e={class:"relative"},ye=["type"],he={class:"space-y-2"},we={class:"text-sm font-medium flex items-center gap-2"},ke={class:"space-y-2"},$e={class:"text-sm font-medium flex items-center gap-2"},Ce={class:"space-y-2"},Ae={class:"text-sm font-medium flex items-center gap-2"},Me={class:"flex gap-3"},Se=["disabled"],Pe=["disabled"],Ee={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"},Te=["disabled"],Ue={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Ve={key:0,class:"rounded-lg bg-success/10 border border-success/20 p-4"},Ie={class:"flex items-center gap-2 text-success"},je={class:"font-medium"},Be={key:1,class:"rounded-lg bg-destructive/10 border border-destructive/20 p-4"},De={class:"flex items-center gap-2 text-destructive"},ze={class:"font-medium"},We=z({__name:"ApiConfiguration",setup(Ne){const k=m(!0),g=m(["airtel"]),y=C({airtel:!1,moov:!1}),p=C({airtel:!1,moov:!1}),c=C({airtel:!1,moov:!1}),d=m(""),f=m(""),r=m({provider:"airtel",api_url:"https://messaging.airtel.ga:9002/smshttp/qs/",username:"",password:"",origin_addr:"",cost_per_sms:20,is_active:!1}),$=m({provider:"moov",api_url:"",username:"",password:"",origin_addr:"",cost_per_sms:20,is_active:!1});function T(t){const e=g.value.indexOf(t);e>-1?g.value.splice(e,1):g.value.push(t)}function U(t){y[t]=!y[t]}async function V(){k.value=!0;try{const t=await w.get("/sms-configs");(t.data.data||t.data).forEach(o=>{o.provider==="airtel"?r.value={...r.value,...o}:o.provider==="moov"&&($.value={...$.value,...o})})}catch(t){console.error("Error loading configs:",t)}finally{k.value=!1}}async function I(t){var e,o;c[t]=!0,d.value="",f.value="";try{const n=t==="airtel"?r.value:$.value;await w.put(`/sms-configs/${t}`,{api_url:n.api_url,username:n.username,password:n.password,origin_addr:n.origin_addr,cost_per_sms:n.cost_per_sms,is_active:n.is_active}),d.value=`Configuration ${t.toUpperCase()} enregistrée avec succès !`,setTimeout(()=>{d.value=""},3e3)}catch(n){console.error("Save config error:",n),f.value=((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||"Erreur lors de l'enregistrement"}finally{c[t]=!1}}async function j(t){var e,o;c[t]=!0,d.value="",f.value="";try{const n=await w.post(`/sms-configs/${t}/toggle`),D=n.data.data;t==="airtel"&&(r.value.is_active=D.is_active),d.value=n.data.message,setTimeout(()=>{d.value=""},3e3)}catch(n){console.error("Toggle error:",n),f.value=((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||"Erreur lors du changement de statut"}finally{c[t]=!1}}async function B(t){var e,o;p[t]=!0,d.value="",f.value="";try{const n=await w.post(`/sms-configs/${t}/test`,{phone_number:"+241 77 75 07 37",message:`Test API ${t.toUpperCase()} - ${new Date().toLocaleString()}`});d.value=`✓ Test réussi avec ${t.toUpperCase()} !`,setTimeout(()=>{d.value=""},3e3)}catch(n){console.error("Test error:",n),f.value=((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||`Échec du test ${t.toUpperCase()}`}finally{p[t]=!1}}return N(()=>{V()}),(t,e)=>(l(),v(L,null,{default:q(()=>[s("div",Z,[s("div",ee,[s("div",se,[a(i(P),{class:"w-8 h-8 text-primary"}),e[10]||(e[10]=s("h1",{class:"text-3xl font-bold"},"Configuration des API SMS",-1))]),e[11]||(e[11]=s("p",{class:"text-muted-foreground mt-2"},"Configurez les API des opérateurs Airtel et Moov Gabon",-1))]),k.value?(l(),u("div",te,[...e[12]||(e[12]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(l(),u("div",oe,[s("div",re,[s("div",ne,[s("div",ie,[s("div",le,[s("div",{class:S(["w-16 h-16 rounded-lg flex items-center justify-center text-2xl font-bold",r.value.is_active?"bg-red-100 text-red-600":"bg-muted text-muted-foreground"])}," AI ",2),s("div",null,[s("div",ae,[e[15]||(e[15]=s("h3",{class:"text-xl font-bold"},"Airtel Gabon",-1)),r.value.is_active?(l(),u("span",de,[a(i(M),{class:"w-3 h-3"}),e[13]||(e[13]=s("span",null,"Actif",-1))])):(l(),u("span",ue,[a(i(F),{class:"w-3 h-3"}),e[14]||(e[14]=s("span",null,"Inactif",-1))]))]),e[17]||(e[17]=s("p",{class:"text-sm text-muted-foreground mt-1"},"API SMS Airtel - Préfixes: 77, 74, 76",-1)),s("div",ce,[s("div",fe,[a(i(E),{class:"w-4 h-4 text-muted-foreground"}),e[16]||(e[16]=s("span",{class:"text-muted-foreground"},"messaging.airtel.ga",-1))])])])]),s("button",{onClick:e[0]||(e[0]=o=>T("airtel")),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:bg-accent hover:text-accent-foreground h-9 w-9"},[a(i(O),{class:S(["w-5 h-5 transition-transform",g.value.includes("airtel")?"rotate-180":""])},null,8,["class"])])]),g.value.includes("airtel")?(l(),u("div",me,[s("div",ge,[s("div",pe,[s("label",ve,[a(i(Q),{class:"w-4 h-4 text-muted-foreground"}),e[18]||(e[18]=b(" Username * ",-1))]),x(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.value.username=o),type:"text",placeholder:"Entrez le username",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[h,r.value.username]])]),s("div",be,[s("label",xe,[a(i(P),{class:"w-4 h-4 text-muted-foreground"}),e[19]||(e[19]=b(" Password * ",-1))]),s("div",_e,[x(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.password=o),type:y.airtel?"text":"password",placeholder:"Entrez le password",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 pr-10 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,ye),[[G,r.value.password]]),s("button",{onClick:e[3]||(e[3]=o=>U("airtel")),type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-accent rounded p-1"},[y.airtel?(l(),v(i(R),{key:1,class:"w-4 h-4 text-muted-foreground"})):(l(),v(i(W),{key:0,class:"w-4 h-4 text-muted-foreground"}))])])]),s("div",he,[s("label",we,[a(i(X),{class:"w-4 h-4 text-muted-foreground"}),e[20]||(e[20]=b(" Origin Address / Sender ID * ",-1))]),x(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.origin_addr=o),type:"text",placeholder:"Ex: JOBSSMS",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[h,r.value.origin_addr]])]),s("div",ke,[s("label",$e,[a(i(H),{class:"w-4 h-4 text-muted-foreground"}),e[21]||(e[21]=b(" Coût par SMS (FCFA) ",-1))]),x(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.cost_per_sms=o),type:"number",step:"1",min:"0",placeholder:"20",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[h,r.value.cost_per_sms,void 0,{number:!0}]])])]),s("div",Ce,[s("label",Ae,[a(i(E),{class:"w-4 h-4 text-muted-foreground"}),e[22]||(e[22]=b(" URL de l'API ",-1))]),x(s("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.api_url=o),type:"text",readonly:"",class:"flex h-10 w-full rounded-md border border-input bg-muted px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground"},null,512),[[h,r.value.api_url]])]),s("div",Me,[s("button",{onClick:e[7]||(e[7]=o=>j("airtel")),disabled:c.airtel,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[a(i(Y),{class:"w-4 h-4"}),s("span",null,_(r.value.is_active?"Désactiver":"Activer"),1)],8,Se),s("button",{onClick:e[8]||(e[8]=o=>B("airtel")),disabled:!r.value.username||!r.value.password||p.airtel,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[p.airtel?(l(),u("div",Ee)):(l(),v(i(K),{key:0,class:"w-4 h-4"})),s("span",null,_(p.airtel?"Test en cours...":"Tester"),1)],8,Pe),s("button",{onClick:e[9]||(e[9]=o=>I("airtel")),disabled:!r.value.username||!r.value.password||c.airtel,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[c.airtel?(l(),u("div",Ue)):(l(),v(i(M),{key:0,class:"w-4 h-4"})),s("span",null,_(c.airtel?"Enregistrement...":"Enregistrer"),1)],8,Te)])])):A("",!0)])]),e[23]||(e[23]=s("div",{class:"rounded-lg border bg-card shadow-sm overflow-hidden opacity-60"},[s("div",{class:"p-6"},[s("div",{class:"flex items-start justify-between mb-6"},[s("div",{class:"flex items-start gap-4"},[s("div",{class:"w-16 h-16 rounded-lg flex items-center justify-center text-2xl font-bold bg-muted text-muted-foreground"}," MV "),s("div",null,[s("div",{class:"flex items-center gap-3"},[s("h3",{class:"text-xl font-bold"},"Moov Gabon"),s("span",{class:"px-2 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-medium"}," Bientôt disponible ")]),s("p",{class:"text-sm text-muted-foreground mt-1"},"API SMS Moov - Préfixes: 60, 62, 65, 66"),s("p",{class:"text-xs text-muted-foreground mt-2"},"L'API Moov sera configurée dès qu'elle sera disponible")])])])])],-1)),d.value?(l(),u("div",Ve,[s("div",Ie,[a(i(M),{class:"w-5 h-5"}),s("p",je,_(d.value),1)])])):A("",!0),f.value?(l(),u("div",Be,[s("div",De,[a(i(J),{class:"w-5 h-5"}),s("p",ze,_(f.value),1)])])):A("",!0)]))])]),_:1}))}});export{We as default};
