import{o as l,c as f,b as e,d as W,u as X,r as u,k as y,m as Y,n as c,p as j,E as ee,x as a,y as r,t as i,i as v,f as b,v as k,h as N,s as $,z as se,g as P}from"./main-DYuA4yRd.js";import{_ as te,f as L,k as oe,a as re,l as ae,m as ne,n as le,i as U}from"./api-Hx4iUv-n.js";import{c as de}from"./campaignService-iIpFAm5h.js";import{c as ie}from"./contactService-Bf6so2Qd.js";import{r as Z}from"./ChevronRightIcon-cLvqOFwA.js";import{r as ue}from"./KeyIcon-COE6-Fuu.js";import{r as me}from"./IdentificationIcon-D3NHITJ0.js";import{r as ce}from"./UserIcon-Dgf2nuou.js";import{r as pe}from"./EnvelopeIcon-DYSYwUPq.js";import{r as fe}from"./PhoneIcon-DxdYmee4.js";import{r as ge}from"./ShieldCheckIcon-699nO_nc.js";import{r as ve}from"./EyeIcon-C0_WOve3.js";import{r as xe}from"./EyeSlashIcon-CPs1hDP3.js";import{r as B}from"./CheckIcon-DSX6Q0eh.js";import{r as z}from"./CheckCircleIcon-CSCdnRgE.js";import{r as be}from"./ExclamationCircleIcon-oX7LR0PJ.js";import{r as he}from"./XCircleIcon-Ph4WmBDj.js";function we(M,p){return l(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})])}function ye(M,p){return l(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})])}function _e(M,p){return l(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})])}const ke={class:"p-4 sm:p-6 lg:p-8"},$e={class:"mb-4 sm:mb-8"},Ae={class:"flex items-center gap-2"},Ce={key:0,class:"flex items-center justify-center py-12"},Se={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6"},je={class:"space-y-4 sm:space-y-6"},Me={class:"rounded-lg border bg-card p-4 sm:p-6"},Ve={class:"flex flex-col items-center text-center"},De={class:"relative mb-4"},Pe={class:"w-24 h-24 sm:w-28 sm:h-28 rounded-full bg-gradient-to-br from-primary to-primary/70 flex items-center justify-center text-primary-foreground text-3xl sm:text-4xl font-bold shadow-lg"},Ue={class:"text-xl font-bold"},Ze={class:"text-sm text-muted-foreground"},Be={class:"mt-4 flex items-center gap-2"},Ee={class:"px-3 py-1 rounded-full bg-success/10 text-success text-xs font-medium flex items-center gap-1.5"},Fe={class:"text-xs text-muted-foreground mt-3"},Ne={class:"rounded-lg border bg-card p-4 sm:p-6"},Le={class:"font-semibold text-sm mb-4 flex items-center gap-2"},ze={class:"grid grid-cols-3 gap-2"},Te={class:"text-center p-3 rounded-lg bg-muted/50"},Ie={class:"text-lg sm:text-xl font-bold text-primary"},Re={class:"text-center p-3 rounded-lg bg-muted/50"},qe={class:"text-lg sm:text-xl font-bold text-primary"},Ge={class:"text-center p-3 rounded-lg bg-muted/50"},He={class:"text-lg sm:text-xl font-bold text-primary"},Je={class:"rounded-lg border bg-card p-4 sm:p-6"},Ke={class:"space-y-2"},Oe={class:"lg:col-span-2 space-y-4 sm:space-y-6"},Qe={class:"rounded-lg border bg-card p-4 sm:p-6"},We={class:"flex items-center gap-2 mb-4 sm:mb-6 pb-4 border-b"},Xe={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ye={class:"space-y-2"},es={class:"text-sm font-medium flex items-center gap-2"},ss={class:"space-y-2"},ts={class:"text-sm font-medium flex items-center gap-2"},os={class:"space-y-2"},rs={class:"text-sm font-medium flex items-center gap-2"},as={class:"space-y-2"},ns={class:"text-sm font-medium flex items-center gap-2"},ls={class:"space-y-2 sm:col-span-2"},ds={class:"text-sm font-medium flex items-center gap-2"},is={class:"rounded-lg border bg-card p-4 sm:p-6"},us={class:"flex items-center gap-2 mb-4 sm:mb-6 pb-4 border-b"},ms={class:"mb-6"},cs={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ps={class:"space-y-2"},fs={class:"relative"},gs=["type"],vs={class:"space-y-2"},xs=["type"],bs={key:0,class:"mb-6 p-4 rounded-lg bg-muted/50"},hs={class:"flex items-center justify-between mb-2"},ws={class:"h-2 bg-muted rounded-full overflow-hidden"},ys={class:"mt-3 space-y-1 text-xs text-muted-foreground"},_s={class:"p-4 rounded-lg border bg-muted/30"},ks={class:"space-y-2 text-sm"},$s={class:"flex justify-between"},As={class:"flex justify-between"},Cs={class:"font-mono text-xs"},Ss={key:0,class:"rounded-lg bg-success/10 border border-success/20 p-4"},js={class:"flex items-center gap-2 text-success"},Ms={class:"font-medium"},Vs={key:1,class:"rounded-lg bg-destructive/10 border border-destructive/20 p-4"},Ds={class:"flex items-center gap-2 text-destructive"},Ps={class:"font-medium"},Us={class:"flex flex-col sm:flex-row gap-2 sm:gap-3"},Zs=["disabled"],Bs={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Es=["disabled"],et=W({__name:"Profile",setup(M){const p=X(),V=u(!0),g=u(!1),h=u(""),x=u(""),_=u(!1),T=u(!1),t=u({name:"",email:"",phone:"",company:"",address:"",password:"",password_confirmation:""}),A=u({...t.value}),w=u({campaigns:0,messagesSent:0,contacts:0}),D=u("Aujourd'hui à 10:30"),E=u("192.168.1.xxx"),F=u("Janvier 2026"),I=y(()=>t.value.name?t.value.name.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2):"?"),C=y(()=>{const o=t.value.password;if(!o)return 0;let s=0;return o.length>=8&&(s+=1),o.length>=12&&(s+=1),/[A-Z]/.test(o)&&(s+=1),/[a-z]/.test(o)&&(s+=1),/[0-9]/.test(o)&&(s+=1),/[^A-Za-z0-9]/.test(o)&&(s+=1),s}),R=y(()=>C.value/6*100),q=y(()=>{const o=C.value;return o<=2?"Faible":o<=4?"Moyen":"Fort"}),G=y(()=>{const o=C.value;return o<=2?"text-destructive":o<=4?"text-warning":"text-success"}),H=y(()=>{const o=C.value;return o<=2?"bg-destructive":o<=4?"bg-warning":"bg-success"});function J(o){return o>=1e3?(o/1e3).toFixed(1)+"k":o.toString()}async function K(){V.value=!0;try{const o=await L.get("/user/profile"),s=o.data.data||o.data;if(t.value={name:s.name||"",email:s.email||"",phone:s.phone||"",company:s.company||"",address:s.address||"",password:"",password_confirmation:""},A.value={...t.value},s.created_at){const m=new Date(s.created_at);F.value=m.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}if(s.last_login_at){const m=new Date(s.last_login_at),S=new Date;m.toDateString()===S.toDateString()?D.value=`Aujourd'hui à ${m.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}`:D.value=m.toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}s.last_login_ip&&(E.value=s.last_login_ip);const[d,n]=await Promise.all([de.getAll(),ie.getAll()]);w.value.campaigns=d.length,w.value.contacts=n.length,w.value.messagesSent=d.reduce((m,S)=>m+(S.messages_sent||S.sent||0),0)}catch(o){console.error("Error loading profile:",o),p.user&&(t.value.name=p.user.name||"",t.value.email=p.user.email||"",A.value={...t.value})}finally{V.value=!1}}async function O(){var o,s;g.value=!0,h.value="",x.value="";try{if(t.value.password){if(t.value.password!==t.value.password_confirmation){x.value="Les mots de passe ne correspondent pas",g.value=!1;return}if(t.value.password.length<8){x.value="Le mot de passe doit contenir au moins 8 caractères",g.value=!1;return}}const d={name:t.value.name,email:t.value.email,phone:t.value.phone,company:t.value.company,address:t.value.address};t.value.password&&(d.password=t.value.password,d.password_confirmation=t.value.password_confirmation);const n=await L.put("/user/profile",d),m=n.data.data||n.data;p.user&&(p.user.name=m.name,p.user.email=m.email),t.value.password="",t.value.password_confirmation="",A.value={...t.value},h.value="Profil mis à jour avec succès",setTimeout(()=>{h.value=""},3e3)}catch(d){console.error("Error saving profile:",d),x.value=((s=(o=d.response)==null?void 0:o.data)==null?void 0:s.message)||"Erreur lors de la mise à jour du profil"}finally{g.value=!1}}function Q(){t.value={...A.value},h.value="",x.value=""}return Y(()=>{K()}),(o,s)=>{const d=ee("router-link");return l(),c(te,null,{default:j(()=>[e("div",ke,[e("div",$e,[e("div",Ae,[a(r(oe),{class:"w-6 h-6 sm:w-8 sm:h-8 text-primary"}),s[9]||(s[9]=e("h1",{class:"text-2xl sm:text-3xl font-bold"},"Mon Profil",-1))]),s[10]||(s[10]=e("p",{class:"text-sm text-muted-foreground mt-1 sm:mt-2"},"Gérez vos informations personnelles et votre sécurité",-1))]),V.value?(l(),f("div",Ce,[...s[11]||(s[11]=[e("div",{class:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-primary"},null,-1)])])):(l(),f("div",Se,[e("div",je,[e("div",Me,[e("div",Ve,[e("div",De,[e("div",Pe,i(I.value),1),e("button",{onClick:s[0]||(s[0]=n=>T.value=!0),class:"absolute bottom-0 right-0 w-8 h-8 rounded-full bg-background border-2 border-primary flex items-center justify-center hover:bg-accent transition-colors shadow-md"},[a(r(we),{class:"w-4 h-4 text-primary"})])]),e("h2",Ue,i(t.value.name||"Utilisateur"),1),e("p",Ze,i(t.value.email),1),e("div",Be,[e("span",Ee,[a(r(ye),{class:"w-4 h-4"}),s[12]||(s[12]=e("span",null,"Compte actif",-1))])]),e("p",Fe," Membre depuis "+i(F.value),1)])]),e("div",Ne,[e("h3",Le,[a(r(re),{class:"w-5 h-5 text-primary"}),s[13]||(s[13]=e("span",null,"Activité",-1))]),e("div",ze,[e("div",Te,[e("p",Ie,i(w.value.campaigns),1),s[14]||(s[14]=e("p",{class:"text-xs text-muted-foreground"},"Campagnes",-1))]),e("div",Re,[e("p",qe,i(J(w.value.messagesSent)),1),s[15]||(s[15]=e("p",{class:"text-xs text-muted-foreground"},"Messages",-1))]),e("div",Ge,[e("p",He,i(w.value.contacts),1),s[16]||(s[16]=e("p",{class:"text-xs text-muted-foreground"},"Contacts",-1))])])]),e("div",Je,[s[20]||(s[20]=e("h3",{class:"font-semibold text-sm mb-4"},"Actions rapides",-1)),e("div",Ke,[a(d,{to:"/settings",class:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/50 transition-colors"},{default:j(()=>[a(r(ae),{class:"w-5 h-5 text-muted-foreground"}),s[17]||(s[17]=e("span",{class:"text-sm"},"Paramètres plateforme",-1)),a(r(Z),{class:"w-4 h-4 text-muted-foreground ml-auto"})]),_:1}),a(d,{to:"/api-configuration",class:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/50 transition-colors"},{default:j(()=>[a(r(ue),{class:"w-5 h-5 text-muted-foreground"}),s[18]||(s[18]=e("span",{class:"text-sm"},"Clés API",-1)),a(r(Z),{class:"w-4 h-4 text-muted-foreground ml-auto"})]),_:1}),a(d,{to:"/audit-logs",class:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/50 transition-colors"},{default:j(()=>[a(r(ne),{class:"w-5 h-5 text-muted-foreground"}),s[19]||(s[19]=e("span",{class:"text-sm"},"Historique d'activité",-1)),a(r(Z),{class:"w-4 h-4 text-muted-foreground ml-auto"})]),_:1})])])]),e("div",Oe,[e("div",Qe,[e("div",We,[a(r(me),{class:"w-5 h-5 text-primary"}),s[21]||(s[21]=e("h3",{class:"font-semibold"},"Informations personnelles",-1))]),e("div",Xe,[e("div",Ye,[e("label",es,[a(r(ce),{class:"w-4 h-4 text-muted-foreground"}),s[22]||(s[22]=v(" Nom complet ",-1))]),b(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t.value.name=n),type:"text",placeholder:"Votre nom complet",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary"},null,512),[[k,t.value.name]])]),e("div",ss,[e("label",ts,[a(r(pe),{class:"w-4 h-4 text-muted-foreground"}),s[23]||(s[23]=v(" Adresse email ",-1))]),b(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>t.value.email=n),type:"email",placeholder:"votre@email.com",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary"},null,512),[[k,t.value.email]])]),e("div",os,[e("label",rs,[a(r(fe),{class:"w-4 h-4 text-muted-foreground"}),s[24]||(s[24]=v(" Téléphone ",-1))]),b(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>t.value.phone=n),type:"tel",placeholder:"+241 77 00 00 00",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary"},null,512),[[k,t.value.phone]])]),e("div",as,[e("label",ns,[a(r(le),{class:"w-4 h-4 text-muted-foreground"}),s[25]||(s[25]=v(" Entreprise ",-1))]),b(e("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>t.value.company=n),type:"text",placeholder:"Nom de votre entreprise",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary"},null,512),[[k,t.value.company]])]),e("div",ls,[e("label",ds,[a(r(_e),{class:"w-4 h-4 text-muted-foreground"}),s[26]||(s[26]=v(" Adresse ",-1))]),b(e("input",{"onUpdate:modelValue":s[5]||(s[5]=n=>t.value.address=n),type:"text",placeholder:"Ville, Pays",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary"},null,512),[[k,t.value.address]])])])]),e("div",is,[e("div",us,[a(r(ge),{class:"w-5 h-5 text-primary"}),s[27]||(s[27]=e("h3",{class:"font-semibold"},"Sécurité du compte",-1))]),e("div",ms,[s[30]||(s[30]=e("h4",{class:"text-sm font-medium mb-4"},"Changer le mot de passe",-1)),e("div",cs,[e("div",ps,[s[28]||(s[28]=e("label",{class:"text-sm font-medium"},"Nouveau mot de passe",-1)),e("div",fs,[b(e("input",{"onUpdate:modelValue":s[6]||(s[6]=n=>t.value.password=n),type:_.value?"text":"password",placeholder:"••••••••",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 pr-10 text-sm focus:ring-2 focus:ring-primary"},null,8,gs),[[N,t.value.password]]),e("button",{type:"button",onClick:s[7]||(s[7]=n=>_.value=!_.value),class:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground"},[_.value?(l(),c(r(xe),{key:1,class:"w-4 h-4"})):(l(),c(r(ve),{key:0,class:"w-4 h-4"}))])])]),e("div",vs,[s[29]||(s[29]=e("label",{class:"text-sm font-medium"},"Confirmer le mot de passe",-1)),b(e("input",{"onUpdate:modelValue":s[8]||(s[8]=n=>t.value.password_confirmation=n),type:_.value?"text":"password",placeholder:"••••••••",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-primary"},null,8,xs),[[N,t.value.password_confirmation]])])]),s[31]||(s[31]=e("p",{class:"text-xs text-muted-foreground mt-2"},"Laisser vide pour conserver le mot de passe actuel",-1))]),t.value.password?(l(),f("div",bs,[e("div",hs,[s[32]||(s[32]=e("span",{class:"text-sm font-medium"},"Force du mot de passe",-1)),e("span",{class:$(["text-xs",G.value])},i(q.value),3)]),e("div",ws,[e("div",{class:$(["h-full transition-all duration-300",H.value]),style:se({width:R.value+"%"})},null,6)]),e("ul",ys,[e("li",{class:$({"text-success":t.value.password.length>=8})},[t.value.password.length>=8?(l(),c(r(B),{key:0,class:"w-3 h-3 inline mr-1"})):(l(),c(r(U),{key:1,class:"w-3 h-3 inline mr-1"})),s[33]||(s[33]=v(" Au moins 8 caractères ",-1))],2),e("li",{class:$({"text-success":/[A-Z]/.test(t.value.password)})},[/[A-Z]/.test(t.value.password)?(l(),c(r(B),{key:0,class:"w-3 h-3 inline mr-1"})):(l(),c(r(U),{key:1,class:"w-3 h-3 inline mr-1"})),s[34]||(s[34]=v(" Une majuscule ",-1))],2),e("li",{class:$({"text-success":/[0-9]/.test(t.value.password)})},[/[0-9]/.test(t.value.password)?(l(),c(r(B),{key:0,class:"w-3 h-3 inline mr-1"})):(l(),c(r(U),{key:1,class:"w-3 h-3 inline mr-1"})),s[35]||(s[35]=v(" Un chiffre ",-1))],2)])])):P("",!0),e("div",_s,[s[38]||(s[38]=e("h4",{class:"text-sm font-medium mb-3"},"Dernière activité",-1)),e("div",ks,[e("div",$s,[s[36]||(s[36]=e("span",{class:"text-muted-foreground"},"Dernière connexion",-1)),e("span",null,i(D.value),1)]),e("div",As,[s[37]||(s[37]=e("span",{class:"text-muted-foreground"},"Adresse IP",-1)),e("span",Cs,i(E.value),1)])])])]),h.value?(l(),f("div",Ss,[e("div",js,[a(r(z),{class:"w-5 h-5"}),e("p",Ms,i(h.value),1)])])):P("",!0),x.value?(l(),f("div",Vs,[e("div",Ds,[a(r(be),{class:"w-5 h-5"}),e("p",Ps,i(x.value),1)])])):P("",!0),e("div",Us,[e("button",{onClick:O,disabled:g.value,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6 py-2 disabled:opacity-50"},[g.value?(l(),f("div",Bs)):(l(),c(r(z),{key:0,class:"w-4 h-4"})),e("span",null,i(g.value?"Enregistrement...":"Enregistrer les modifications"),1)],8,Zs),e("button",{onClick:Q,disabled:g.value,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium border border-input bg-background hover:bg-accent h-10 px-4 py-2"},[a(r(he),{class:"w-4 h-4"}),s[39]||(s[39]=e("span",null,"Annuler",-1))],8,Es)])])]))])]),_:1})}}});export{et as default};
