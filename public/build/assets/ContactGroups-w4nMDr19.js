import{d as P,r as l,m as H,n as J,p as K,o as r,b as e,x as a,y as c,c as i,F,q as z,t as d,g as w,w as V,f as A,v as D}from"./main-BAUGSWmL.js";import{_ as Q,f as v,l as W,c as N,h as B}from"./api-Bi1oEWwk.js";import{b as x,a as _,s as S}from"./notifications-CHQAjgV4.js";import{r as X}from"./UserGroupIcon-ClWVLzWy.js";import{r as Y}from"./EyeIcon-B1MRx2jX.js";import{r as Z}from"./PencilIcon-Da2WSkz7.js";import{r as ee}from"./TrashIcon-C_C2nzcI.js";import{r as se}from"./UserIcon-B2UyG3wL.js";const te={class:"p-8"},oe={class:"mb-8 flex items-center justify-between"},ne={key:0,class:"flex items-center justify-center py-12"},re={key:1,class:"flex flex-col items-center justify-center py-12 rounded-lg border bg-card"},ie={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},le={class:"p-6"},ae={class:"flex items-start justify-between mb-4"},ce={class:"flex-1"},de={class:"font-semibold text-lg"},ue={key:0,class:"text-sm text-muted-foreground mt-1 line-clamp-2"},fe={class:"flex items-center gap-2 text-sm text-muted-foreground mb-4"},me={class:"text-xs text-muted-foreground"},pe={class:"border-t p-4 bg-muted/30 flex gap-2"},ve=["onClick"],ge=["onClick"],be=["onClick"],xe={class:"bg-background rounded-lg shadow-lg w-full max-w-lg"},he={class:"border-b p-6"},ye={class:"flex items-center justify-between"},we={class:"text-xl font-bold"},_e={class:"space-y-2"},ke={class:"space-y-2"},Ce={class:"flex gap-3 pt-4 border-t"},je=["disabled"],$e={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Ge={class:"bg-background rounded-lg shadow-lg w-full max-w-3xl max-h-[90vh] flex flex-col"},Me={class:"border-b p-6"},Ee={class:"flex items-center justify-between"},Ve={class:"text-xl font-bold"},Fe={class:"text-sm text-muted-foreground mt-1"},ze={class:"flex-1 overflow-y-auto p-6"},Ae={key:0,class:"flex items-center justify-center py-12"},De={key:1,class:"flex flex-col items-center justify-center py-12"},Ne={key:2,class:"space-y-2"},Be={class:"flex items-center gap-3"},Se={class:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center"},Re={class:"font-medium"},qe={class:"text-sm text-muted-foreground"},Le=["onClick"],We=P({__name:"ContactGroups",setup(Te){const k=l([]),m=l([]),C=l(!1),j=l(!1),g=l(!1),$=l(!1),G=l(!1),M=l(!1),p=l(null),b=l(null),f=l({name:"",description:""});async function h(){var o,s;C.value=!0;try{const n=await v.get("/contact-groups");k.value=n.data.data}catch(n){x(((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"Erreur lors du chargement")}finally{C.value=!1}}function R(){p.value=null,f.value={name:"",description:""},$.value=!0}function q(o){p.value=o,f.value={name:o.name,description:o.description||""},G.value=!0}function y(){$.value=!1,G.value=!1,p.value=null}async function L(){var o,s;g.value=!0;try{p.value?(await v.put(`/contact-groups/${p.value.id}`,f.value),_("Groupe modifié avec succès")):(await v.post("/contact-groups",f.value),_("Groupe créé avec succès")),y(),await h()}catch(n){x(((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"Erreur lors de l'enregistrement")}finally{g.value=!1}}async function T(o){var n,t;if(await S("Supprimer le groupe ?",`Êtes-vous sûr de vouloir supprimer "${o.name}" ? Les contacts ne seront pas supprimés.`))try{await v.delete(`/contact-groups/${o.id}`),_("Groupe supprimé avec succès"),await h()}catch(u){x(((t=(n=u.response)==null?void 0:n.data)==null?void 0:t.message)||"Erreur lors de la suppression")}}async function U(o){var s,n;b.value=o,M.value=!0,j.value=!0;try{const t=await v.get(`/contact-groups/${o.id}/contacts`);m.value=t.data.data}catch(t){x(((n=(s=t.response)==null?void 0:s.data)==null?void 0:n.message)||"Erreur lors du chargement des contacts")}finally{j.value=!1}}function E(){M.value=!1,b.value=null,m.value=[]}async function I(o){var n,t;if(!b.value)return;if(await S("Retirer du groupe ?","Voulez-vous retirer ce contact du groupe ?"))try{await v.post(`/contact-groups/${b.value.id}/contacts/remove`,{contact_ids:[o]}),_("Contact retiré du groupe"),m.value=m.value.filter(u=>u.id!==o),await h()}catch(u){x(((t=(n=u.response)==null?void 0:n.data)==null?void 0:t.message)||"Erreur lors du retrait")}}function O(o){const s=new Date(o);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(s)}return H(()=>{h()}),(o,s)=>(r(),J(Q,null,{default:K(()=>{var n;return[e("div",te,[e("div",oe,[s[3]||(s[3]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Groupes de Contacts"),e("p",{class:"text-muted-foreground mt-2"},"Organisez vos contacts en groupes pour faciliter les envois")],-1)),e("button",{onClick:R,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[a(c(W),{class:"w-4 h-4"}),s[2]||(s[2]=e("span",null,"Nouveau groupe",-1))])]),C.value?(r(),i("div",ne,[...s[4]||(s[4]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):k.value.length===0?(r(),i("div",re,[a(c(X),{class:"w-16 h-16 text-muted-foreground mb-4"}),s[5]||(s[5]=e("p",{class:"text-lg font-medium"},"Aucun groupe trouvé",-1)),s[6]||(s[6]=e("p",{class:"text-sm text-muted-foreground mt-1"},"Créez des groupes pour organiser vos contacts",-1))])):(r(),i("div",ie,[(r(!0),i(F,null,z(k.value,t=>(r(),i("div",{key:t.id,class:"rounded-lg border bg-card shadow-sm hover:shadow-md transition-shadow"},[e("div",le,[e("div",ae,[e("div",ce,[e("h3",de,d(t.name),1),t.description?(r(),i("p",ue,d(t.description),1)):w("",!0)])]),e("div",fe,[a(c(N),{class:"w-4 h-4"}),e("span",null,d(t.contacts_count||0)+" contact(s)",1)]),e("div",me," Créé le "+d(O(t.created_at)),1)]),e("div",pe,[e("button",{onClick:u=>U(t),class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9"},[a(c(Y),{class:"w-4 h-4"}),s[7]||(s[7]=e("span",null,"Voir",-1))],8,ve),e("button",{onClick:u=>q(t),class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3"},[a(c(Z),{class:"w-4 h-4"})],8,ge),e("button",{onClick:u=>T(t),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:bg-destructive/10 hover:text-destructive h-9 w-9"},[a(c(ee),{class:"w-4 h-4"})],8,be)])]))),128))]))]),$.value||G.value?(r(),i("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:V(y,["self"])},[e("div",xe,[e("div",he,[e("div",ye,[e("h2",we,d(p.value?"Modifier le groupe":"Nouveau groupe"),1),e("button",{onClick:y,class:"hover:bg-accent rounded-full p-1"},[a(c(B),{class:"w-5 h-5"})])])]),e("form",{onSubmit:V(L,["prevent"]),class:"p-6 space-y-4"},[e("div",_e,[s[8]||(s[8]=e("label",{class:"text-sm font-medium"},"Nom du groupe *",-1)),A(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>f.value.name=t),type:"text",required:"",placeholder:"Clients VIP",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[D,f.value.name]])]),e("div",ke,[s[9]||(s[9]=e("label",{class:"text-sm font-medium"},"Description",-1)),A(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=t=>f.value.description=t),rows:"3",placeholder:"Groupe de clients fidèles...",class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[D,f.value.description]])]),e("div",Ce,[e("button",{type:"button",onClick:y,class:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Annuler "),e("button",{type:"submit",disabled:g.value,class:"flex-1 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[g.value?(r(),i("div",$e)):w("",!0),e("span",null,d(g.value?"Enregistrement...":p.value?"Modifier":"Créer"),1)],8,je)])],32)])])):w("",!0),M.value?(r(),i("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:V(E,["self"])},[e("div",Ge,[e("div",Me,[e("div",Ee,[e("div",null,[e("h2",Ve,d((n=b.value)==null?void 0:n.name),1),e("p",Fe,d(m.value.length)+" contact(s) ",1)]),e("button",{onClick:E,class:"hover:bg-accent rounded-full p-1"},[a(c(B),{class:"w-5 h-5"})])])]),e("div",ze,[j.value?(r(),i("div",Ae,[...s[10]||(s[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):m.value.length===0?(r(),i("div",De,[a(c(N),{class:"w-16 h-16 text-muted-foreground mb-4"}),s[11]||(s[11]=e("p",{class:"text-lg font-medium"},"Aucun contact dans ce groupe",-1)),s[12]||(s[12]=e("p",{class:"text-sm text-muted-foreground mt-1"},"Ajoutez des contacts depuis la page Contacts",-1))])):(r(),i("div",Ne,[(r(!0),i(F,null,z(m.value,t=>(r(),i("div",{key:t.id,class:"flex items-center justify-between p-4 rounded-lg border bg-card hover:bg-accent transition-colors"},[e("div",Be,[e("div",Se,[a(c(se),{class:"w-5 h-5 text-primary"})]),e("div",null,[e("p",Re,d(t.name),1),e("p",qe,d(t.phone),1)])]),e("button",{onClick:u=>I(t.id),class:"text-sm text-destructive hover:underline"}," Retirer ",8,Le)]))),128))]))]),e("div",{class:"border-t p-6"},[e("button",{onClick:E,class:"w-full inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Fermer ")])])])):w("",!0)]}),_:1}))}});export{We as default};
