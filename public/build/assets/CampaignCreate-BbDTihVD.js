import{o,c as r,b as e,d as ie,r as _,k as S,l as ue,m as de,n as w,p as me,j as ce,G as pe,z as ve,q as k,s as y,y as d,t as a,F as h,f as m,B as M,x as p,v as T,D as R,C as V,g as i,i as G}from"./main-CoMFIvfW.js";import{_ as fe,q as H,o as ge,c as L,e as be}from"./api-3wTZrCQg.js";import{c as U}from"./campaignService-kNwbFMIN.js";import{t as xe}from"./templateService-B9-1XazM.js";import{c as ye}from"./contactService-BNq54hTY.js";import{a as $,b as q,s as he}from"./notifications-CHQAjgV4.js";import{r as J}from"./CheckCircleIcon-vno-DY-t.js";import{r as Q}from"./BoltIcon-CBVQ04uA.js";import{r as ke}from"./ExclamationTriangleIcon-BzBEzsm_.js";import{r as X}from"./BeakerIcon-DKO4VG55.js";import{r as _e}from"./TrashIcon-BkQo47gf.js";import{r as Z}from"./TagIcon--qU3cL6s.js";import{r as we}from"./ArrowPathIcon-CYgyKifV.js";import{r as Te}from"./RocketLaunchIcon-CuqsqlYP.js";function Se(K,I){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}const Ce={class:"p-4 sm:p-6 lg:p-8"},De={class:"mb-6 sm:mb-10"},Me={class:"max-w-4xl mx-auto"},Ve={class:"relative flex items-center justify-between"},$e={key:1},qe={class:"max-w-3xl mx-auto"},Ae={class:"rounded-lg border bg-card shadow-sm p-4 sm:p-6 lg:p-8"},Be={key:0,class:"space-y-6"},Re={class:"space-y-4"},Ue={class:"space-y-4 mt-6"},Ie={class:"space-y-2"},je={class:"space-y-2"},Ee={key:0,class:"space-y-4 p-3 sm:p-4 bg-muted/50 rounded-lg"},Pe={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4"},ze={class:"space-y-2"},Ne=["min"],Fe={class:"space-y-2"},Oe={class:"space-y-3 pt-3 border-t border-border"},Ge={class:"flex items-center gap-2"},He={key:0,class:"space-y-3 pl-6"},Le={class:"space-y-2"},Je={key:0,class:"space-y-2"},Qe={class:"flex flex-wrap gap-2"},Xe=["value"],Ze={class:"text-sm"},Ke={key:1,class:"space-y-2"},We=["value"],Ye={class:"space-y-2"},es=["min"],ss={key:1,class:"space-y-6"},ts={class:"space-y-2"},ns=["value"],os={class:"space-y-2"},as={class:"flex items-center justify-between"},rs={class:"flex items-center gap-3 text-xs"},ls={class:"text-muted-foreground"},is={key:0,class:"px-2 py-1 bg-warning/10 text-warning rounded font-medium"},us={key:0,class:"flex items-center gap-1.5 text-xs text-warning"},ds={class:"p-4 bg-muted/50 rounded-lg"},ms={class:"flex flex-wrap gap-2"},cs=["onClick"],ps={class:"space-y-3 pt-4 border-t"},vs={class:"flex items-center justify-between"},fs={class:"flex items-center gap-2"},gs={key:0,class:"space-y-4 pl-6"},bs={class:"flex items-center justify-between"},xs={class:"text-sm font-medium"},ys=["onClick"],hs=["onUpdate:modelValue","placeholder"],ks={class:"flex justify-between text-xs text-muted-foreground"},_s={key:2,class:"space-y-6"},ws={class:"space-y-3"},Ts={class:"flex-1"},Ss={class:"text-sm text-muted-foreground mt-1"},Cs={key:0,class:"space-y-2 p-4 bg-muted/50 rounded-lg"},Ds=["value"],Ms={class:"p-4 sm:p-5 bg-gradient-to-r from-primary/10 to-primary/5 border-2 border-primary/20 rounded-lg"},Vs={class:"flex items-start gap-3 sm:gap-4"},$s={class:"flex-1"},qs={class:"grid grid-cols-2 gap-3 sm:gap-4 text-sm"},As={class:"text-xl sm:text-2xl font-bold text-foreground"},Bs={class:"text-xl sm:text-2xl font-bold text-foreground"},Rs={class:"text-xl sm:text-2xl font-bold text-primary"},Us={key:3,class:"space-y-6"},Is={class:"space-y-4"},js={class:"p-4 bg-muted/30 rounded-lg space-y-3"},Es={class:"text-base font-semibold flex items-center gap-2"},Ps={key:0,class:"text-sm text-muted-foreground"},zs={key:1,class:"text-sm text-muted-foreground"},Ns={key:0},Fs={key:1},Os={key:2,class:"text-sm text-muted-foreground"},Gs={class:"p-4 bg-muted/30 rounded-lg space-y-2"},Hs={class:"text-base font-semibold"},Ls={key:0,class:"text-sm text-muted-foreground"},Js={class:"p-4 bg-muted/30 rounded-lg space-y-2"},Qs={class:"p-3 bg-background rounded border font-mono text-sm whitespace-pre-wrap"},Xs={class:"text-xs text-muted-foreground"},Zs={key:0,class:"p-4 bg-muted/30 rounded-lg space-y-3"},Ks={class:"text-xs text-muted-foreground uppercase flex items-center gap-2"},Ws={class:"space-y-2"},Ys={class:"text-xs font-medium text-primary mb-1"},et={class:"font-mono text-sm whitespace-pre-wrap"},st={class:"p-4 bg-muted/30 rounded-lg space-y-2"},tt={class:"text-base font-semibold flex items-center gap-2"},nt={key:0,class:"text-sm text-muted-foreground"},ot={class:"text-sm text-primary font-medium"},at={class:"p-5 bg-gradient-to-r from-success/20 to-success/10 border-2 border-success/30 rounded-lg"},rt={class:"flex items-center justify-between"},lt={class:"text-3xl font-bold text-success"},it={class:"text-xs text-muted-foreground mt-1"},ut={class:"flex flex-col sm:flex-row justify-between gap-3 mt-6 sm:mt-8 pt-4 sm:pt-6 border-t"},dt=["disabled"],mt={key:1,class:"hidden sm:block"},ct={class:"flex flex-col sm:flex-row gap-2 sm:gap-3 order-1 sm:order-2"},pt=["disabled"],vt=["disabled"],ft=["disabled"],gt={key:0},bt={class:"hidden sm:inline"},xt={class:"sm:hidden"},Bt=ie({__name:"CampaignCreate",setup(K){const I=ce(),j=pe(),C=["Type d'envoi","Message","Destinataires","Récapitulatif"],c=_(0),E=_(!1),f=_(!1),W=["{{name}}","{{email}}","{{phone}}","{{code}}"],A=_([]),P=_([]),D=_([]),z=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],Y=S(()=>new Date().toISOString().split("T")[0]),s=_({name:"",description:"",sendType:"immediate",sendDate:"",sendTime:"09:00",templateId:"",message:"",recipientType:"all",groupId:"",isRecurring:!1,frequency:"weekly",weekDays:[1,2,3,4,5],dayOfMonth:1,endDate:"",enableABTest:!1,variants:[{message:""},{message:""}]}),N=S(()=>s.value.message.length),v=S(()=>Math.ceil(s.value.message.length/160)),B=S(()=>P.value.filter(l=>l.status==="active").length),x=S(()=>{if(s.value.recipientType==="all")return B.value;if(s.value.recipientType==="group"){const l=D.value.find(t=>t.id===s.value.groupId);return(l==null?void 0:l.contact_count)||0}return 0}),F=S(()=>Math.round(x.value*v.value*20));async function ee(){E.value=!0;try{const[l,t]=await Promise.all([xe.getAll(),ye.getAll()]);if(A.value=l.filter(g=>g.status==="active"),P.value=t,D.value=[{id:"1",name:"Clients VIP",contact_count:234},{id:"2",name:"Nouveaux clients",contact_count:156},{id:"3",name:"Région Paris",contact_count:445}],j.query.templateId){const g=j.query.templateId.toString();s.value.templateId=g,O(g)}}catch(l){console.error("Error loading data:",l)}finally{E.value=!1}}function O(l){const t=A.value.find(g=>g.id.toString()===l);t&&(s.value.message=t.message)}ue(()=>s.value.templateId,l=>{l&&O(l)});function se(l){s.value.message+=l}function te(){s.value.variants.length<4&&s.value.variants.push({message:""})}function ne(l){s.value.variants.length>2&&s.value.variants.splice(l,1)}async function oe(){f.value=!0;try{const l={name:s.value.name||"Brouillon",description:s.value.description,message:s.value.message,status:"draft",recipient_type:s.value.recipientType,group_id:s.value.groupId||null,scheduled_at:s.value.sendType==="scheduled"&&s.value.sendDate?`${s.value.sendDate} ${s.value.sendTime||"09:00"}`:null};await U.create(l),$("Brouillon sauvegardé avec succès !")}catch(l){q(l.message||"Erreur lors de la sauvegarde")}finally{f.value=!1}}async function ae(){if(!s.value.name){q("Veuillez donner un nom à la campagne");return}if(!s.value.message){q("Veuillez saisir un message");return}let l="";s.value.sendType==="immediate"?l=`Envoyer immédiatement ${x.value} SMS ?`:s.value.isRecurring?l=`Planifier une campagne ${{daily:"quotidienne",weekly:"hebdomadaire",monthly:"mensuelle"}[s.value.frequency]} à partir du ${s.value.sendDate} à ${s.value.sendTime} ?`:l=`Planifier l'envoi de ${x.value} SMS pour le ${s.value.sendDate} à ${s.value.sendTime} ?`;const t=s.value.sendType==="immediate"?"Envoyer maintenant":"Planifier la campagne";if(await he(t,l)){f.value=!0;try{const n={name:s.value.name,description:s.value.description,message:s.value.message,status:s.value.sendType==="immediate"?"sending":"scheduled",recipient_type:s.value.recipientType,group_id:s.value.groupId||null,scheduled_at:s.value.sendType==="scheduled"&&s.value.sendDate?`${s.value.sendDate} ${s.value.sendTime||"09:00"}`:null,messages_sent:s.value.sendType==="immediate"?x.value:0,ab_testing_enabled:s.value.enableABTest,variants:s.value.enableABTest?s.value.variants.filter(b=>b.message.trim()).map((b,le)=>({name:`Variante ${String.fromCharCode(65+le)}`,message:b.message})):null},u=await U.create(n);if(s.value.sendType==="scheduled"&&s.value.isRecurring&&u.id){const b={frequency:s.value.frequency,time:s.value.sendTime,days_of_week:s.value.frequency==="weekly"?s.value.weekDays:null,day_of_month:s.value.frequency==="monthly"?s.value.dayOfMonth:null,start_date:s.value.sendDate,end_date:s.value.endDate||null};await U.createSchedule(u.id,b)}s.value.sendType==="immediate"?$(`${x.value} SMS envoyés avec succès !`):s.value.isRecurring?$("Campagne récurrente planifiée avec succès !"):$("Campagne planifiée avec succès !"),I.push("/dashboard")}catch(n){q(n.message||"Erreur lors du lancement")}finally{f.value=!1}}}function re(){return c.value===0?s.value.sendType==="immediate"||!!s.value.sendDate&&!!s.value.sendTime:c.value===1?s.value.enableABTest?s.value.variants.every(l=>l.message.trim().length>0):s.value.message.length>0:c.value===2?s.value.recipientType==="all"||s.value.recipientType==="group"&&!!s.value.groupId:!0}return de(()=>{ee()}),(l,t)=>(o(),w(fe,null,{default:me(()=>{var g;return[e("div",Ce,[t[57]||(t[57]=e("div",{class:"mb-6 sm:mb-8"},[e("h1",{class:"text-2xl sm:text-3xl font-bold"},"Nouvelle Campagne SMS"),e("p",{class:"text-sm sm:text-base text-muted-foreground mt-1 sm:mt-2"},"Créez et planifiez votre campagne d'envoi")],-1)),e("div",De,[e("div",Me,[e("div",Ve,[t[19]||(t[19]=e("div",{class:"absolute top-4 sm:top-5 left-0 right-0 h-1 bg-border -z-10"},null,-1)),e("div",{class:"absolute top-4 sm:top-5 left-0 h-1 bg-primary transition-all duration-300 -z-10",style:ve({width:`${c.value/(C.length-1)*100}%`})},null,4),(o(),r(h,null,k(C,(n,u)=>e("div",{key:u,class:"flex flex-col items-center relative bg-background px-1 sm:px-2"},[e("div",{class:y(["w-8 h-8 sm:w-12 sm:h-12 rounded-full flex items-center justify-center font-bold mb-2 sm:mb-3 border-2 sm:border-4 transition-all duration-300 shadow-md text-xs sm:text-base",c.value>=u?"bg-primary text-primary-foreground border-primary scale-110":c.value===u-1?"bg-background border-primary text-primary":"bg-background border-border text-muted-foreground"])},[c.value>u?(o(),w(d(J),{key:0,class:"w-4 h-4 sm:w-6 sm:h-6"})):(o(),r("span",$e,a(u+1),1))],2),e("span",{class:y(["text-xs sm:text-sm font-medium text-center transition-colors max-w-[60px] sm:max-w-none",c.value>=u?"text-foreground":"text-muted-foreground"])},a(n),3)])),64))])])]),e("div",qe,[e("div",Ae,[c.value===0?(o(),r("div",Be,[t[32]||(t[32]=e("h2",{class:"text-xl font-semibold mb-6"},"Type d'envoi",-1)),e("div",Re,[e("label",{class:y(["flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer hover:bg-accent/50 transition-colors",s.value.sendType==="immediate"?"border-primary bg-primary/5":"border-border"])},[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.sendType=n),type:"radio",value:"immediate",class:"mt-1 w-4 h-4"},null,512),[[M,s.value.sendType]]),p(d(Q),{class:"w-5 h-5 text-primary mt-0.5 flex-shrink-0"}),t[20]||(t[20]=e("div",{class:"flex-1"},[e("div",{class:"font-semibold text-base flex items-center gap-2"},"Envoi immédiat"),e("div",{class:"text-sm text-muted-foreground mt-1"},"Envoyer les SMS maintenant à tous les destinataires")],-1))],2),e("label",{class:y(["flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer hover:bg-accent/50 transition-colors",s.value.sendType==="scheduled"?"border-primary bg-primary/5":"border-border"])},[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.sendType=n),type:"radio",value:"scheduled",class:"mt-1 w-4 h-4"},null,512),[[M,s.value.sendType]]),p(d(H),{class:"w-5 h-5 text-primary mt-0.5 flex-shrink-0"}),t[21]||(t[21]=e("div",{class:"flex-1"},[e("div",{class:"font-semibold text-base flex items-center gap-2"},"Campagne planifiée"),e("div",{class:"text-sm text-muted-foreground mt-1"},"Planifier l'envoi à une date et heure précises")],-1))],2)]),e("div",Ue,[e("div",Ie,[t[22]||(t[22]=e("label",{class:"text-sm font-medium"},"Nom de la campagne",-1)),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>s.value.name=n),type:"text",placeholder:"Ex: Promotion Été 2024",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[T,s.value.name]])]),e("div",je,[t[23]||(t[23]=e("label",{class:"text-sm font-medium"},"Description (optionnelle)",-1)),m(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=n=>s.value.description=n),placeholder:"Description de la campagne...",rows:"2",class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 resize-none"},null,512),[[T,s.value.description]])])]),s.value.sendType==="scheduled"?(o(),r("div",Ee,[e("div",Pe,[e("div",ze,[t[24]||(t[24]=e("label",{class:"text-xs sm:text-sm font-medium"},"Date d'envoi *",-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>s.value.sendDate=n),type:"date",min:Y.value,class:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Ne),[[T,s.value.sendDate]])]),e("div",Fe,[t[25]||(t[25]=e("label",{class:"text-xs sm:text-sm font-medium"},"Heure d'envoi *",-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>s.value.sendTime=n),type:"time",class:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[T,s.value.sendTime]])])]),e("div",Oe,[e("div",Ge,[m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>s.value.isRecurring=n),type:"checkbox",id:"isRecurring",class:"w-4 h-4 rounded border-gray-300"},null,512),[[R,s.value.isRecurring]]),t[26]||(t[26]=e("label",{for:"isRecurring",class:"text-sm font-medium cursor-pointer"}," Activer la récurrence ",-1))]),s.value.isRecurring?(o(),r("div",He,[e("div",Le,[t[28]||(t[28]=e("label",{class:"text-sm font-medium"},"Fréquence",-1)),m(e("select",{"onUpdate:modelValue":t[7]||(t[7]=n=>s.value.frequency=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...t[27]||(t[27]=[e("option",{value:"daily"},"Quotidienne",-1),e("option",{value:"weekly"},"Hebdomadaire",-1),e("option",{value:"monthly"},"Mensuelle",-1)])],512),[[V,s.value.frequency]])]),s.value.frequency==="weekly"?(o(),r("div",Je,[t[29]||(t[29]=e("label",{class:"text-sm font-medium"},"Jours d'envoi",-1)),e("div",Qe,[(o(),r(h,null,k(z,(n,u)=>e("label",{key:u,class:y(["inline-flex items-center gap-1.5 px-3 py-1.5 rounded-md border cursor-pointer transition-colors",s.value.weekDays.includes(u+1)?"bg-primary text-primary-foreground border-primary":"bg-background border-input hover:bg-accent"])},[m(e("input",{type:"checkbox",value:u+1,"onUpdate:modelValue":t[8]||(t[8]=b=>s.value.weekDays=b),class:"sr-only"},null,8,Xe),[[R,s.value.weekDays]]),e("span",Ze,a(n),1)],2)),64))])])):i("",!0),s.value.frequency==="monthly"?(o(),r("div",Ke,[t[30]||(t[30]=e("label",{class:"text-sm font-medium"},"Jour du mois",-1)),m(e("select",{"onUpdate:modelValue":t[9]||(t[9]=n=>s.value.dayOfMonth=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[(o(),r(h,null,k(28,n=>e("option",{key:n,value:n},a(n),9,We)),64))],512),[[V,s.value.dayOfMonth]])])):i("",!0),e("div",Ye,[t[31]||(t[31]=e("label",{class:"text-sm font-medium"},"Date de fin (optionnel)",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>s.value.endDate=n),type:"date",min:s.value.sendDate,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,es),[[T,s.value.endDate]])])])):i("",!0)])])):i("",!0)])):i("",!0),c.value===1?(o(),r("div",ss,[t[39]||(t[39]=e("h2",{class:"text-xl font-semibold mb-6"},"Contenu du message",-1)),e("div",ts,[t[34]||(t[34]=e("label",{class:"text-sm font-medium"},"Utiliser un modèle (optionnel)",-1)),m(e("select",{"onUpdate:modelValue":t[11]||(t[11]=n=>s.value.templateId=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[t[33]||(t[33]=e("option",{value:""},"Écrire un nouveau message",-1)),(o(!0),r(h,null,k(A.value,n=>(o(),r("option",{key:n.id,value:n.id.toString()},a(n.name)+" ("+a(n.message.length)+" car.) ",9,ns))),128))],512),[[V,s.value.templateId]])]),e("div",os,[e("div",as,[t[35]||(t[35]=e("label",{class:"text-sm font-medium"},"Message *",-1)),e("div",rs,[e("span",ls,a(N.value)+"/160 caractères",1),v.value>1?(o(),r("span",is,a(v.value)+" SMS ",1)):i("",!0)])]),m(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=n=>s.value.message=n),placeholder:"Votre message SMS...",rows:"6",maxlength:"320",class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 resize-none font-mono"},null,512),[[T,s.value.message]]),v.value>1?(o(),r("p",us,[p(d(ke),{class:"w-4 h-4"}),e("span",null,"Votre message sera envoyé en "+a(v.value)+" SMS (coût multiplié par "+a(v.value)+")",1)])):i("",!0)]),e("div",ds,[t[36]||(t[36]=e("p",{class:"text-sm font-medium mb-3"},"Variables disponibles :",-1)),e("div",ms,[(o(),r(h,null,k(W,n=>e("button",{key:n,onClick:u=>se(n),class:"text-xs px-3 py-1.5 rounded-md bg-background hover:bg-primary hover:text-primary-foreground border border-border hover:border-primary transition-colors font-mono"},a(n),9,cs)),64))])]),e("div",ps,[e("div",vs,[e("div",fs,[m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=n=>s.value.enableABTest=n),type:"checkbox",id:"enableABTest",class:"w-4 h-4 rounded border-gray-300"},null,512),[[R,s.value.enableABTest]]),t[37]||(t[37]=e("label",{for:"enableABTest",class:"text-sm font-medium cursor-pointer"}," Activer le test A/B ",-1))]),p(d(X),{class:"w-5 h-5 text-muted-foreground"})]),s.value.enableABTest?(o(),r("div",gs,[t[38]||(t[38]=e("p",{class:"text-sm text-muted-foreground"}," Créez des variantes de votre message pour tester différentes versions. Chaque variante sera envoyée à une portion égale de vos destinataires. ",-1)),(o(!0),r(h,null,k(s.value.variants,(n,u)=>(o(),r("div",{key:u,class:"space-y-2 p-3 bg-background rounded-lg border"},[e("div",bs,[e("label",xs,"Variante "+a(String.fromCharCode(65+u)),1),s.value.variants.length>2?(o(),r("button",{key:0,onClick:b=>ne(u),class:"text-destructive hover:bg-destructive/10 rounded p-1"},[p(d(_e),{class:"w-4 h-4"})],8,ys)):i("",!0)]),m(e("textarea",{"onUpdate:modelValue":b=>n.message=b,placeholder:`Message variante ${String.fromCharCode(65+u)}...`,rows:"3",class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 resize-none font-mono"},null,8,hs),[[T,n.message]]),e("div",ks,[e("span",null,a(n.message.length)+"/160 caractères",1),e("span",null,a(Math.ceil(100/s.value.variants.length))+"% des destinataires",1)])]))),128)),s.value.variants.length<4?(o(),r("button",{key:0,onClick:te,class:"w-full inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-dashed border-input bg-background hover:bg-accent hover:text-accent-foreground h-10"},[p(d(ge),{class:"w-4 h-4"}),e("span",null,"Ajouter une variante ("+a(s.value.variants.length)+"/4)",1)])):i("",!0)])):i("",!0)])])):i("",!0),c.value===2?(o(),r("div",_s,[t[49]||(t[49]=e("h2",{class:"text-xl font-semibold mb-6"},"Sélection des destinataires",-1)),e("div",ws,[e("label",{class:y(["flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-accent/50 transition-colors",s.value.recipientType==="all"?"border-primary bg-primary/5":"border-border"])},[m(e("input",{"onUpdate:modelValue":t[14]||(t[14]=n=>s.value.recipientType=n),type:"radio",value:"all",class:"mt-1 w-4 h-4"},null,512),[[M,s.value.recipientType]]),p(d(L),{class:"w-5 h-5 text-primary mt-0.5 flex-shrink-0"}),e("div",Ts,[t[40]||(t[40]=e("div",{class:"font-semibold flex items-center gap-2"},"Tous les contacts",-1)),e("div",Ss," Envoyer à tous les contacts actifs ("+a(B.value)+" contact"+a(B.value>1?"s":"")+") ",1)])],2),e("label",{class:y(["flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-accent/50 transition-colors",s.value.recipientType==="group"?"border-primary bg-primary/5":"border-border"])},[m(e("input",{"onUpdate:modelValue":t[15]||(t[15]=n=>s.value.recipientType=n),type:"radio",value:"group",class:"mt-1 w-4 h-4"},null,512),[[M,s.value.recipientType]]),p(d(Z),{class:"w-5 h-5 text-primary mt-0.5 flex-shrink-0"}),t[41]||(t[41]=e("div",{class:"flex-1"},[e("div",{class:"font-semibold flex items-center gap-2"},"Groupe spécifique"),e("div",{class:"text-sm text-muted-foreground mt-1"},"Sélectionner un groupe de contacts")],-1))],2)]),s.value.recipientType==="group"?(o(),r("div",Cs,[t[43]||(t[43]=e("label",{class:"text-sm font-medium"},"Sélectionner un groupe *",-1)),m(e("select",{"onUpdate:modelValue":t[16]||(t[16]=n=>s.value.groupId=n),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[t[42]||(t[42]=e("option",{value:""},"Choisir un groupe...",-1)),(o(!0),r(h,null,k(D.value,n=>(o(),r("option",{key:n.id,value:n.id},a(n.name)+" ("+a(n.contact_count)+" contacts) ",9,Ds))),128))],512),[[V,s.value.groupId]])])):i("",!0),e("div",Ms,[e("div",Vs,[p(d(be),{class:"w-8 h-8 sm:w-10 sm:h-10 text-primary flex-shrink-0 mt-1"}),e("div",$s,[t[48]||(t[48]=e("p",{class:"font-bold text-base sm:text-lg mb-2"},"Estimation de l'envoi",-1)),e("div",qs,[e("div",null,[t[44]||(t[44]=e("p",{class:"text-xs sm:text-sm text-muted-foreground"},"Destinataires",-1)),e("p",As,a(x.value),1)]),e("div",null,[t[45]||(t[45]=e("p",{class:"text-xs sm:text-sm text-muted-foreground"},"SMS/message",-1)),e("p",{class:y(["text-xl sm:text-2xl font-bold",v.value>1?"text-warning":"text-foreground"])},a(v.value),3)]),e("div",null,[t[46]||(t[46]=e("p",{class:"text-xs sm:text-sm text-muted-foreground"},"Total SMS",-1)),e("p",Bs,a(x.value*v.value),1)]),e("div",null,[t[47]||(t[47]=e("p",{class:"text-xs sm:text-sm text-muted-foreground"},"Coût estimé",-1)),e("p",Rs,a(F.value)+" XAF",1)])])])])])])):i("",!0),c.value===3?(o(),r("div",Us,[t[56]||(t[56]=e("h2",{class:"text-xl font-semibold mb-6"},"Récapitulatif de la campagne",-1)),e("div",Is,[e("div",js,[e("div",null,[t[50]||(t[50]=e("p",{class:"text-xs text-muted-foreground uppercase"},"Type d'envoi",-1)),e("p",Es,[s.value.sendType==="immediate"?(o(),w(d(Q),{key:0,class:"w-5 h-5 text-primary"})):s.value.isRecurring?(o(),w(d(we),{key:1,class:"w-5 h-5 text-primary"})):(o(),w(d(H),{key:2,class:"w-5 h-5 text-primary"})),e("span",null,a(s.value.sendType==="immediate"?"Envoi immédiat":s.value.isRecurring?"Campagne récurrente":"Campagne planifiée"),1)]),s.value.sendType==="scheduled"?(o(),r("p",Ps,a(s.value.isRecurring?"Début:":"Programmé pour le")+" "+a(s.value.sendDate)+" à "+a(s.value.sendTime),1)):i("",!0),s.value.isRecurring?(o(),r("p",zs,[G(" Fréquence: "+a({daily:"Quotidienne",weekly:"Hebdomadaire",monthly:"Mensuelle"}[s.value.frequency])+" ",1),s.value.frequency==="weekly"?(o(),r("span",Ns," ("+a(s.value.weekDays.map(n=>z[n-1]).join(", "))+")",1)):i("",!0),s.value.frequency==="monthly"?(o(),r("span",Fs," (le "+a(s.value.dayOfMonth)+" de chaque mois)",1)):i("",!0)])):i("",!0),s.value.isRecurring&&s.value.endDate?(o(),r("p",Os," Fin: "+a(s.value.endDate),1)):i("",!0)])]),e("div",Gs,[t[51]||(t[51]=e("p",{class:"text-xs text-muted-foreground uppercase"},"Nom de la campagne",-1)),e("p",Hs,a(s.value.name||"Sans nom"),1),s.value.description?(o(),r("p",Ls,a(s.value.description),1)):i("",!0)]),e("div",Js,[t[52]||(t[52]=e("p",{class:"text-xs text-muted-foreground uppercase"},"Message",-1)),e("div",Qs,a(s.value.message||"Aucun message"),1),e("p",Xs,a(N.value)+" caractères • "+a(v.value)+" SMS",1)]),s.value.enableABTest?(o(),r("div",Zs,[e("p",Ks,[p(d(X),{class:"w-4 h-4"}),t[53]||(t[53]=G(" Test A/B activé ",-1))]),e("div",Ws,[(o(!0),r(h,null,k(s.value.variants,(n,u)=>(o(),r("div",{key:u,class:"p-3 bg-background rounded border"},[e("p",Ys," Variante "+a(String.fromCharCode(65+u))+" ("+a(Math.ceil(100/s.value.variants.length))+"%) ",1),e("p",et,a(n.message||"Aucun message"),1)]))),128))])])):i("",!0),e("div",st,[t[54]||(t[54]=e("p",{class:"text-xs text-muted-foreground uppercase"},"Destinataires",-1)),e("p",tt,[s.value.recipientType==="all"?(o(),w(d(L),{key:0,class:"w-5 h-5 text-primary"})):(o(),w(d(Z),{key:1,class:"w-5 h-5 text-primary"})),e("span",null,a(s.value.recipientType==="all"?"Tous les contacts":"Groupe spécifique"),1)]),s.value.recipientType==="group"?(o(),r("p",nt,a(((g=D.value.find(n=>n.id===s.value.groupId))==null?void 0:g.name)||"Groupe non sélectionné"),1)):i("",!0),e("p",ot,a(x.value)+" contact(s)",1)]),e("div",at,[e("div",rt,[e("div",null,[t[55]||(t[55]=e("p",{class:"text-sm text-muted-foreground mb-1"},"Coût total estimé",-1)),e("p",lt,a(F.value)+" XAF",1),e("p",it,a(x.value*v.value)+" SMS au total",1)]),p(d(J),{class:"w-16 h-16 text-success/50"})])])])])):i("",!0),e("div",ut,[c.value>0?(o(),r("button",{key:0,onClick:t[17]||(t[17]=n=>c.value--),disabled:f.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 sm:h-10 px-3 sm:px-4 py-2 order-2 sm:order-1"}," ← Précédent ",8,dt)):(o(),r("div",mt)),e("div",ct,[c.value<C.length-1?(o(),r("button",{key:0,onClick:oe,disabled:f.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 sm:h-10 px-3 sm:px-4 py-2"},[p(d(Se),{class:"w-4 h-4"}),e("span",null,a(f.value?"Sauvegarde...":"Brouillon"),1)],8,pt)):i("",!0),c.value<C.length-1?(o(),r("button",{key:1,onClick:t[18]||(t[18]=n=>c.value++),disabled:!re()||f.value,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 sm:h-10 px-3 sm:px-4 py-2"}," Suivant → ",8,vt)):(o(),r("button",{key:2,onClick:ae,disabled:f.value,class:y(["inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-9 sm:h-10 px-4 sm:px-6 py-2",s.value.sendType==="immediate"?"bg-success text-success-foreground hover:bg-success/90":"bg-primary text-primary-foreground hover:bg-primary/90"])},[p(d(Te),{class:"w-4 h-4 sm:w-5 sm:h-5"}),f.value?(o(),r("span",gt,"Envoi...")):(o(),r(h,{key:1},[e("span",bt,a(s.value.sendType==="immediate"?"Envoyer maintenant":"Planifier la campagne"),1),e("span",xt,a(s.value.sendType==="immediate"?"Envoyer":"Planifier"),1)],64))],10,ft))])])])])])]}),_:1}))}});export{Bt as default};
