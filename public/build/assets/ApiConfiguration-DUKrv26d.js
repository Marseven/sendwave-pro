import{o as n,c as r,b as e,d as W,r as v,a as M,l as N,m as w,n as R,p as l,q as a,F as L,x as Z,s as P,t as u,i as c,f as p,h as F,v as A,A as I,g,B as q}from"./main-CoGMHHt9.js";import{_ as z,e as $,k as G}from"./api-Cjgg3nLh.js";import{r as B}from"./KeyIcon-Ckb3hnCw.js";import{r as S}from"./CheckCircleIcon-CWAwbvpF.js";import{a as K,r as O}from"./XCircleIcon-CKEbHkzw.js";import{r as X}from"./ExclamationTriangleIcon-GO3eEcYu.js";import{r as J}from"./EyeIcon-CfOjMuca.js";import{r as Q}from"./IdentificationIcon-BDe-7Ol0.js";import{r as Y}from"./BoltIcon-B_-Cpirs.js";import{r as ee}from"./InformationCircleIcon-h-SYS7QV.js";function te(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m15 11.25-3-3m0 0-3 3m3-3v7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function se(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function oe(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"})])}function ne(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"})])}function ie(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})])}function re(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5-3.9 19.5m-2.1-19.5-3.9 19.5"})])}function ae(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m3 3 8.735 8.735m0 0a.374.374 0 1 1 .53.53m-.53-.53.53.53m0 0L21 21M14.652 9.348a3.75 3.75 0 0 1 0 5.304m2.121-7.425a6.75 6.75 0 0 1 0 9.546m2.121-11.667c3.808 3.807 3.808 9.98 0 13.788m-9.546-4.242a3.733 3.733 0 0 1-1.06-2.122m-1.061 4.243a6.75 6.75 0 0 1-1.625-6.929m-.496 9.05c-3.068-3.067-3.664-7.67-1.79-11.334M12 12h.008v.008H12V12Z"})])}function U(m,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])}const le={class:"p-8"},ce={class:"mb-8"},de={class:"flex items-center gap-2"},ue={key:0,class:"flex items-center justify-center py-12"},me={key:1,class:"max-w-5xl mx-auto space-y-6"},fe={class:"p-6"},ge={class:"flex items-start justify-between mb-6"},pe={class:"flex items-start gap-4"},he={class:"flex items-center gap-3"},xe={class:"text-xl font-bold"},_e={key:0,class:"px-2 py-1 rounded-full bg-success/10 text-success text-xs font-medium flex items-center gap-1"},be={key:1,class:"px-2 py-1 rounded-full bg-muted text-muted-foreground text-xs font-medium flex items-center gap-1"},ve={class:"text-sm text-muted-foreground mt-1"},we={class:"flex items-center gap-4 mt-3"},ye={class:"flex items-center gap-1.5 text-xs"},ke={class:"text-muted-foreground"},Ce={key:0,class:"flex items-center gap-1.5 text-xs text-success"},Me={key:1,class:"flex items-center gap-1.5 text-xs text-destructive"},Ae={key:2,class:"flex items-center gap-1.5 text-xs text-muted-foreground"},$e=["onClick"],Se={key:0,class:"pt-6 border-t space-y-6"},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pe={class:"space-y-2"},Ie={class:"text-sm font-medium flex items-center gap-2"},Be={class:"relative"},Ue=["onUpdate:modelValue","type"],je=["onClick"],De={class:"space-y-2"},Te={class:"text-sm font-medium flex items-center gap-2"},Ee=["onUpdate:modelValue"],He={key:0,class:"space-y-2"},We={class:"text-sm font-medium flex items-center gap-2"},Ne=["onUpdate:modelValue"],Re={key:1,class:"space-y-2"},Le={class:"text-sm font-medium flex items-center gap-2"},Ze=["onUpdate:modelValue"],Fe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},qe={class:"space-y-2"},ze={class:"text-sm font-medium flex items-center gap-2"},Ge=["onUpdate:modelValue"],Ke={class:"space-y-2"},Oe={class:"text-sm font-medium flex items-center gap-2"},Xe=["onUpdate:modelValue"],Je={class:"space-y-2"},Qe={class:"text-sm font-medium flex items-center gap-2"},Ye={class:"flex items-center gap-3 h-10"},et={class:"relative inline-flex items-center cursor-pointer"},tt=["onUpdate:modelValue"],st={class:"text-sm font-medium"},ot={class:"p-4 bg-muted/50 rounded-lg"},nt={class:"flex items-start gap-3"},it={class:"flex-1 text-sm"},rt={class:"space-y-1 text-muted-foreground"},at={key:0},lt={key:1},ct={key:2},dt={class:"flex gap-3"},ut=["onClick","disabled"],mt={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"},ft=["onClick","disabled"],gt={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},pt={key:0,class:"rounded-lg bg-success/10 border border-success/20 p-4"},ht={class:"flex items-center gap-2 text-success"},xt={class:"font-medium"},_t={key:1,class:"rounded-lg bg-destructive/10 border border-destructive/20 p-4"},bt={class:"flex items-center gap-2 text-destructive"},vt={class:"font-medium"},It=W({__name:"ApiConfiguration",setup(m){const d=v(!0),h=v([]),y=M({}),_=M({}),b=M({}),f=v(""),x=v(""),k=v([{code:"msg91",name:"MSG91",description:"Service SMS indien avec routes transactionnelles et promotionnelles",website:"msg91.com",api_key:"",sender_id:"",priority:1,cost_per_sms:30,is_active:!1,status:"disconnected",config:{route:"4"}},{code:"smsala",name:"SMSALA",description:"Service SMS africain avec couverture continentale",website:"smsala.com",api_key:"",sender_id:"",priority:2,cost_per_sms:27,is_active:!1,status:"disconnected",config:{}},{code:"whapi",name:"WHAPI (WhatsApp)",description:"WhatsApp Business API via WHAPI.cloud pour messages instantanés",website:"whapi.cloud",api_key:"",sender_id:"",priority:3,cost_per_sms:20,is_active:!1,status:"disconnected",config:{channel_id:""}}]);function j(o){const s=h.value.indexOf(o);s>-1?h.value.splice(s,1):h.value.push(o)}function D(o){y[o]=!y[o]}async function T(){d.value=!0;try{const o=await $.get("/sms-providers"),s=o.data.data||o.data;k.value=k.value.map(t=>{const i=s.find(C=>C.code===t.code);return i?{...t,...i,config:{...t.config,...i.config}}:t}),h.value=k.value.filter(t=>t.is_active).map(t=>t.code)}catch(o){console.error("Error loading providers:",o)}finally{d.value=!1}}async function E(o){var s,t;_[o.code]=!0,f.value="",x.value="";try{const i=await $.post(`/sms-providers/${o.code}/test`,{api_key:o.api_key,sender_id:o.sender_id,config:o.config});o.status="connected",f.value=`✓ Connexion réussie avec ${o.name} !`,setTimeout(()=>{f.value=""},3e3)}catch(i){console.error("Test connection error:",i),o.status="error",x.value=((t=(s=i.response)==null?void 0:s.data)==null?void 0:t.message)||`Échec de la connexion avec ${o.name}`}finally{_[o.code]=!1}}async function H(o){var s,t;b[o.code]=!0,f.value="",x.value="";try{const i={code:o.code,name:o.name,api_key:o.api_key,sender_id:o.sender_id,priority:o.priority,cost_per_sms:o.cost_per_sms,is_active:o.is_active,config:o.config},C=await $.post("/sms-providers",i),V=C.data.data||C.data;V.id&&(o.id=V.id),f.value=`Configuration de ${o.name} enregistrée avec succès !`,setTimeout(()=>{f.value=""},3e3)}catch(i){console.error("Save provider error:",i),x.value=((t=(s=i.response)==null?void 0:s.data)==null?void 0:t.message)||`Erreur lors de l'enregistrement de ${o.name}`}finally{b[o.code]=!1}}return N(()=>{T()}),(o,s)=>(n(),w(z,null,{default:R(()=>[e("div",le,[e("div",ce,[e("div",de,[l(a(B),{class:"w-8 h-8 text-primary"}),s[0]||(s[0]=e("h1",{class:"text-3xl font-bold"},"Configuration des API SMS",-1))]),s[1]||(s[1]=e("p",{class:"text-muted-foreground mt-2"},"Configurez vos clés API pour les différents providers SMS",-1))]),d.value?(n(),r("div",ue,[...s[2]||(s[2]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)])])):(n(),r("div",me,[(n(!0),r(L,null,Z(k.value,t=>(n(),r("div",{key:t.code,class:"rounded-lg border bg-card shadow-sm overflow-hidden"},[e("div",fe,[e("div",ge,[e("div",pe,[e("div",{class:P(["w-16 h-16 rounded-lg flex items-center justify-center text-2xl font-bold",t.is_active?"bg-success/10 text-success":"bg-muted text-muted-foreground"])},u(t.code.substring(0,2).toUpperCase()),3),e("div",null,[e("div",he,[e("h3",xe,u(t.name),1),t.is_active?(n(),r("span",_e,[l(a(S),{class:"w-3 h-3"}),s[3]||(s[3]=e("span",null,"Actif",-1))])):(n(),r("span",be,[l(a(K),{class:"w-3 h-3"}),s[4]||(s[4]=e("span",null,"Inactif",-1))]))]),e("p",ve,u(t.description),1),e("div",we,[e("div",ye,[l(a(ie),{class:"w-4 h-4 text-muted-foreground"}),e("span",ke,u(t.website),1)]),t.status==="connected"?(n(),r("div",Ce,[l(a(U),{class:"w-4 h-4"}),s[5]||(s[5]=e("span",null,"Connecté",-1))])):t.status==="error"?(n(),r("div",Me,[l(a(X),{class:"w-4 h-4"}),s[6]||(s[6]=e("span",null,"Erreur de connexion",-1))])):(n(),r("div",Ae,[l(a(ae),{class:"w-4 h-4"}),s[7]||(s[7]=e("span",null,"Non configuré",-1))]))])])]),e("button",{onClick:i=>j(t.code),class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:bg-accent hover:text-accent-foreground h-9 w-9"},[l(a(G),{class:P(["w-5 h-5 transition-transform",h.value.includes(t.code)?"rotate-180":""])},null,8,["class"])],8,$e)]),h.value.includes(t.code)?(n(),r("div",Se,[e("div",Ve,[e("div",Pe,[e("label",Ie,[l(a(B),{class:"w-4 h-4 text-muted-foreground"}),s[8]||(s[8]=c(" Clé API * ",-1))]),e("div",Be,[p(e("input",{"onUpdate:modelValue":i=>t.api_key=i,type:y[t.code]?"text":"password",placeholder:"Entrez votre clé API",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 pr-10 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Ue),[[F,t.api_key]]),e("button",{onClick:i=>D(t.code),type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-accent rounded p-1"},[y[t.code]?(n(),w(a(ne),{key:1,class:"w-4 h-4 text-muted-foreground"})):(n(),w(a(J),{key:0,class:"w-4 h-4 text-muted-foreground"}))],8,je)])]),e("div",De,[e("label",Te,[l(a(Q),{class:"w-4 h-4 text-muted-foreground"}),s[9]||(s[9]=c(" Sender ID / From ",-1))]),p(e("input",{"onUpdate:modelValue":i=>t.sender_id=i,type:"text",placeholder:"Ex: MyCompany, +1234567890",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Ee),[[A,t.sender_id]])]),t.code==="msg91"?(n(),r("div",He,[e("label",We,[l(a(re),{class:"w-4 h-4 text-muted-foreground"}),s[10]||(s[10]=c(" Route (MSG91) ",-1))]),p(e("select",{"onUpdate:modelValue":i=>t.config.route=i,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...s[11]||(s[11]=[e("option",{value:"4"},"Transactional (Route 4)",-1),e("option",{value:"1"},"Promotional (Route 1)",-1)])],8,Ne),[[I,t.config.route]])])):g("",!0),t.code==="whapi"?(n(),r("div",Re,[e("label",Le,[l(a(oe),{class:"w-4 h-4 text-muted-foreground"}),s[12]||(s[12]=c(" Channel ID (WHAPI) ",-1))]),p(e("input",{"onUpdate:modelValue":i=>t.config.channel_id=i,type:"text",placeholder:"Votre channel ID",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Ze),[[A,t.config.channel_id]])])):g("",!0)]),e("div",Fe,[e("div",qe,[e("label",ze,[l(a(te),{class:"w-4 h-4 text-muted-foreground"}),s[13]||(s[13]=c(" Priorité ",-1))]),p(e("select",{"onUpdate:modelValue":i=>t.priority=i,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...s[14]||(s[14]=[e("option",{value:1},"1 - Haute priorité",-1),e("option",{value:2},"2 - Moyenne",-1),e("option",{value:3},"3 - Basse priorité",-1)])],8,Ge),[[I,t.priority]])]),e("div",Ke,[e("label",Oe,[l(a(se),{class:"w-4 h-4 text-muted-foreground"}),s[15]||(s[15]=c(" Coût par SMS (XAF) ",-1))]),p(e("input",{"onUpdate:modelValue":i=>t.cost_per_sms=i,type:"number",step:"1",min:"0",placeholder:"30",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Xe),[[A,t.cost_per_sms,void 0,{number:!0}]])]),e("div",Je,[e("label",Qe,[l(a(Y),{class:"w-4 h-4 text-muted-foreground"}),s[16]||(s[16]=c(" Statut ",-1))]),e("div",Ye,[e("label",et,[p(e("input",{"onUpdate:modelValue":i=>t.is_active=i,type:"checkbox",class:"sr-only peer"},null,8,tt),[[q,t.is_active]]),s[17]||(s[17]=e("div",{class:"w-11 h-6 bg-muted peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-success"},null,-1))]),e("span",st,u(t.is_active?"Activé":"Désactivé"),1)])])]),e("div",ot,[e("div",nt,[l(a(ee),{class:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),e("div",it,[s[21]||(s[21]=e("p",{class:"font-medium mb-2"},"Documentation API",-1)),e("ul",rt,[t.code==="msg91"?(n(),r("li",at,[...s[18]||(s[18]=[c(" • Route 4 (Transactional) : Pour les OTP, alertes, notifications importantes",-1),e("br",null,null,-1),c(" • Route 1 (Promotional) : Pour les campagnes marketing ",-1)])])):g("",!0),t.code==="smsala"?(n(),r("li",lt,[...s[19]||(s[19]=[c(" • API REST simple avec authentification par clé API",-1),e("br",null,null,-1),c(" • Sender ID alphanumérique (3-11 caractères) ou numérique ",-1)])])):g("",!0),t.code==="whapi"?(n(),r("li",ct,[...s[20]||(s[20]=[c(" • WhatsApp Business API via WHAPI.cloud",-1),e("br",null,null,-1),c(" • Nécessite un Bearer token et un Channel ID valide",-1),e("br",null,null,-1),c(" • Documentation: ",-1),e("a",{href:"https://whapi.cloud/docs",target:"_blank",class:"text-primary hover:underline"},"whapi.cloud/docs",-1)])])):g("",!0)])])])]),e("div",dt,[e("button",{onClick:i=>E(t),disabled:!t.api_key||_[t.code],class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"},[_[t.code]?(n(),r("div",mt)):(n(),w(a(U),{key:0,class:"w-4 h-4"})),e("span",null,u(_[t.code]?"Test en cours...":"Tester la connexion"),1)],8,ut),e("button",{onClick:i=>H(t),disabled:!t.api_key||b[t.code],class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"},[b[t.code]?(n(),r("div",gt)):(n(),w(a(S),{key:0,class:"w-4 h-4"})),e("span",null,u(b[t.code]?"Enregistrement...":"Enregistrer"),1)],8,ft)])])):g("",!0)])]))),128)),f.value?(n(),r("div",pt,[e("div",ht,[l(a(S),{class:"w-5 h-5"}),e("p",xt,u(f.value),1)])])):g("",!0),x.value?(n(),r("div",_t,[e("div",bt,[l(a(O),{class:"w-5 h-5"}),e("p",vt,u(x.value),1)])])):g("",!0)]))])]),_:1}))}});export{It as default};
