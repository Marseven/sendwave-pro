import{o as r,c as l,b as t,d as Be,u as Ie,r as u,m as Pe,n as Te,p as De,y as i,x as a,i as w,s as A,g as m,F as _,q as C,t as d,f as c,C as le,w as G,v,D as Ge}from"./main-jARQBOon.js";import{_ as He,f,c as fe,m as ne,q as be,h as H}from"./api-CKlGjfMy.js";import{b as x,a as h,s as Z}from"./notifications-CHQAjgV4.js";import{r as ve}from"./BuildingOfficeIcon-Cdufm0Se.js";import{r as Ze}from"./ShieldCheckIcon-na2mqIq2.js";import{r as xe}from"./KeyIcon-DWbOlU3L.js";import{r as ie}from"./PencilIcon-DA_6_fnX.js";import{r as Je}from"./BanknotesIcon-C_BTufEp.js";import{r as ge}from"./CheckCircleIcon-DM4_mrR5.js";import{r as ye}from"./TrashIcon-DfAc1a78.js";import{r as Ke}from"./DocumentDuplicateIcon-Cd8TS40Z.js";import{r as we}from"./InformationCircleIcon-DI4BUBuI.js";function he(ke,b){return r(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"})])}const Oe={class:"p-4 sm:p-6 lg:p-8"},Qe={class:"mb-6 border-b overflow-x-auto"},We={class:"flex gap-2 sm:gap-4 -mb-px min-w-max"},Ye={key:0},et={class:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},tt={key:0,class:"flex items-center justify-center py-8"},st={key:1,class:"flex flex-col items-center justify-center py-12 rounded-lg border bg-card"},ot={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"},rt={class:"p-4 sm:p-5"},lt={class:"flex items-start justify-between gap-2 mb-3"},nt={class:"flex-1 min-w-0"},it={class:"font-semibold text-base truncate"},dt={class:"text-xs text-muted-foreground mt-0.5 truncate"},at={class:"grid grid-cols-2 gap-3 text-sm mb-4"},ut={class:"font-semibold text-primary"},mt={class:"font-semibold"},pt={class:"font-semibold"},ct={class:"font-semibold"},ft={class:"flex flex-wrap gap-2 pt-3 border-t"},bt=["onClick"],vt=["onClick"],xt=["onClick"],gt=["onClick"],yt={key:1},wt={class:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},ht={class:"flex items-center gap-3"},kt={class:"text-sm text-muted-foreground"},_t=["value"],Ct={key:0,class:"flex items-center justify-center py-8"},jt={key:1,class:"flex flex-col items-center justify-center py-12 rounded-lg border bg-card"},$t={key:2,class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4"},At={class:"p-4 sm:p-5"},Ut={class:"flex items-start justify-between gap-2 mb-3"},St={class:"flex-1 min-w-0"},Mt={class:"font-semibold text-base truncate"},Rt={class:"text-xs text-muted-foreground mt-0.5 truncate"},Et={key:0,class:"text-xs text-primary mt-0.5 truncate"},Nt={class:"flex items-center gap-2 mb-3"},Vt={class:"flex flex-wrap gap-2 pt-3 border-t"},zt=["onClick"],qt=["onClick"],Lt=["onClick"],Ft=["onClick"],Xt={key:2},Bt={class:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},It={key:0,class:"flex items-center justify-center py-8"},Pt={key:1,class:"flex flex-col items-center justify-center py-12 rounded-lg border bg-card"},Tt={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"},Dt={class:"p-4 sm:p-5"},Gt={class:"flex items-start justify-between gap-2 mb-2"},Ht={class:"font-semibold text-base"},Zt={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-muted"},Jt={class:"text-xs text-muted-foreground mb-3"},Kt={class:"flex flex-wrap gap-1 mb-3"},Ot={key:0,class:"text-xs px-1.5 py-0.5 rounded bg-muted"},Qt={class:"flex flex-wrap gap-2 pt-3 border-t"},Wt=["onClick"],Yt=["onClick"],es=["onClick"],ts={key:3},ss={class:"mb-4"},os={class:"flex items-center gap-2 mb-2"},rs={key:0,class:"flex items-center justify-center py-8"},ls={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ns={class:"p-4 sm:p-5"},is={class:"flex items-start justify-between gap-2 mb-2"},ds={class:"font-semibold text-base"},as={class:"text-xs px-2 py-0.5 rounded-full bg-muted"},us={class:"text-xs text-muted-foreground mb-3"},ms={class:"mb-2"},ps={class:"flex flex-wrap gap-1 max-h-24 overflow-y-auto"},cs={key:4},fs={class:"mb-4"},bs={class:"flex items-center gap-2 mb-2"},vs={key:0,class:"flex items-center justify-center py-8"},xs={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},gs={class:"p-4 sm:p-5"},ys={class:"font-semibold text-base mb-3 capitalize"},ws={class:"space-y-2"},hs={class:"text-sm font-medium"},ks={class:"text-xs text-muted-foreground"},_s={key:5,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Cs={class:"relative bg-background rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto"},js={class:"sticky top-0 bg-background border-b p-4 flex items-center justify-between"},$s={class:"text-lg font-semibold"},As={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Us={key:0,class:"border-t pt-4 mt-4"},Ss={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ms={class:"md:col-span-2"},Rs={class:"flex justify-end gap-3 pt-4 border-t"},Es=["disabled"],Ns={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Vs={key:6,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},zs={class:"relative bg-background rounded-lg shadow-lg w-full max-w-md"},qs={class:"p-4 border-b flex items-center justify-between"},Ls={class:"text-sm text-muted-foreground"},Fs={class:"text-sm"},Xs={class:"font-semibold text-primary"},Bs={class:"flex justify-end gap-3 pt-4 border-t"},Is=["disabled"],Ps={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Ts={key:7,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Ds={class:"relative bg-background rounded-lg shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto"},Gs={class:"sticky top-0 bg-background border-b p-4 flex items-center justify-between"},Hs={class:"text-lg font-semibold"},Zs={key:0},Js={key:1},Ks=["value"],Os=["value"],Qs={class:"flex justify-end gap-3 pt-4 border-t"},Ws=["disabled"],Ys={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},eo={key:8,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},to={class:"relative bg-background rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto"},so={class:"sticky top-0 bg-background border-b p-4 flex items-center justify-between"},oo={class:"text-lg font-semibold"},ro={class:"border rounded-lg p-3 max-h-64 overflow-y-auto"},lo={class:"text-xs font-semibold uppercase text-muted-foreground mb-2"},no={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},io=["value"],ao={class:"text-sm"},uo={class:"flex justify-end gap-3 pt-4 border-t"},mo=["disabled"],po={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},jo=Be({__name:"Accounts",setup(ke){const b=Ie(),g=u(b.isSuperAdmin?"accounts":"users"),J=u(!1),K=u(!1),O=u(!1),Q=u(!1),W=u(!1),z=u(!1),q=u(!1),L=u(!1),F=u(!1),M=u([]),Y=u([]),ee=u([]),de=u([]),te=u({}),ae=u([]),X=u(""),se=u(!1),oe=u(!1),re=u(!1),R=u(!1),U=u(null),S=u(null),E=u(null),p=u({name:"",email:"",phone:"",company_id:"",sms_credits:0,monthly_budget:null,admin_name:"",admin_email:"",admin_password:""}),k=u({name:"",email:"",password:"",role:"agent",account_id:""}),$=u({name:"",description:"",permissions:[]}),j=u({accountId:0,accountName:"",currentCredits:0,amount:0,note:""}),ue={active:"Actif",suspended:"Suspendu",pending:"En attente"},_e={super_admin:"Super Admin",admin:"Admin",agent:"Agent"};function B(o){return new Intl.NumberFormat("fr-FR").format(o)}async function V(){if(b.isSuperAdmin){J.value=!0;try{const o=await f.get("/accounts");M.value=o.data.data||[]}catch{x("Erreur lors du chargement des comptes")}finally{J.value=!1}}}async function N(){K.value=!0;try{const o={};X.value&&(o.account_id=X.value);const s=(await f.get("/users",{params:o})).data.data;Y.value=Array.isArray(s)?s:(s==null?void 0:s.data)||[]}catch{x("Erreur lors du chargement des utilisateurs")}finally{K.value=!1}}async function I(){if(b.isSuperAdmin){O.value=!0;try{const o=await f.get("/custom-roles");ee.value=o.data.data||[]}catch{x("Erreur lors du chargement des rôles personnalisés")}finally{O.value=!1}}}async function Ce(){Q.value=!0;try{const o=await f.get("/system-roles");de.value=o.data.data||[]}catch{x("Erreur lors du chargement des rôles système")}finally{Q.value=!1}}async function je(){W.value=!0;try{const o=await f.get("/system-permissions");te.value=o.data.data||{}}catch{x("Erreur lors du chargement des permissions")}finally{W.value=!1}}async function $e(){try{const o=await f.get("/users/available-roles");ae.value=o.data.data||[]}catch(o){console.error("Error loading roles:",o)}}function me(o){U.value=o||null,o?p.value={name:o.name,email:o.email,phone:o.phone||"",company_id:o.company_id||"",sms_credits:o.sms_credits||0,monthly_budget:o.monthly_budget,admin_name:"",admin_email:"",admin_password:""}:p.value={name:"",email:"",phone:"",company_id:"",sms_credits:0,monthly_budget:null,admin_name:"",admin_email:"",admin_password:""},se.value=!0}function P(){se.value=!1,U.value=null}async function Ae(){var o,e;z.value=!0;try{U.value?(await f.put(`/accounts/${U.value.id}`,p.value),h("Compte mis à jour avec succès")):(await f.post("/accounts",p.value),h("Compte créé avec succès")),P(),await V()}catch(s){x(((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erreur lors de la sauvegarde")}finally{z.value=!1}}function Ue(o){j.value={accountId:o.id,accountName:o.name,currentCredits:o.sms_credits,amount:0,note:""},R.value=!0}async function Se(){var o,e;F.value=!0;try{await f.post(`/accounts/${j.value.accountId}/credits`,{amount:j.value.amount,note:j.value.note}),h(`${j.value.amount} crédits ajoutés avec succès`),R.value=!1,await V()}catch(s){x(((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erreur lors de l'ajout des crédits")}finally{F.value=!1}}async function Me(o){var s,n;if(await Z("Suspendre ce compte ?","Tous les utilisateurs de ce compte seront également suspendus."))try{await f.post(`/accounts/${o.id}/suspend`),h("Compte suspendu"),await V()}catch(y){x(((n=(s=y.response)==null?void 0:s.data)==null?void 0:n.message)||"Erreur lors de la suspension")}}async function Re(o){var e,s;try{await f.post(`/accounts/${o.id}/activate`),h("Compte activé"),await V()}catch(n){x(((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||"Erreur lors de l'activation")}}function pe(o){var e;S.value=o||null,o?k.value={name:o.name,email:o.email,password:"",role:o.role,account_id:o.account_id||""}:k.value={name:"",email:"",password:"",role:"agent",account_id:((e=b.user)==null?void 0:e.account_id)||""},oe.value=!0}function T(){oe.value=!1,S.value=null}async function Ee(){var o,e;q.value=!0;try{const s={...k.value};s.password||delete s.password,s.account_id||delete s.account_id,S.value?(await f.put(`/users/${S.value.id}`,s),h("Utilisateur mis à jour")):(await f.post("/users",s),h("Utilisateur créé")),T(),await N()}catch(s){x(((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erreur lors de la sauvegarde")}finally{q.value=!1}}async function Ne(o){var s,n;if(await Z("Suspendre cet utilisateur ?"))try{await f.post(`/users/${o.id}/suspend`),h("Utilisateur suspendu"),await N()}catch(y){x(((n=(s=y.response)==null?void 0:s.data)==null?void 0:n.message)||"Erreur lors de la suspension")}}async function Ve(o){var e,s;try{await f.post(`/users/${o.id}/activate`),h("Utilisateur activé"),await N()}catch(n){x(((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||"Erreur lors de l'activation")}}async function ze(o){var s,n;if(await Z("Supprimer cet utilisateur ?","Cette action est irréversible."))try{await f.delete(`/users/${o.id}`),h("Utilisateur supprimé"),await N()}catch(y){x(((n=(s=y.response)==null?void 0:s.data)==null?void 0:n.message)||"Erreur lors de la suppression")}}function ce(o){E.value=o||null,o?$.value={name:o.name,description:o.description||"",permissions:[...o.permissions||[]]}:$.value={name:"",description:"",permissions:[]},re.value=!0}function D(){re.value=!1,E.value=null}async function qe(){var o,e;L.value=!0;try{E.value?(await f.put(`/custom-roles/${E.value.id}`,$.value),h("Rôle mis à jour")):(await f.post("/custom-roles",$.value),h("Rôle créé")),D(),await I()}catch(s){x(((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Erreur lors de la sauvegarde")}finally{L.value=!1}}async function Le(o){var e,s;try{await f.post(`/custom-roles/${o.id}/duplicate`),h("Rôle dupliqué"),await I()}catch(n){x(((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||"Erreur lors de la duplication")}}async function Fe(o){var s,n;if(await Z("Supprimer ce rôle ?"))try{await f.delete(`/custom-roles/${o.id}`),h("Rôle supprimé"),await I()}catch(y){x(((n=(s=y.response)==null?void 0:s.data)==null?void 0:n.message)||"Erreur lors de la suppression")}}return Pe(async()=>{await Promise.all([V(),N(),I(),Ce(),je(),$e()])}),(o,e)=>(r(),Te(He,null,{default:De(()=>[t("div",Oe,[e[89]||(e[89]=t("div",{class:"mb-4 sm:mb-6 lg:mb-8"},[t("h1",{class:"text-2xl sm:text-3xl font-bold"},"Gestion des comptes"),t("p",{class:"text-sm text-muted-foreground mt-1 sm:mt-2"}," Gérez les comptes, utilisateurs et rôles de la plateforme ")],-1)),t("div",Qe,[t("nav",We,[i(b).isSuperAdmin?(r(),l("button",{key:0,onClick:e[0]||(e[0]=s=>g.value="accounts"),class:A(["py-3 px-2 sm:px-3 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap",g.value==="accounts"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])},[a(i(ve),{class:"w-4 h-4 inline mr-1 sm:mr-2"}),e[31]||(e[31]=w(" Comptes ",-1))],2)):m("",!0),i(b).canManageUsers?(r(),l("button",{key:1,onClick:e[1]||(e[1]=s=>g.value="users"),class:A(["py-3 px-2 sm:px-3 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap",g.value==="users"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])},[a(i(fe),{class:"w-4 h-4 inline mr-1 sm:mr-2"}),e[32]||(e[32]=w(" Utilisateurs ",-1))],2)):m("",!0),i(b).isSuperAdmin?(r(),l("button",{key:2,onClick:e[2]||(e[2]=s=>g.value="custom-roles"),class:A(["py-3 px-2 sm:px-3 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap",g.value==="custom-roles"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])},[a(i(he),{class:"w-4 h-4 inline mr-1 sm:mr-2"}),e[33]||(e[33]=w(" Rôles personnalisés ",-1))],2)):m("",!0),t("button",{onClick:e[3]||(e[3]=s=>g.value="system-roles"),class:A(["py-3 px-2 sm:px-3 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap",g.value==="system-roles"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])},[a(i(Ze),{class:"w-4 h-4 inline mr-1 sm:mr-2"}),e[34]||(e[34]=w(" Rôles système ",-1))],2),t("button",{onClick:e[4]||(e[4]=s=>g.value="permissions"),class:A(["py-3 px-2 sm:px-3 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap",g.value==="permissions"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])},[a(i(xe),{class:"w-4 h-4 inline mr-1 sm:mr-2"}),e[35]||(e[35]=w(" Permissions ",-1))],2)])]),g.value==="accounts"&&i(b).isSuperAdmin?(r(),l("div",Ye,[t("div",et,[e[37]||(e[37]=t("p",{class:"text-sm text-muted-foreground"}," Gérez les comptes (entreprises/organisations) de la plateforme ",-1)),t("button",{onClick:e[5]||(e[5]=s=>me()),class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90 h-9 sm:h-10 px-3 sm:px-4 py-2"},[a(i(ne),{class:"w-4 h-4"}),e[36]||(e[36]=t("span",null,"Nouveau compte",-1))])]),J.value?(r(),l("div",tt,[...e[38]||(e[38]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"},null,-1)])])):M.value.length===0?(r(),l("div",st,[a(i(ve),{class:"w-12 h-12 text-muted-foreground mb-4"}),e[39]||(e[39]=t("p",{class:"text-lg font-medium"},"Aucun compte",-1)),e[40]||(e[40]=t("p",{class:"text-sm text-muted-foreground mt-1"},"Créez votre premier compte",-1))])):(r(),l("div",ot,[(r(!0),l(_,null,C(M.value,s=>(r(),l("div",{key:s.id,class:"rounded-lg border bg-card shadow-sm hover:shadow-md transition-shadow"},[t("div",rt,[t("div",lt,[t("div",nt,[t("h3",it,d(s.name),1),t("p",dt,d(s.email),1)]),t("span",{class:A(["text-xs px-2 py-0.5 rounded-full font-medium flex-shrink-0",{"bg-green-100 text-green-700":s.status==="active","bg-red-100 text-red-700":s.status==="suspended","bg-yellow-100 text-yellow-700":s.status==="pending"}])},d(ue[s.status]),3)]),t("div",at,[t("div",null,[e[41]||(e[41]=t("p",{class:"text-xs text-muted-foreground"},"Crédits SMS",-1)),t("p",ut,d(B(s.sms_credits)),1)]),t("div",null,[e[42]||(e[42]=t("p",{class:"text-xs text-muted-foreground"},"Utilisateurs",-1)),t("p",mt,d(s.users_count||0),1)]),t("div",null,[e[43]||(e[43]=t("p",{class:"text-xs text-muted-foreground"},"SMS envoyés",-1)),t("p",pt,d(B(s.sms_sent_total)),1)]),t("div",null,[e[44]||(e[44]=t("p",{class:"text-xs text-muted-foreground"},"Budget mensuel",-1)),t("p",ct,d(s.monthly_budget?B(s.monthly_budget):"Illimité"),1)])]),t("div",ft,[t("button",{onClick:n=>me(s),class:"flex-1 inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border px-2 py-1.5 hover:bg-accent"},[a(i(ie),{class:"w-3 h-3"}),e[45]||(e[45]=w(" Modifier ",-1))],8,bt),t("button",{onClick:n=>Ue(s),class:"flex-1 inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border px-2 py-1.5 hover:bg-accent"},[a(i(Je),{class:"w-3 h-3"}),e[46]||(e[46]=w(" Crédits ",-1))],8,vt),s.status==="active"?(r(),l("button",{key:0,onClick:n=>Me(s),class:"inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border border-destructive text-destructive px-2 py-1.5 hover:bg-destructive/10"},[a(i(be),{class:"w-3 h-3"})],8,xt)):(r(),l("button",{key:1,onClick:n=>Re(s),class:"inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border border-success text-success px-2 py-1.5 hover:bg-success/10"},[a(i(ge),{class:"w-3 h-3"})],8,gt))])])]))),128))]))])):m("",!0),g.value==="users"&&i(b).canManageUsers?(r(),l("div",yt,[t("div",wt,[t("div",ht,[t("p",kt,d(i(b).isSuperAdmin?"Gérez tous les utilisateurs":"Gérez les utilisateurs de votre compte"),1),i(b).isSuperAdmin&&M.value.length>0?c((r(),l("select",{key:0,"onUpdate:modelValue":e[6]||(e[6]=s=>X.value=s),onChange:N,class:"text-sm rounded-md border border-input bg-background px-2 py-1"},[e[47]||(e[47]=t("option",{value:""},"Tous les comptes",-1)),(r(!0),l(_,null,C(M.value,s=>(r(),l("option",{key:s.id,value:s.id},d(s.name),9,_t))),128))],544)),[[le,X.value]]):m("",!0)]),i(b).canCreateAgents?(r(),l("button",{key:0,onClick:e[7]||(e[7]=s=>pe()),class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90 h-9 sm:h-10 px-3 sm:px-4 py-2"},[a(i(ne),{class:"w-4 h-4"}),t("span",null,d(i(b).isSuperAdmin?"Nouvel utilisateur":"Nouvel agent"),1)])):m("",!0)]),K.value?(r(),l("div",Ct,[...e[48]||(e[48]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"},null,-1)])])):Y.value.length===0?(r(),l("div",jt,[a(i(fe),{class:"w-12 h-12 text-muted-foreground mb-4"}),e[49]||(e[49]=t("p",{class:"text-lg font-medium"},"Aucun utilisateur",-1)),e[50]||(e[50]=t("p",{class:"text-sm text-muted-foreground mt-1"},"Créez votre premier utilisateur",-1))])):(r(),l("div",$t,[(r(!0),l(_,null,C(Y.value,s=>(r(),l("div",{key:s.id,class:"rounded-lg border bg-card shadow-sm hover:shadow-md transition-shadow"},[t("div",At,[t("div",Ut,[t("div",St,[t("h3",Mt,d(s.name),1),t("p",Rt,d(s.email),1),s.account?(r(),l("p",Et,d(s.account.name),1)):m("",!0)]),t("span",{class:A(["text-xs px-2 py-0.5 rounded-full font-medium flex-shrink-0",{"bg-green-100 text-green-700":s.status==="active","bg-red-100 text-red-700":s.status==="suspended","bg-yellow-100 text-yellow-700":s.status==="pending"}])},d(ue[s.status]),3)]),t("div",Nt,[t("span",{class:A(["text-xs px-2 py-0.5 rounded-md font-medium",{"bg-purple-100 text-purple-700":s.role==="super_admin","bg-blue-100 text-blue-700":s.role==="admin","bg-teal-100 text-teal-700":s.role==="agent"}])},d(_e[s.role]),3)]),t("div",Vt,[t("button",{onClick:n=>pe(s),class:"flex-1 inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border px-2 py-1.5 hover:bg-accent"},[a(i(ie),{class:"w-3 h-3"}),e[51]||(e[51]=w(" Modifier ",-1))],8,zt),s.status==="active"?(r(),l("button",{key:0,onClick:n=>Ne(s),class:"inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border border-destructive text-destructive px-2 py-1.5 hover:bg-destructive/10"},[a(i(be),{class:"w-3 h-3"})],8,qt)):(r(),l("button",{key:1,onClick:n=>Ve(s),class:"inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border border-success text-success px-2 py-1.5 hover:bg-success/10"},[a(i(ge),{class:"w-3 h-3"})],8,Lt)),t("button",{onClick:n=>ze(s),class:"inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border border-destructive text-destructive px-2 py-1.5 hover:bg-destructive/10"},[a(i(ye),{class:"w-3 h-3"})],8,Ft)])])]))),128))]))])):m("",!0),g.value==="custom-roles"&&i(b).isSuperAdmin?(r(),l("div",Xt,[t("div",Bt,[e[53]||(e[53]=t("p",{class:"text-sm text-muted-foreground"}," Créez et gérez des rôles personnalisés avec des permissions spécifiques ",-1)),t("button",{onClick:e[8]||(e[8]=s=>ce()),class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-xs sm:text-sm font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90 h-9 sm:h-10 px-3 sm:px-4 py-2"},[a(i(ne),{class:"w-4 h-4"}),e[52]||(e[52]=t("span",null,"Nouveau rôle",-1))])]),O.value?(r(),l("div",It,[...e[54]||(e[54]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"},null,-1)])])):ee.value.length===0?(r(),l("div",Pt,[a(i(he),{class:"w-12 h-12 text-muted-foreground mb-4"}),e[55]||(e[55]=t("p",{class:"text-lg font-medium"},"Aucun rôle personnalisé",-1)),e[56]||(e[56]=t("p",{class:"text-sm text-muted-foreground mt-1"},"Créez votre premier rôle personnalisé",-1))])):(r(),l("div",Tt,[(r(!0),l(_,null,C(ee.value,s=>(r(),l("div",{key:s.id,class:"rounded-lg border bg-card shadow-sm"},[t("div",Dt,[t("div",Gt,[t("h3",Ht,d(s.name),1),s.is_system?(r(),l("span",Zt,"Système")):m("",!0)]),t("p",Jt,d(s.description||"Aucune description"),1),t("div",Kt,[(r(!0),l(_,null,C((s.permissions||[]).slice(0,4),n=>(r(),l("span",{key:n,class:"text-xs px-1.5 py-0.5 rounded bg-primary/10 text-primary"},d(n),1))),128)),(s.permissions||[]).length>4?(r(),l("span",Ot," +"+d(s.permissions.length-4),1)):m("",!0)]),t("div",Qt,[s.is_system?m("",!0):(r(),l("button",{key:0,onClick:n=>ce(s),class:"flex-1 inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border px-2 py-1.5 hover:bg-accent"},[a(i(ie),{class:"w-3 h-3"}),e[57]||(e[57]=w(" Modifier ",-1))],8,Wt)),t("button",{onClick:n=>Le(s),class:"flex-1 inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border px-2 py-1.5 hover:bg-accent"},[a(i(Ke),{class:"w-3 h-3"}),e[58]||(e[58]=w(" Dupliquer ",-1))],8,Yt),!s.is_system&&(s.users_count||0)===0?(r(),l("button",{key:1,onClick:n=>Fe(s),class:"inline-flex items-center justify-center gap-1 text-xs font-medium rounded-md border border-destructive text-destructive px-2 py-1.5 hover:bg-destructive/10"},[a(i(ye),{class:"w-3 h-3"})],8,es)):m("",!0)])])]))),128))]))])):m("",!0),g.value==="system-roles"?(r(),l("div",ts,[t("div",ss,[t("div",os,[a(i(we),{class:"w-5 h-5 text-muted-foreground"}),e[59]||(e[59]=t("p",{class:"text-sm text-muted-foreground"}," Les rôles système sont prédéfinis et ne peuvent pas être modifiés ",-1))])]),Q.value?(r(),l("div",rs,[...e[60]||(e[60]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"},null,-1)])])):(r(),l("div",ls,[(r(!0),l(_,null,C(de.value,s=>(r(),l("div",{key:s.value,class:"rounded-lg border bg-card shadow-sm"},[t("div",ns,[t("div",is,[t("h3",ds,d(s.label),1),t("span",as,"Niveau "+d(s.level),1)]),t("p",us,d(s.description),1),t("div",ms,[e[61]||(e[61]=t("p",{class:"text-xs font-medium mb-1"},"Permissions par défaut :",-1)),t("div",ps,[(r(!0),l(_,null,C(s.default_permissions,n=>(r(),l("span",{key:n,class:"text-xs px-1.5 py-0.5 rounded bg-primary/10 text-primary"},d(n),1))),128))])])])]))),128))]))])):m("",!0),g.value==="permissions"?(r(),l("div",cs,[t("div",fs,[t("div",bs,[a(i(we),{class:"w-5 h-5 text-muted-foreground"}),e[62]||(e[62]=t("p",{class:"text-sm text-muted-foreground"}," Liste de toutes les permissions disponibles dans le système ",-1))])]),W.value?(r(),l("div",vs,[...e[63]||(e[63]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"},null,-1)])])):(r(),l("div",xs,[(r(!0),l(_,null,C(te.value,(s,n)=>(r(),l("div",{key:n,class:"rounded-lg border bg-card shadow-sm"},[t("div",gs,[t("h3",ys,d(n),1),t("div",ws,[(r(!0),l(_,null,C(s,y=>(r(),l("div",{key:y.value,class:"flex items-start gap-2 p-2 rounded-md bg-muted/50"},[a(i(xe),{class:"w-4 h-4 text-primary flex-shrink-0 mt-0.5"}),t("div",null,[t("p",hs,d(y.label),1),t("p",ks,d(y.value),1)])]))),128))])])]))),128))]))])):m("",!0),se.value?(r(),l("div",_s,[t("div",{class:"absolute inset-0 bg-black/50",onClick:P}),t("div",Cs,[t("div",js,[t("h2",$s,d(U.value?"Modifier le compte":"Nouveau compte"),1),t("button",{onClick:P,class:"hover:bg-accent rounded-full p-1"},[a(i(H),{class:"w-5 h-5"})])]),t("form",{onSubmit:G(Ae,["prevent"]),class:"p-4 space-y-4"},[t("div",As,[t("div",null,[e[64]||(e[64]=t("label",{class:"text-sm font-medium"},"Nom du compte *",-1)),c(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>p.value.name=s),type:"text",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"Nom de l'entreprise"},null,512),[[v,p.value.name]])]),t("div",null,[e[65]||(e[65]=t("label",{class:"text-sm font-medium"},"Email *",-1)),c(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>p.value.email=s),type:"email",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"contact@entreprise.com"},null,512),[[v,p.value.email]])]),t("div",null,[e[66]||(e[66]=t("label",{class:"text-sm font-medium"},"Téléphone",-1)),c(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>p.value.phone=s),type:"text",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"+229 XX XX XX XX"},null,512),[[v,p.value.phone]])]),t("div",null,[e[67]||(e[67]=t("label",{class:"text-sm font-medium"},"N° Entreprise (SIRET, etc.)",-1)),c(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>p.value.company_id=s),type:"text",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,p.value.company_id]])]),t("div",null,[e[68]||(e[68]=t("label",{class:"text-sm font-medium"},"Crédits SMS initiaux",-1)),c(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>p.value.sms_credits=s),type:"number",min:"0",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,p.value.sms_credits,void 0,{number:!0}]])]),t("div",null,[e[69]||(e[69]=t("label",{class:"text-sm font-medium"},"Budget mensuel",-1)),c(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>p.value.monthly_budget=s),type:"number",min:"0",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"Laisser vide pour illimité"},null,512),[[v,p.value.monthly_budget,void 0,{number:!0}]])])]),U.value?m("",!0):(r(),l("div",Us,[e[73]||(e[73]=t("h3",{class:"text-sm font-semibold mb-3"},"Administrateur du compte",-1)),t("div",Ss,[t("div",null,[e[70]||(e[70]=t("label",{class:"text-sm font-medium"},"Nom *",-1)),c(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>p.value.admin_name=s),type:"text",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,p.value.admin_name]])]),t("div",null,[e[71]||(e[71]=t("label",{class:"text-sm font-medium"},"Email *",-1)),c(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>p.value.admin_email=s),type:"email",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,p.value.admin_email]])]),t("div",Ms,[e[72]||(e[72]=t("label",{class:"text-sm font-medium"},"Mot de passe *",-1)),c(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>p.value.admin_password=s),type:"password",required:"",minlength:"8",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,p.value.admin_password]])])])])),t("div",Rs,[t("button",{type:"button",onClick:P,class:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-input bg-background hover:bg-accent h-10 px-4"}," Annuler "),t("button",{type:"submit",disabled:z.value,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 disabled:opacity-50"},[z.value?(r(),l("div",Ns)):m("",!0),w(" "+d(U.value?"Mettre à jour":"Créer le compte"),1)],8,Es)])],32)])])):m("",!0),R.value?(r(),l("div",Vs,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[18]||(e[18]=s=>R.value=!1)}),t("div",zs,[t("div",qs,[e[74]||(e[74]=t("h2",{class:"text-lg font-semibold"},"Ajouter des crédits",-1)),t("button",{onClick:e[19]||(e[19]=s=>R.value=!1),class:"hover:bg-accent rounded-full p-1"},[a(i(H),{class:"w-5 h-5"})])]),t("form",{onSubmit:G(Se,["prevent"]),class:"p-4 space-y-4"},[t("div",null,[e[76]||(e[76]=t("label",{class:"text-sm font-medium"},"Compte",-1)),t("p",Ls,d(j.value.accountName),1),t("p",Fs,[e[75]||(e[75]=w("Solde actuel: ",-1)),t("span",Xs,d(B(j.value.currentCredits)),1)])]),t("div",null,[e[77]||(e[77]=t("label",{class:"text-sm font-medium"},"Montant à ajouter *",-1)),c(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>j.value.amount=s),type:"number",min:"1",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,j.value.amount,void 0,{number:!0}]])]),t("div",null,[e[78]||(e[78]=t("label",{class:"text-sm font-medium"},"Note (optionnel)",-1)),c(t("textarea",{"onUpdate:modelValue":e[21]||(e[21]=s=>j.value.note=s),rows:"2",class:"mt-1 flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm resize-none"},null,512),[[v,j.value.note]])]),t("div",Bs,[t("button",{type:"button",onClick:e[22]||(e[22]=s=>R.value=!1),class:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-input bg-background hover:bg-accent h-10 px-4"}," Annuler "),t("button",{type:"submit",disabled:F.value,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-success text-success-foreground hover:bg-success/90 h-10 px-4 disabled:opacity-50"},[F.value?(r(),l("div",Ps)):m("",!0),e[79]||(e[79]=w(" Ajouter ",-1))],8,Is)])],32)])])):m("",!0),oe.value?(r(),l("div",Ts,[t("div",{class:"absolute inset-0 bg-black/50",onClick:T}),t("div",Ds,[t("div",Gs,[t("h2",Hs,d(S.value?"Modifier l'utilisateur":"Nouvel utilisateur"),1),t("button",{onClick:T,class:"hover:bg-accent rounded-full p-1"},[a(i(H),{class:"w-5 h-5"})])]),t("form",{onSubmit:G(Ee,["prevent"]),class:"p-4 space-y-4"},[t("div",null,[e[80]||(e[80]=t("label",{class:"text-sm font-medium"},"Nom *",-1)),c(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>k.value.name=s),type:"text",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,k.value.name]])]),t("div",null,[e[81]||(e[81]=t("label",{class:"text-sm font-medium"},"Email *",-1)),c(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>k.value.email=s),type:"email",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,k.value.email]])]),S.value?m("",!0):(r(),l("div",Zs,[e[82]||(e[82]=t("label",{class:"text-sm font-medium"},"Mot de passe *",-1)),c(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>k.value.password=s),type:"password",required:"",minlength:"8",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,k.value.password]])])),i(b).isSuperAdmin?(r(),l("div",Js,[e[84]||(e[84]=t("label",{class:"text-sm font-medium"},"Compte",-1)),c(t("select",{"onUpdate:modelValue":e[26]||(e[26]=s=>k.value.account_id=s),class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[83]||(e[83]=t("option",{value:""},"Aucun compte",-1)),(r(!0),l(_,null,C(M.value,s=>(r(),l("option",{key:s.id,value:s.id},d(s.name),9,Ks))),128))],512),[[le,k.value.account_id]])])):m("",!0),t("div",null,[e[85]||(e[85]=t("label",{class:"text-sm font-medium"},"Rôle *",-1)),c(t("select",{"onUpdate:modelValue":e[27]||(e[27]=s=>k.value.role=s),required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[(r(!0),l(_,null,C(ae.value,s=>(r(),l("option",{key:s.value,value:s.value},d(s.label),9,Os))),128))],512),[[le,k.value.role]])]),t("div",Qs,[t("button",{type:"button",onClick:T,class:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-input bg-background hover:bg-accent h-10 px-4"}," Annuler "),t("button",{type:"submit",disabled:q.value,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 disabled:opacity-50"},[q.value?(r(),l("div",Ys)):m("",!0),w(" "+d(S.value?"Mettre à jour":"Créer"),1)],8,Ws)])],32)])])):m("",!0),re.value?(r(),l("div",eo,[t("div",{class:"absolute inset-0 bg-black/50",onClick:D}),t("div",to,[t("div",so,[t("h2",oo,d(E.value?"Modifier le rôle":"Nouveau rôle personnalisé"),1),t("button",{onClick:D,class:"hover:bg-accent rounded-full p-1"},[a(i(H),{class:"w-5 h-5"})])]),t("form",{onSubmit:G(qe,["prevent"]),class:"p-4 space-y-4"},[t("div",null,[e[86]||(e[86]=t("label",{class:"text-sm font-medium"},"Nom du rôle *",-1)),c(t("input",{"onUpdate:modelValue":e[28]||(e[28]=s=>$.value.name=s),type:"text",required:"",class:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[v,$.value.name]])]),t("div",null,[e[87]||(e[87]=t("label",{class:"text-sm font-medium"},"Description",-1)),c(t("textarea",{"onUpdate:modelValue":e[29]||(e[29]=s=>$.value.description=s),rows:"2",class:"mt-1 flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm resize-none"},null,512),[[v,$.value.description]])]),t("div",null,[e[88]||(e[88]=t("label",{class:"text-sm font-medium mb-2 block"},"Permissions",-1)),t("div",ro,[(r(!0),l(_,null,C(te.value,(s,n)=>(r(),l("div",{key:n,class:"mb-4 last:mb-0"},[t("p",lo,d(n),1),t("div",no,[(r(!0),l(_,null,C(s,y=>(r(),l("label",{key:y.value,class:"flex items-center gap-2 p-2 rounded hover:bg-accent cursor-pointer"},[c(t("input",{type:"checkbox",value:y.value,"onUpdate:modelValue":e[30]||(e[30]=Xe=>$.value.permissions=Xe),class:"rounded"},null,8,io),[[Ge,$.value.permissions]]),t("span",ao,d(y.label),1)]))),128))])]))),128))])]),t("div",uo,[t("button",{type:"button",onClick:D,class:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-input bg-background hover:bg-accent h-10 px-4"}," Annuler "),t("button",{type:"submit",disabled:L.value,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 disabled:opacity-50"},[L.value?(r(),l("div",po)):m("",!0),w(" "+d(E.value?"Mettre à jour":"Créer"),1)],8,mo)])],32)])])):m("",!0)])]),_:1}))}});export{jo as default};
